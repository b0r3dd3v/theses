\documentclass[b5page]{book}
\input{common}
\externaldocument{a}
\externaldocument{b}

\author{Abraham Westerbaan \and Bas Westerbaan}

\title{
    {\large Solutions of Exercises from and Errata to} \\
    \emph{The Category of Von Neumann Algebras}\\
    {\large and}\\
    \emph{Dagger and Dilation\\ {\large in the Category of Von Neumann Algebras}}}

\begin{document}

\maketitle

\begin{erratum}{physics-stinespring}%
The second part of the exercise starts with
    ``Conclude that any quantum channel~$\Phi\colon \scrB(\scrK) \to \scrB(\scrH)$ \ldots''.
This should have read
    ``Conclude that any quantum channel~$\Phi$ from~$\scrH$ to itself \ldots''
\end{erratum}

\begin{erratum}{ess-uniq-pur}%
The third-to-last sentence reads
``Derive from the latter
that for each~$y \in \scrK'$ and rank-one projector~$e \in \scrH$,
there is a~$y' \in \scrK'$
with~$U_0 (e \otimes y) = e \otimes y'$.''
This should have been
``Derive from the latter
that for each~$y \in \scrK'$ and unit vector~$e \in \scrH$,
there is a~$y' \in \scrK'$
with~$U_0 (e \otimes y) = e \otimes y'$.''.
\end{erratum}

\begin{solution}{physics-stinespring}%
To prove the first statement,
let~$\varphi \colon \scrB(\scrH) \to \scrB(\scrK)$ be any ncp-map.
If~$\varphi=0$ then~$\scrK'=0$ and~$V=0$ does the job,
        so for the other case, assume~$\varphi \neq 0$.
    By~\sref{stinespring-theorem}
        there is a Hilbert space~$\scrH'$,
        a bounded operator~$W \colon \scrH \to \scrH'$ and an
        nmiu-map~$\varrho \colon \scrB(\scrH) \to \scrB(\scrH')$
        such that~$\varphi = \ad_W \after \varrho$.
Clearly~$\varrho \neq 0$.
    By~\sref{nmiu-between-type-I}
        there is a Hilbert space~$\scrK'$
        and a unitary~$U \colon \scrH' \to \scrH \otimes \scrK'$
        with~$\varrho(A) = U^* (A \otimes 1) U$
         for all~$A \in \scrB(\scrH)$.
Define~$V \equiv UW$.
    Then~$\varphi(A) = W^* \varrho(A) W = W^*U^* (A \otimes 1) UW
        =  V^* (A \otimes 1 ) V$, as desired.

Before we can continue with the second statement,
    we need to understand the relationship
    between quantum channels and ncpu-maps.
This relationship is best understood with
    predual characterization of von Neumann algebras
    due to Sakai~\cite{sakai}, which we have been avoiding.
The characterization is as thus:
    a C$^*$-algebra~$\scrA$ is a von Neumann algebra
    if and only if it is isomorphic to the dual of a Banach space.
Then this Banach space is unique up-to-isomoprhism
    as it must be isomorphic to the space of normal functionals on~$\scrA$
    (denoted by~$\scrA_*$)
    and is appropriately called the \emph{predual}~of~$\scrA$.
Any normal linear map~$\varphi\colon \scrA \to \scrB$
    between von Neumann algebras~$\scrA$ and~$\scrB$
    yields a linear map~$\varphi_*\colon \scrB_* \to \scrA_*$
    via~$\varphi_*(\omega) = \omega \after \varphi$.
In the other direction, any linear map~$\varphi_* \colon \scrB_* \to \scrA_*$
    gives rise to a normal linear map~$\varphi\colon \scrA \to \scrB$
    by defining~$\varphi(a)(\omega) = \varphi_*(\omega)(a)$
    where we identified~$\scrA \equiv (\scrA_*)^*$.
Clearly~$\varphi$ is positive precisely
    if~$\varphi_*$ maps positive functionals to positive functionals.

A normal state~$\omega\colon \scrB(\scrH) \to \C$
    is precisely of the form~$\omega(a) = \TR[\rho a]$ for some density
        matrix~$\rho$ over~$\scrH$.
Thus the predual of~$\scrB(\scrH)$ can be identified
    with the set of trace-class operators over~$\scrH$.
Let~$\varphi_*$ be a linear map from the density operators
    on~$\scrH$ to those on~$\scrK$.
The map~$\varphi_*$ is completely positive in its usual sense
    if the corresponding map~$\varphi$ is completely positive.
Furthermore~$\varphi$ is unital if and only if~$\varphi_*$
    is trace-preserving.

To prove the second statement,
    let~$\Phi$ be any quantum channel
    mapping density matrices over~$\scrH$ to those of~$\scrH$ again.
(Note: in the printed version of the thesis
    the exercise incorrectly
    assumes~$\Phi$ to map density matrices over~$\scrH$
    to those over some other Hilbert space~$\scrK$.)
It follows from the previous, that there is a unique
        ncpu-map~$\varphi\colon \scrB(\scrH) \to \scrB(\scrH)$ with
\begin{equation*}
    \TR[ \Phi(\rho) A] \ = \ \TR[\rho \varphi(A)]
        \quad\text{for any density matrix~$\rho\in \scrB(\scrH)$}.
\end{equation*}
See also~\cite{tomamichel} for a more direct approach.
By the first part if the exercise,
    we know that there is a Hilbert space~$\scrK'$
    and a bounded operator~$V \colon \scrH \to \scrH \otimes \scrK'$
    with~$\varphi (A) = V^* (A \otimes 1) V$.
Tracing back the definition of~$V$, we see that~$V$
    is an isometry because~$\varphi$ is unital.
Pick any orthonormal bases~$E$ and~$F$ of~$\scrH$ and~$\scrK'$
    respectively.
We may assume, without loss of generality,
    that~$\scrK'$ is not zero-dimensional
    by setting~$\scrK' =\C$ and~$V = 0$
    in the case that~$\Phi = 0$.
Pick any~$f_0 \in F$
    and any unitary~$U\colon \scrH \otimes \scrK' \to \scrH \otimes \scrK'$
    with~$U^* x \otimes f_0 = V x$,
    which exists as~$V$ is an isometry.
Now we compute
\begin{align*}
    \TR [\varphi(A) \rho ]
    & \ = \ \TR[\rho V^* (A \otimes 1) V] \\
    & \ = \ \sum_{e \in E} \langle V \rho e, (A \otimes 1) V e \rangle \\
    & \ = \ \sum_{e \in E}
    \bigl\langle U^* (\rho \otimes 1) \,e\otimes f_0 ,
    \ (A \otimes 1) U^* \,e\otimes f_0 \bigr\rangle. \\
\intertext{Inserting~$\ketbra{f_0}{f_0}$
    in the previous,
    we may sum over all~$f \in F$ and get}
     \TR[\varphi(A) \rho] &\ = \ \sum_{\substack{e \in E \\ f\in F}}
    \bigl\langle U^* (\rho \otimes \ketbra{f_0}{f_0}) \,e\otimes f ,
    \ (A \otimes 1) U^* \,e\otimes f \bigr\rangle \\
    & \ = \ \sum_{\substack{e \in E \\ f\in F}}
    \bigl\langle
    (U^* (e\otimes f)) , \ 
    U^* (\rho \otimes \ketbra{f_0}{f_0})U \,
    (A \otimes 1) \,(U (e\otimes f)) \bigr\rangle \\
    & \ = \ 
    \TR \bigl[
    U^* (\rho \otimes \ketbra{f_0}{f_0})U \,
    (A \otimes 1)  \bigr] \\
& \ = \ 
\TR \bigl[ A   \TR\nolimits_{\scrK'}[ U^* (\rho \otimes \ketbra{f_0}{f_0} ) U] \bigr].
\end{align*}
This show that indeed~$\Phi(\rho)
    = \TR_{\scrK'}[ U^* (\rho \otimes \ketbra{v_0}{v_0})U]$
    as desired with~$v_0 \equiv f_0$.
\end{solution}

\begin{solution}{kraus-exercise}%
Let~$\varphi\colon \scrB(\scrH) \to \scrB(\scrK)$
    be any ncp-map.
By~\sref{physics-stinespring}
    there is a Hilbert space~$\scrK'$
    and a bounded operator~$V\colon \scrK \to \scrH \otimes \scrK'$
    with~$\varphi(A) = V^* (A \otimes 1) V$.
Let~$E$ be any orthonormal basis of~$\scrK'$.
    Then~$1 = \sum_{e\in E} \ketbra{e}{e}$
        where the sum converges ultraweakly
        and so by ultraweak continuity of~$\ad_V$ (\sref{ad-normal})
        and~$B \mapsto A\otimes B$ (\sref{tensor-simple-facts}), we see
    \begin{equation}\label{kraus-exc-eq1}
        \varphi(A) \ =\  V^* \Bigl(A \otimes \sum_{e\in E} \ketbra{e}{e}\Bigr) V
        ) \ =\  \sum_{e \in E} V^* (A \otimes \ketbra{e}{e}) V.
    \end{equation}
For~$e\in E$, define~$P_e \colon \scrH \otimes \scrK' \to \scrH$
    by~$P_e \equiv 1\otimes \bra{e}$,
    i.e.~$P_e(x \otimes y) = x \langle e, y\rangle$.
Define~$V_e \equiv P_e V$.
    Note that~$P_e^*AP_e = A \otimes\ketbra{e}{e}$ and so
\begin{alignat*}{2}
    \varphi(A)
    &\ = \  \sum_{e \in E} V^* (A \otimes \ketbra{e}{e} ) V &\qquad&
    \text{by \eqref{kraus-exc-eq1}} \\
    &\ = \  \sum_{e \in E} V^* P_e^*A P_e V \\
    &\ = \  \sum_{e \in E} V_e^* A V_e,
\end{alignat*}
as desired.
From the special case~$A=1$, we see
    that~$\sum_{e \in E} V_e^*V_e = \varphi(1)$
    and so the partial sums of~$\sum_{e \in E} V_e^* V_e$ are bounded.

For the final part, assume~$\scrH$ and~$\scrK$ are finite dimensional.
Recall that the standard Stinespring dilation space (say~$\scrK''$)
    for~$\varphi$ is constructed using a completion
    and quotient of~$\scrB(\scrH)\odot \scrK$.
As~$\scrB(\scrH)\odot \scrK$ is finite dimensional
    it is already complete.
    Hence~$\scrK''$ has dimension at most~$(\dim\scrH)^2( \dim\scrK)$.
By construction~$\scrH \otimes \scrK' \cong \scrK''$,
    hence~$\dim \scrK' \leq (\dim \scrH )(\dim \scrK)$.
Recall~$E$ is a basis of~$\scrK'$
    and so there are indeed at most~$(\dim \scrH )(\dim \scrK)$
        Kraus operators.
\end{solution}

\begin{solution}{exc-chris-univ-prop}%
We will show that~$U\colon \mathsf{Rep} \to \mathsf{Rep}_{\mathrm{cp}}$
    has a left-adjoint by demonstrating the universal mapping property.
    Let~$\varphi\colon \scrA \to \scrB(\scrH)$ be any object of~$\mathsf{Rep}_{\mathrm{cp}}$.
    Pick any minimal Stinespring dilation~$(\scrK, \varrho, V)$ of~$\varphi$.
The map~$\varrho\colon \scrA\to \scrB(\scrK)$ is an object
        of~$\mathsf{Rep}$.
Clearly~$\ad_V \after \varrho \after \id = \varphi$
    and so~$\eta_\varphi\equiv (\id,V)\colon \varphi \to U\varrho$
        is a morphism in~$\mathsf{Rep}_{\mathrm{cp}}$.
We will show that for each~$f\colon \varphi \to U\varrho'$
        in~$\mathsf{Rep}_{\mathrm{cp}}$,
    there is a unique~$f'\colon \varrho \to \varrho'$
    in~$\mathsf{Rep}$ with~$Uf' \after \eta_\varphi = f$.
This is sufficient to show that~$U$
    has a left adjoint.

    So let~$f\colon \varphi\to U\varrho'$ be any morphism
        in~$\mathsf{Rep}_{\mathrm{cp}}$.
Say~$\varrho'\colon \scrA' \to \scrB(\scrK')$.
    Then~$f \equiv (m', V')$ consists of
    a nmiu-map~$m'\colon \scrA \to \scrA'$
    and bounded operator~$V' \colon \scrH \to \scrK'$
    with~$\ad_{V'} \after \varrho' \after m' = \varphi$.
By~\sref{dils-univ-stinespring}
    there is a unique bounded operator~$S\colon \scrK \to \scrK'$
        with~$SV = V'$ and~$\varrho = \ad_S \after \varrho' \after m'$.
This turns~$f' \equiv(m',S)$ into a
    morphism~$\varrho \to \varrho'$ in~$\mathsf{Rep}$.
Furthermore~$Uf' \after \eta_\varphi
                = (m' \after \id, SV) = (m',V') = f$.
To show uniqueness, assume
        there is some~$f'' \colon \varrho \to \varrho'$
        in~$\mathsf{Rep}$
        with~$Uf'' \after \eta_\varphi = f$.
Say~$f'' = (m'',S'')$.
    Then~$(m',V') = f = Uf' \after \eta_\varphi = (m'', S''V)$.
So~$m''=m'$ and~$V' = S''V$.
The fact that~$f''$ is a morphism in~$\mathsf{Rep}$
    is
    equivalent to~$\ad_{S''} \after \varrho' \after m'' = \varrho$.
Thus~$\ad_{S''} \after \varrho' \after m' = \varrho$.
By uniqueness of~$S$, we get~$S'' = S$.
    Hence~$f''=(m'',S'') = (m',S) = f'$, as desired.
\end{solution}

\begin{solution}{ess-uniq-pur}%
Let~$\varphi\colon \scrB(\scrH) \to \scrB(\scrK)$ be any ncp-map.
As in the description of the exercise,
    let~$\scrK$ be a Hilbert space
    and~$V,W\colon \scrK \to \scrH \otimes \scrK'$
    be bounded operators
    with~$V^* (a \otimes 1) V = \varphi(a) = W^* (a\otimes 1) W$.
Write~$\scrV$ for the closed linear span
    of~$\{(a \otimes 1) V x; \ a \in \scrB(\scrH),\ x \in \scrK\}$
        in~$\scrH\otimes \scrK'$
and similarly~$\scrW$ for that
    of~$\{(a \otimes 1) W x; \ a \in \scrB(\scrH),\ x \in \scrK\}$.
Note that for any~$n\in \N$, ~$x_1,\ldots, x_n \in \scrK$
    and~$a_1, \ldots, a_n \in \scrB(\scrH)$ we have
\begin{align*}
    \bigl\| \sum_i (a_i\otimes1) V x_i \bigr\|^2
    &\ = \ 
     \sum_{i,j} \langle x_i,\, V^* ((a_i^*a_j) \otimes 1) V x_j\rangle \\
    &\ = \ 
     \sum_{i,j} \langle x_i,\, W^* ((a_i^*a_j) \otimes 1) W x_j\rangle \\
     &\ = \ 
    \bigl\| \sum_i (a_i\otimes1) W x_i \bigr\|^2.
\end{align*}
Thus there is a unique unitary~$U_0\colon \scrW \to \scrV$
    fixed by~$U_0 (a \otimes 1) W x = U_0 (a \otimes 1) V x$.
We see~$U_0 W = V$ by setting~$a=1$.
Furthermore
    \begin{equation*}
        (\alpha \otimes 1) U_0 (a \otimes 1) W x
        \ = \ ((\alpha a)  \otimes 1) V x
        \ = \ U_0 (\alpha  \otimes 1 )(a  \otimes 1) W x
    \end{equation*}
    for any~$\alpha,a \in \scrB(\scrH)$ and~$x \in \scrK$,
    hence~$(\alpha \otimes 1) U_0 = U_0 (\alpha \otimes 1)$.

For any~$a \in \scrB(\scrH)$,
    the operator~$a \otimes 1 \in \scrB(\scrH \otimes \scrK')$
    restricts to~$\scrB(\scrW)$.
Pick an orthonormal basis~$E$ of~$\scrH$
    and some~$e_0 \in E$.
    Note that~$(\ketbra{e_0}{e_0} \otimes 1) \scrW = e_0 \otimes \scrW'$
    for some closed subspace~$\scrW' \subseteq \scrK'$.
In fact, for any~$e \in E$
    we have~$e \otimes \scrW'
    = (\ketbra{e}{e_0} \otimes 1) (e_0 \otimes \scrW')
    = (\ketbra{e}{e_0}\otimes 1)  (1 \otimes \ketbra{e_0}{e_0}) \scrW
    = (\ketbra{e}{e} T \otimes 1)  \scrW = (\ketbra{e}{e} \otimes 1) \scrW$,
    where~$T$ is the unitary on~$\scrH$ that only swaps~$e$ and~$e_0$.
Hence~$\scrW = \scrH \otimes \scrW'$.
Similarly~$\scrV = \scrH \otimes \scrV'$
    for some closed subspace~$\scrV' \subseteq \scrK'$.

For any non-zero~$w \in \scrW'$ and unit-vector~$x \in \scrH$,
    we have~$U_0 (x \otimes w)
        = U_0 (\ketbra{x}{x} \otimes 1)( x\otimes w)
        = (\ketbra{x}{x} \otimes 1) U_0 (x\otimes w)$
        so~$U_0 (x \otimes w) = x \otimes y$ for some~$y \in \scrV'$.
Clearly~$\| w \| = \| x \otimes w\|=\| U_0 (x\otimes w) \|
        = \|x \otimes y\| = \|y\|$,
        so there is a unique unitary~$U_1\colon \scrW' \to \scrV'$
        with~$U_0 (x \otimes w) = x \otimes U_1 w$.
        It follows~$U_0 = 1 \otimes U_1$.

As~$\scrV$ and~$\scrW$ are isomorphic, they have the same dimension
    and so do~$\scrV^\perp$ and~$\scrW$.
Consequently, there is an unitary~$U\colon \scrK' \to \scrK'$
    extending~$U_1$.
We have~$V = (1\otimes U) W
    =   (1 \otimes U_1) W
     = U_0 W = V$ as desired.
\end{solution}

\backmatter
\fancyfoot[CE]{}
\fancyfoot[CO]{}
\fancypagestyle{plain}{
    \fancyfoot[CE]{}
    \fancyfoot[CO]{}
}

\begingroup
\renewcommand\chapter[2]{\backmattertitle{Bibliography}}
\bibliography{main}{}
\endgroup

\bibliographystyle{plain}

\end{document}

% vim: se ft=tex.latex :
