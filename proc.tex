\documentclass[a]{subfiles}
\begin{document}
\chapter{Processes}

\section{Measurement}
\begin{point}%
We now turn to the study of
maps on a von Neumann algebra~$\scrA$
of the form
$a\mapsto \sqrt{p}a\sqrt{p}\colon\,\scrA\to\scrA$,
where~$p$ is an effect of~$\scrA$,
that represent measurement of~$p$,
and are called \emph{assert maps} in~\TODO{cite Bart}
--- the importance of these maps 
to any logical description of
quantum computation is not easily overstated.

On the effects of~$\scrA$
these maps are studied~\TODO{...} in the guise
of the binary operation
$p\ast q=\sqrt{p} q \sqrt{p}$
called the \emph{sequential product}.
The main result of this section
is an axiomatisation of this operation
in terms of properties
of the underlying assert maps.

Our first observation
to this end
is that any assert map factors as
\begin{equation*}
\xymatrix@C=10em{
\scrA
\ar[r]^-{\pi\colon a\mapsto \ceil{p}a\ceil{p}}
&
\ceil{p}\!\scrA\!\ceil{p}
\ar[r]^-{c\colon a\mapsto \sqrt{p}a\sqrt{p}}
&
\scrA
},
\end{equation*}
where both~$\pi$ and~$c$ obey a universal property:
$c$ is a \emph{filter} of~$p$, see~\sref{filter},
and~$\pi$ is a \emph{corner} of~$\ceil{p}$, see~\sref{corner}.
Such maps
that are the composition of a filter and a corner
will be called \emph{pure}, see~\sref{pure},
Since not only assert maps turn out to be pure, but also maps of the form
$b^*(\,\cdot\,)b\colon \scrA\to\scrA$ for an arbitrary element~$a$
of~$\scrA$,
we need one more property of assert maps, namely
that
\begin{equation*}
	\sqrt{p}\,e_1\,\sqrt{p}\ \leq\  e_2^\perp 
	\qquad\iff\qquad
	\sqrt{p}\,e_2 \,\sqrt{p}\ \leq\  e_1^\perp
\end{equation*}
for all projections~$e_1$ and~$e_2$ of~$\scrA$---which we'll
describe by saying that $\sqrt{p}(\,\cdot\,)\sqrt{p}\colon \scrA\to\scrA$
is \emph{purely self-adjoint}.
Judging only by the name
it may not surprise you that the map $b(\,\cdot\,)b\colon \scrA\to\scrA$
where~$b\in \scrA$ is self-adjoint (but not necessarily positive)
turns out to be purely self-adjoint too,
so that as a final touch we introduce the notion
of \emph{purely positive} maps $f\colon \scrA\to\scrA$
that are simply maps of the form~$f\equiv gg$ for some purely self-adjoint~$g$.

The main technical result, then, of this section
is that any purely positive map $f\colon\scrA\to\scrA$
is of the form~$f=\sqrt{p}(\,\cdot\,)\sqrt{p}$
where~$p=f(1)$;
and, accordingly, our axioms 
(in~\sref{uniqueness-sequential-product})
that uniquely
determine the sequential product~$\ast$
on the effects of a von Neumann algebra~$\scrA$ are:
for every effect~$p$ of~$\scrA$,
\begin{enumerate}
\item
$p\ast 1=p$,
\item
$p\ast q = f(q)$
for all~$q\in [0,1]_\scrA$
for some pure map~$f\colon \scrA\to\scrA$,
\item
$p=q\ast q$ for some $q$ from~$[0,1]_\scrA$,
\item
$p \ast (p \ast q) = (p\ast p)\ast q$
for all~$q\in[0,1]_\scrA$,
\item
$p \ast e_1 \leq e_2^\perp\iff
p \ast e_2 \leq e_1^\perp$
for all projections $e_1,e_2$ of~$\scrA$.
\end{enumerate}%
While I would certainly not like
to undersell the results mentioned above
I suspect that the notion of purety exposed along the way
will turn out to be of far greater significance.
I'd like to advertise
here that we have already discovered that purity can be described in
wildly different terms---definitely a good omen, if any---in
that a map~$f\colon \scrA\to\scrB$ is pure when in its 
\emph{Paschke dilation} \TODO{add ref.}
$\xymatrix{\scrA
	\ar[r]|-\varrho
&
	\scrP\ar[r]|-c
&
\scrB}$
the map $\varrho$ is surjective.
Because of the faith I've developed for our notion of purity I've allowed myself
to address some theoretical questions concerning it
here that are not required for the main results of this thesis,
but suppose a general interest in purity:
I'll show that every pure map~$f\colon\scrA\to\scrB$
is extreme among the ncp-maps~$g\colon \scrA\to\scrB$ with~$f(1)=g(1)$,
and, in fact, enjoys the possibly stronger property 
of being~\emph{rigid} (see~\sref{rigid} and~\sref{pure-is-rigid}).



\end{point}
\subsection{Corners and Filters}
\begin{parsec}%
\begin{point}{Definition}%
Given an projection~$e$ of a von Neumann algebra~$\scrA$,
the \Define{corner} of~$e$
is the subset~$e\scrA e$ of~$\scrA$ 
(consisting of the elements of~$\scrA$
of the form~$eae$ with~$a\in\scrA$).
In this context,
the obvious map~$e\scrA e\to\scrA$
is called the \Define{inclusion}
and the map $a\mapsto eae,\ \scrA\to e\scrA e$
is called the \Define{projection}.
\end{point}
\begin{point}[corner-basic]{Exercise}%
Let~$e$ be a projection from a von Neumann algebra~$\scrA$.
\begin{enumerate}
\item
Show that~$a\in\scrA$ 
is an element of~$e\scrA e$ iff~$eae=a$
iff $\ceilr{a}\cup\ceill{a} \leq e$.
\item
Show that the corner~$e\scrA e$
is closed under addition, (scalar) multiplication,
and involution.
\item
Show that~$e$ is a unit for~$e\scrA e$,
that is, $ea=ae=a$ for all~$a\in e\scrA e$.
\item
Show that~$e\scrA e$ is norm and ultraweakly closed.\\
(Hint: use the fact that $e(\,\cdot\,)e\colon \scrA\to\scrA$
is normal and bounded.)
\item
Show that~$e\scrA e$ --- 
endowed with the addition, (scalar) multiplication,
involution and norm from~$\scrA$,
and with~$e$ as its unit ---  is a $C^*$-algebra.
\item
Show that the supremum of a bounded directed
set~$D$ of self-adjoint elements of~$e\scrA e$
computed in~$\scrA$
is itself in~$e\scrA e$,
and, in fact, the supremum of~$D$ in~$e\scrA e$.
\item
Show that the inclusion $e\scrA e\to\scrA$
is an ncpsu-map.
\item
Deduce from this that the restriction of an np-map
$\omega\colon \scrA\to\C$ to
a map $e\scrA e\to\C$
is an np-map.

Conclude that~$e\scrA e$ is a von Neumann algebra.
\item
Show that the projection $a\mapsto eae,\ \scrA\to e\scrA e$
is an ncpu-map.
\item
Show that every np-map $\omega\colon e\scrA e\to\C$
is the restriction
of the np-map $\omega(e(\,\cdot\,)e)\colon \scrA\to\C$.
Deduce from this that the ultraweak topology of~$e\scrA e$
coincides (on $e\scrA e$) with the ultraweak topology on~$\scrA$.
Show that the ultrastrong topologies on~$e\scrA e$ and~$\scrA$
coincide in a similar fashion.
\end{enumerate}
\end{point}
\begin{point}[ad-ncp]{Exercise}%
Let~$a$ be an element of a von Neumann algebra~$\scrA$,
and let~$p$ and~$q$ be projections
of~$\scrA$ with $a^*pa\leq q$.
\begin{enumerate}
\item
Show that $a^*ba\in q\scrA q$
for every~$b\in p\scrA p$.
\item
Show that~$a^*(\,\cdot\,)a$
gives an ncp-map $p\scrA p\to q\scrA q$.
\end{enumerate}
\end{point}
\end{parsec}%
\begin{parsec}%
\begin{point}[corner]{Definition}%
Let~$p$ be an effect of a von Neumann algebra~$\scrA$.
A \Define{corner} of~$p$ is an
ncp-map $\pi\colon \scrA\to\scrC$
to a von Neumann algebra~$\scrC$
with~$\pi(p^\perp)=0$
which is initial among such maps 
in the sense
that every ncp-map $f\colon \scrA\to\scrB$
with~$f(p^\perp)=0$
factors as $f=g\circ\pi$
for some unique ncp-map $g\colon \scrC\to\scrB$.

While most corners
that we'll deal with are unital,
there are also corners which are not unital
(see~\sref{non-unital-corner}),
so when we write ``corner'' we shall
always mean a ``unital corner''
unless explicitly stated otherwise.
\end{point}
\begin{point}{Proposition}%
Given an effect~$p$ of a von Neumann algebra~$\scrA$,
and a partial isometry~$u$ of~$\scrA$
with $\floor{p}=uu^*$,
the map $\pi\colon \scrA\to u^*u \scrA u^*u$
given by~$\pi(a)=u^*au$ is a corner of~$p$.
\begin{point}{Proof}%
By~\sref{ad-ncp}, $\pi$ is an ncp-map.
To see that~$\pi(p^\perp)\equiv u^*p^\perp u =0$,
note that since~$u^*u=u^*\,u u^*\,u$,
we have $0=u^*(uu^*)^\perp u =u^*\smash{\floor{p}}^\perp u
= u^*\ceil{\smash{p^\perp}} u$,
and so
$0 = \ceil{u^* \ceil{\smash{p^\perp}} u }
=\ceil{u^* p^\perp u}$
by~\sref{ceil-fundamental},
giving~$u^*p^\perp u=0$
by~\sref{ceil-basic}.


Let~$\scrB$ be a von Neumann algebra,
and let~$f\colon \scrA\to\scrB$ be an ncp-map
with $f(p^\perp)=0$.
To show that~$\pi$ is a corner,
we must show that there is a unique ncp-map
$g\colon u^*u \scrA u^*u\to\scrB$
with $f=g\circ \pi$.
Uniqueness follows
from the observation that~$\pi$ is surjective.
Concerning existence,
define~$g:= f\circ \zeta$,
where $\zeta\colon  u^*u\scrA u^*u\to \scrA$
is the ncp-map given by~$\zeta(a)=uau^*$
for~$a\in\scrA$ (see~\sref{ad-ncp}),
so that it is immediately clear that~$g$ is an ncp-map.
It remains to be shown~$f=g\circ \pi$,
that is,
$f(a)=f(uu^*\,a\,uu^*)$ for all~$a\in\scrA$.
This follows from~\sref{cp-comprehension}
because~$f(\smash{(uu^*)^\perp})=0$,
since~$\ceil{\smash{f(\,\smash{(uu^*)^\perp}\,)}}
=\ceil{\smash{f(\smash{\floor{p}}^\perp)}}
=\ceil{\smash{f(\ceil{\smash{p^\perp}})}}
= \ceil{\smash{f(p^\perp)}}=\ceil{0}=0$.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}[filter]{Definition}%
A \Define{filter}
is an ncp-map $c\colon \scrC\to\scrA$
between von Neumann algebras
such that every ncp-map $f\colon \scrB\to\scrA$
with~$f(1)\leq c(1)$
factors as $f=c\circ g$
for some unique ncp-map $g \colon \scrB\to\scrC$.
\end{point}
\begin{point}[canonical-filter]{Proposition}%
Given an element~$d$ of a von Neumann algebra~$\scrA$,
the map $c\colon \ceilr{d}\!\scrA\!\ceilr{d}\to\scrA$
given by~$c(a)=d^*ad$
is a filter.
\begin{point}{Proof}%
Note that~$c$ is an ncp-map by~\sref{ad-ncp}.
Let~$\scrB$ be a von Neumann algebra,
and let~$f\colon \scrB\to\scrA$ be an ncp-map
with $f(1)\leq c(1)$.
To show that~$c$ is a filter,
we must show that there is a unique ncp-map
$g\colon \scrB\to
\ceilr{d}\!\scrA\!\ceilr{d}$
with~$f=c\circ g$.
Uniqueness of~$g$ follows from the observation
that~$c$ is injective by~\sref{mult-cancellation}.

To establish the existence of such~$g$,
note that~$f(b)$ is an element of~$d^*\scrA d$,
when~$b$ is positive
by~\sref{sequential-douglas}
because~$0\leq f(b)\leq \|b\|f(1)\leq \|b\| c(1)=\|b\|d^*d$,
and thus for arbitrary~$b\in\scrB$ too
(being a linear combination
of positive elements).
We can thus define $g\colon \scrB\to \ceilr{d}\!\scrA\!\ceilr{d}$
by~$g(b)=d^*\backslash f(b)/d$
for all~$b\in\scrB$.
It is clear that~$g$ is linear and positive,
and~$c\circ g=f$.

To see that~$g$ is normal,
note that
$d^*\backslash\,\cdot\,/d\colon
d^*(\scrA)_1 d\to\scrA$
is ultrastrongly continuous by~\sref{div-usc},
as is~$f$ by~\sref{cp-uscont}
(also) as map from~$(\scrB)_1$ to~$d^*(\scrA)_1 d$,
so that~$g$ is ultrastrongly continuous on~$(\scrB)_1$,
and therefore normal by~\sref{p-uwcont}.

Finally, $g$ is completely positive
by~\sref{ncp-uwlim},
because it is by~\sref{div-approx}
the pointwise ultrastrong limit
of the by~\sref{ad-ncp} completely positive maps
$(\sum_{n=1}^Nt_n)^* \,f(\,\cdot\,)\,(\sum_{n=1}^N t_n)$,
where~$t_1,t_2,\dotsc$
is an approximate pseudoinverse of~$d$.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}{Definition}%
Let~$\scrA$ be a von Neumann algebra.
\begin{enumerate}
\item
Given a positive element~$p$
of~$\scrA$
we denote
by $\Define{c_p}\colon \ceil{p}\!\scrA\!\ceil{p}\to\scrA$
the \Define{standard filter} for~$p$
given by~$c_p(a)=\sqrt{p}a\sqrt{p}$
for all~$a\in\ceil{p}\!\scrA\!\ceil{p}$.
\item
Given an effect~$p$ of~$\scrA$
we denote
by $\Define{\pi_p}\colon \scrA\to\floor{p}\!\scrA\!\floor{p}$
the \Define{standard corner} of~$p$
given by~$\pi_p(a)=\floor{p}\!a\!\floor{p}$.
\end{enumerate}
\end{point}
\begin{point}[filter-basic]{Exercise}%
Let~$c\colon \scrC\to\scrA$ be a filter,
where~$\scrC$ and~$\scrA$ are von Neumann algebras.
\begin{enumerate}
\item
Show that, writing~$p:=f(1)$,
there is a unique
ncp-map $\alpha \colon \scrC\to \ceil{p}\!\scrA\!\ceil{p}$
with $c = c_p \circ \alpha$;
and that this~$\alpha$ is a unital ncp-isomorphism.
\item
Show that~$c$ is injective
(by proving first that~$c_p$ is injective
using~\sref{mult-cancellation}).

Conclude that~$c$
is faithful, and that~$c$ is mono in~$\W{CP}$.
\end{enumerate}
\end{point}
\begin{point}[corner-basic]{Exercise}%
Let~$p$ be an effect of a von Neumann algebra~$\scrA$,
and let~$\pi\colon \scrA\to\scrC$ be a corner of~$p$.
\begin{enumerate}
\item
Show that there is a unique ncp-map
$\beta \colon \floor{p}\!\scrA\!\floor{p}\to\scrC$
with~$\pi = \beta\circ \pi_p$;
and that this~$\beta$ is unital and an ncp-isomorphism.
\item
Show that~$\pi$ is surjective, and that~$\pi$ is epi in~$\W{cp}$.
\end{enumerate}
\end{point}
\begin{point}{Theorem}%
Given an ncp-map $f\colon\scrA\to\scrB$
between von Neumann algebras,
a projection~$e$ of~$\scrA$
with~$\ceil{f}\leq e$,
and a positive element~$p$
of~$\scrB$ with~$f(1) \leq p$,
there is a unique ncp-map
$g \colon e\scrA e
\to p \scrB p$
such that
\begin{equation*}
\xymatrix{
\scrA
\ar[r]^-f
\ar[d]_{\pi_e}
&
\scrB
\\
e\scrA e
\ar[r]_g
& 
p\scrB p
\ar[u]_{c_p}
}
\end{equation*}
commutes,
and it is given by
$g(a)=\sqrt{p}\backslash f(a)/\!\sqrt{p}$
for all~$a\in e\scrA e$.
\begin{point}{Proof}%
Uniqueness of~$g$ follows from the facts
that~$\pi_e$ is epi and~$c_p$ is mono
in~$\W{cp}$,
see~\sref{corner-basic} and~\sref{filter-basic}.

Concerning existence, 
since~$\pi_e$ is a corner of~$e$,~\sref{corner},
and~$\ceil{f}\leq e$,
or in other words, $f(e^\perp)=0$,
there is a unique ncp-map $h\colon e\scrA e\to \scrB$
with $h \circ \pi_e = f$.
Note that~$h(a)=f(a)$ for all~$a$ from~$e\scrA e$.

As~$h(1)=h(\pi_e(1))=f(1)\leq p=c_p(1)$,
and~$c_p$ is a filter,~\sref{filter},
there is a unique ncp-map
$g\colon e\scrA e \to p \scrB p$
with $c_p\circ g = h$,
which is (by the proof of \sref{canonical-filter}) given by
$g(a)=\sqrt{p}\backslash h(a)/\sqrt{p}
\equiv \sqrt{p}\backslash f(a)/\sqrt{p}$
for all~$a$ from~$e\scrA e$.
Then~$c_p\circ g\circ \pi_e = h\circ \pi_e = f$.\qed
\end{point}
\end{point}
\begin{point}[square-f]{Corollary}%
Given an ncp-map $f\colon \scrA\to\scrB$
between von Neumann algebras
there is a unique ncp-map $\Define{[f]}\colon 
\ceil{f}\!\scrA\!\ceil{f}
\to
\ceil{f(1)}\!\scrB\!\ceil{f(1)}$
such that 
\begin{equation*}
\xymatrix@C=4em{
\scrA
\ar[r]^-f
\ar[d]_{\pi_{\ceil{f}}}
&
\scrB
\\
\ceil{f}\!\scrA\!\ceil{f}
\ar[r]_-{[f]}
& 
\ceil{f(1)}\!\scrB\!\ceil{f(1)}
\ar[u]_{c_{f(1)}}
}
\end{equation*}
commutes;
and it is given by~$[f](a)=\sqrt{f(1)}\backslash f(a)/\!\sqrt{f(1)}$
for all~$a$ from $\ceil{f}\!\scrA\!\ceil{f}$.

Moreover, 
$[f]$ is unital and faithful.
\end{point}
\begin{point}{Example}%
For any faithful unital ncp-map $f\colon \scrA\to \scrB$
we have~$[f]=f$.
Such map need not be an isomorphism;
as one may take $f\colon (\lambda,\mu)\mapsto \lambda+\mu,
\C^2\to\C$.
\end{point}
\begin{point}[ad-pure]{Example}%
In the concrete case
that $f\equiv a^*(\,\cdot\,)a \colon
s\scrA s\to t\scrA t$,
where~$a$ is an element
of a von Neumann algebra,
and $s$ and~$t$ are projections of~$\scrA$
with
$\ceilr{a}\leq s$
and~$\ceill{a}\leq t$,
the map~$[f]$ 
is closely related to the
polar decomposition $a\equiv [a]\sqrt{a^*a}
= \sqrt{aa^*}[a]$ of~$a$,
where $[a]=a/\sqrt{a^*a}$
(see~\sref{polar-decomposition}).

Indeed,
since  $\ceil{f}=\ceilr{a}$,
$f(1)=a^*a$,
and~$[f]\equiv \sqrt{a^*a}\backslash a^*(\,\cdot\,)a/\sqrt{a^*a}
\equiv [a](\,\cdot\,)[a]^*$,
the picture becomes:
\begin{equation*}
\xymatrix@C=10em{
s\scrA s
\ar[r]^-{f\,=\,a^*\,(\,\cdot\,)\,a}
\ar[d]_{\pi_{\ceilr{a}}}
&
t\scrA t
\\
\ceilr{a}\!\scrA\!\ceilr{a}
\ar[r]_-{[f] \,=\,  [a]\,(\,\cdot\,)\,[a]^*}
& 
\ceill{a}\!\scrA\!\ceill{a}
\ar[u]_{c_{a^*a}}
}
\end{equation*}
Note that in this example
$[f]$ is an ncpu-isomorphism,
because~$[a]$ is a partial isometry
with initial projection~$\ceill{a}$
and final projection~$\ceilr{a}$.
Thus one can think of the diagram above
as an isomorphism theorem of sorts,
which applies only to certain  ncp-maps
that'll be called \emph{pure} in a moment (see~\sref{pure-fundamental}).
\end{point}
\end{parsec}
\subsection{Multiplicativity}
\begin{parsec}%
\begin{point}%
In case you were wondering,
the ncpu-isomorphism
we encounted in~\sref{ad-pure}
is simply a nmiu-isomorphism 
(see~\sref{iso}), which follows
from the following characterization of multiplicativity.
\end{point}
\begin{point}[gardner]{Proposition}%
For an ncpu-map $f\colon \scrA\to\scrB$
between von Neumann algebras
the following are equivalent.
\begin{enumerate}
\item
\label{gardner-1}
$f$ is multiplicative.
\item
\label{gardner-2}
$f(a)f(b)=0$
for all $a,b\in\scrA_+$ with $ab=0$.
\item
\label{gardner-3}
$\ceil{f(p)}\ceil{f(q)}=0$
for all projections $p$ and~$q$ of~$\scrA$ with $pq=0$.
\item
\label{gardner-4}
$f$ maps projections to projections.
\end{enumerate}
\begin{point}{Proof}%
(Based in part on the work of Gardner in~\cite{gardner}).
\begin{point}{\sref{gardner-1}$\Longrightarrow$\sref{gardner-4}}%
	is rather obvious.
\end{point}
\begin{point}{\sref{gardner-4}$\Longrightarrow$\sref{gardner-3}}%
Let~$p$ and~$q$ be projections of~$\scrA$ with~$pq=0$.
Then~$p\leq q^\perp$, and so~$f(p)\leq f(q^\perp)=f(q)^\perp$,
which implies that $\ceil{f(p)}\ceil{f(q)}
=f(p)f(q)=0$ since~$f(p)$ and~$f(q)$ are projections.
\end{point}
\begin{point}{\sref{gardner-3}$\Longrightarrow$\sref{gardner-2}}%
Let~$a$ and~$b$ be positive elements of~$\scrA$ with~$ab=0$.
We must show that~$f(a)f(b)=0$,
and for this it suffices to show that
$\ceil{f(a)}\ceil{f(b)}=0$,
because $f(a)f(b)=f(a)\ceil{f(a)}\ceil{f(b)}f(b)$.
Since~$ab=0$,
we have~$\ceil{a}\ceil{b}=0$ by~\TODO{...},
and so $\ceil{f(a)}\ceil{f(b)}=\ceil{f(\ceil{a})}\ceil{f(\ceil{b})}=0$.
\end{point}
\begin{point}{\sref{gardner-2}$\Longrightarrow$\sref{gardner-1}}%
We must show that~$f(a)f(b)=f(ab)$
for all~$a,b\in \scrA$.
Since the linear span of projections is norm-dense in~$\scrA$,
it suffices to show that $f(a)f(e)=f(ae)$
for any $a\in\scrA$ and a projection~$e$ of~$\scrA$.
Given such~$a$ and~$e$,
we on the one hand have $ae^\perp\, e=0$,
so that~$f(ae^\perp)f(e)=0$,
that is, $f(a)f(e)=f(ae)f(e)$;
and on the other hand
we have $ae\,e^\perp=0$,
so that~$f(ae)f(e^\perp)=0$,
that is, $f(ae)=f(ae)f(e)$;
so that we reach~$f(ae)=f(a)f(e)$ as sum total,
and the result that~$f$ is multiplicative.\qed
\end{point}
\end{point}
\end{point}
\begin{point}[iso]{Theorem}%
An ncpsu-isomorphism $f\colon \scrA\to\scrB$
between von Neumann algebras 
(so both~$f$ and~$f^{-1}$ are ncpsu-maps)
is an nmiu-isomorphism.
\begin{point}{Proof}%
Since~$f^{-1}(1)\leq 1$
and so~$1=f(f^{-1}(1))\leq f(1)\leq 1$,
we see that~$f(1)=1$, so both $f$ and $f^{-1}$ are unital.
It remains to be shown that~$f$ and~$f^{-1}$ are multiplicative.
Since by~\TODO{...} a self-adjoint element~$a$ of~$\scrA$
is a projection iff~$0$ is the infimum of~$a$ and~$a^\perp$,
and~$f$ (as ncpsu-isomorphism) preserves all the structure 
mentioned in this characterization of being a projection,
we see that~$f$ maps projections to projections,
and is thus multiplicative, by~\sref{gardner}.
It follows automatically that~$f^{-1}$ is multiplicative too.\qed
\end{point}
\end{point}
\end{parsec}
\subsection{Purity}
\begin{parsec}%
\begin{point}{Definition}%
Filters, corners,
and their compositions we'll call \Define{pure}.
\end{point}
\begin{point}{Exercise}%
Show that the following maps are pure.
\begin{enumerate}%
\item
An ncp-isomorphism between von Neumann algebras.
\item
The identity map~$\id\colon \scrA\to\scrA$
on a von Neumann algebra~$\scrA$.
\item
The map $a^*\,(\,\cdot\,)\,a\colon \scrA\to\scrA$
for any element~$a$ of a von Neumann algebra~$\scrA$.
\end{enumerate}
\end{point}
\begin{point}[pure-fundamental]{Proposition}%
For an ncp-map $f\colon \scrA\to\scrB$ between von Neumann algebras
the following are equivalent.
\begin{enumerate}
\item 
\label{pure-fundamental-1}
	$f$ is pure, i.e., $f$ is the composition
	of (perhaps many) filters and corners.
\item
\label{pure-fundamental-2}
	$f = c\circ \pi$ for a filter $c\colon \scrC\to\scrB$
	and a corner $\pi\colon \scrA\to\scrC$.
\item
\label{pure-fundamental-3}
	$[f]$ from~\sref{square-f} is an ncpu-isomorphism.
\end{enumerate}
\begin{point}{Proof}%
Note that \ref{pure-fundamental-3}$\Longrightarrow$\ref{pure-fundamental-2}
and \ref{pure-fundamental-2}$\Longrightarrow$\ref{pure-fundamental-1}
are rather obvious.
\begin{point}{\ref{pure-fundamental-1}$\Longrightarrow$%
\ref{pure-fundamental-2}}%
Calling $f$ \emph{properly pure}
when~$f\equiv c\circ \pi$
for some filter~$c$ and corner~$\pi$,
we must show that every pure map is properly pure.
For this it suffices to show that the composition of properly
pure maps is again properly pure;
which,
since filters are closed under composition
(by~\sref{}),
and corners are closed under composition
(by~\sref{}),
boils down to proving that the composition
$\pi\circ c$ of a corner~$\pi$ and a filter~$c$
is properly pure.
Since~$\pi\equiv \alpha\circ \pi_{\ceil{\pi}}$
and~$c\equiv c_{c(1)}\circ \beta$
for ncpu-isomorphisms~$\alpha$ and~$\beta$
(see~\sref{filter-basic}
and~\sref{corner-basic})
it suffices to show that
$f:=\pi_{s} c_{p}$ is properly pure
for a positive element~$p$ and a projection~$s$
of a von Neumann algebra~$\scrA$.
Since such~$f$ is of the form $f=s\sqrt{p}(\,\cdot\,)\sqrt{p}s
\colon \ceil{p}\!\scrA\!\ceil{p}\to s\scrA s$,
we know by~\sref{ad-pure}
that~$[f]$ is an ncpu-isomorphism,
and thus that~$f\equiv c_{f(1)}\circ [f]\circ \pi_{\ceil{f}}$ is properly pure.
\end{point}
\begin{point}{\ref{pure-fundamental-2}$\Longrightarrow$%
\ref{pure-fundamental-3}}%
Recall that $[f]$
is by definition the unique ncp-map
with~$f = c_{f(1)} [f] \pi_{\ceil{f}}$,
see~\sref{square-f}.
Note that since~$f=c\circ \pi$,
we have~$\ceil{f}=\ceil{\pi}$ (because~$\ceil{c}=1$, \TODO{...}),
and~$f(1)=c(1)$ (because~$\pi(1)=1$).
Since there are ncpu-isomorphisms~$\alpha$ and~$\beta$
with $\pi= \alpha \pi_{\ceil{\pi}}$ and  $c=c_{c(1)} \beta$,
we see that~$f=c_{c(1)} \beta\alpha \pi_{\ceil{\pi}}$,
and so~$[f]=\beta\alpha$
by definition of~$[f]$,
which implies that~$[f]$ is an ncpu-isomorphism.\qed
\end{point}
\end{point}
\end{point}
\begin{point}[special-pure-maps]{Exercise}%
Use~\sref{pure-fundamental} to show that 
\begin{enumerate}
\item
a faithful pure map is a filter,
\item
a unital pure map is a corner, and
\item
a unital and faithful pure map is an ncpu-isomorphism.
\end{enumerate}
\end{point}
\end{parsec}
\subsection{Contraposition}
\begin{parsec}%
\begin{point}{Definition}%
Given an ncp-map $f\colon \scrA\to\scrB$
between von Neumann algebras
we define
$\Define{f^\bullet}\colon \Proj(\scrA)\to \Proj(\scrB)$
by~$f^\bullet(e)=\ceil{f(e)}$
for all~$e\in\Proj(\scrA)$.
\end{point}
\begin{point}{Proposition}%
Given an ncp-map $f\colon \scrA\to\scrB$
between von Neumann algebras
and a projection~$e$ from~$\scrB$
there is a least projection~$\Define{f_\bullet(e)}$ from~$\scrA$ 
with~$\ceil{f(\,f_\bullet(e)^\perp\,)}\leq e^\perp$,
namely~$f_\bullet(e) =\ceil{\,ef(\,\cdot\,)e\,}$
(being the carrier 
of the ncp-map $ef(\,\cdot\,)e$ from~\TODO{...});
giving a map $\Define{f_\bullet}\colon \Proj(\scrB)\to\Proj(\scrA)$.

\TODO{refer to ITET}
\begin{point}{Proof}%
Since by definition $\ceil{\,ef(\,\cdot\,)e\,}$
is the greatest projection~$s$ of~$\scrA$
with $ef(s^\perp)e=0$ (see~\sref{carrier});
and~$ef(s^\perp )e=0$ iff~$\ceil{f(s^\perp)}
\leq\ceil{e(\,\cdot\,)e}^\perp\equiv
e^\perp$;
the projection
$\ceil{\,ef(\,\cdot\,)e\,}$
satisfies the description of~$f_\bullet(e)$.\qed
\end{point}
\end{point}
\begin{point}{Exercise}%
Let~$f\colon \scrA\to\scrB$ be an ncp-map between von Neumann algebras.
\begin{enumerate}
\item
Show that $f^\bullet(s)\leq t^\perp$
iff $f_\bullet(t)\leq s^\perp$,
for all~$s\in\Proj(\scrA)$ and~$t\in\Proj(\scrB)$.
\item
Show that $f^\bullet(\,\bigcup E\,)
= \bigcup_{e\in E} f^\bullet(e)$
for every set of projections~$E$ from~$\scrA$.

Show that~$f_\bullet(\,\bigcap E\,)
= \bigcap_{e\in E} f_\bullet(e)$
for all~$E\subseteq \Proj(\scrB)$.
\end{enumerate}
\end{point}
\begin{point}{Exercise}%
Show that for ncp-maps $f,g\colon\scrA\to\scrB$
between von Neumann algebras $f^\bullet = g^\bullet$
iff $f_\bullet = g_\bullet$.
In that case we say that $f$ and~$g$ are \Define{equivalent}.
\begin{point}%
Show that for ncp-maps $f\colon \scrA\to\scrB$
and~$g\colon \scrB\to\scrA$ we have
$f^\bullet=g_\bullet$ iff $f_\bullet = g^\bullet$
iff $\ceil{f(s)}\leq t^\perp\iff \ceil{g(t)}\leq s^\perp$
for all projections $s$ from~$\scrA$ and~$t$ from~$\scrB$.

In that case we say that~$f$ and~$g$ are \Define{contraposed}.
\end{point}
\end{point}
\begin{point}[equivalent-examples]{Examples}%
\begin{enumerate}
\item
Given an element~$a$ of a von Neumann algebra~$\scrA$
the maps $a^*(\,\cdot\,)a$ and~$a(\,\cdot\,)a^*$
on~$\scrA$ are contraposed.
\item
An ncp-isomorphism $f\colon \scrA\to\scrB$
between von Neumann algebras
is contraposed to its inverse~$f^{-1}\colon \scrB\to\scrA$.
\item
There may be many maps equivalent to a given ncp-map $f\colon \scrA\to\scrB$
between von Neumann algebras:
show that~$(zf)^\bullet = f^\bullet$
for every positive central element~$z$ of~$\scrB$ with~$\ceil{z}=1$.
\end{enumerate}
\end{point}
\begin{point}{Exercise}%
Let $\xymatrix{
	\scrA\ar[r]|-{f}&
	\scrB\ar[r]|-{g}&
\scrC}$
be ncp-maps between von Neumann algebras~$\scrA$,
$\scrB$ and~$\scrC$.
\begin{enumerate}
\item
Show that $(g\circ f)^\bullet = g^\bullet\circ f^\bullet$
(using~\sref{ncp-ceil}),
and $(g\circ f)_\bullet = f_\bullet\circ g_\bullet$.

\item
Assuming that $f$ is equivalent 
to an ncp-map $f'\colon \scrA\to\scrB$
and~$g$ is equivalent to
and ncp-map~$g'\colon \scrB\to\scrC$,
show that~$g\circ f$ is equivalent to~$g'\circ f'$.
\item
Assuming that $f$ is contraposed to
an ncp-map $f'\colon \scrB\to\scrA$
and~$g$ is contraposed to
an ncp-map $g'\colon \scrC\to\scrB$,
show that~$g\circ f$ is contraposed to~$f'\circ g'$.
\end{enumerate}
\end{point}
\begin{point}[bullet-sum]{Proposition}%
Given ncp-maps~$f,g\colon \scrA\to\scrB$
between von Neumann algebras
\begin{equation*}
(f+g)^\bullet(s) \,=\, f^\bullet(s)\, \cup\, g^\bullet(s)
\qquad
\text{and}
\qquad (f+g)_\bullet(t)\, =\, f_\bullet(t) \,\cup\, g_\bullet(t)
\end{equation*}
for all~$s\in \Proj(\scrA)$ and~$t\in \Proj(\scrB)$.
\begin{point}[bullet-sum]{Proof}%
Note that $(f+g)^\bullet(s)
=  \ceil{(f+g)(s)}
= \ceil{f(s)+g(s)}
= \ceil{f(s)}\cup \ceil{g(s)}
= f^\bullet(s) \cup g^\bullet(s)$
by~\sref{ceil-basic}.
Since~$(f+g)_\bullet(t)\leq s^\perp$
iff~$f^\bullet(s)\cup g^\bullet(s)\equiv (f+g)^\bullet(s)\leq t^\perp$
iff both $f^\bullet(s)\leq t^\perp$ and~$g^\bullet(s)\leq t^\perp$
iff both $f_\bullet(t)\leq s^\perp$ and~$g_\bullet(t)\leq s^\perp$
iff~$f_\bullet(t)\cup g_\bullet(t)\leq s^\perp$,
we see that $(f+g)_\bullet(t)=f_\bullet(t)\cup g_\bullet(t)$.\qed
\end{point}
\end{point}
\end{parsec}
\subsection{Rigidity}
\begin{parsec}%
\begin{point}%
We now turn a remarkable property shared
by pure and nmiu-maps.
\end{point}
\begin{point}[rigid]{Definition}%
We say that a ncp-map $f\colon \scrA\to\scrB$
between von Neumann algebras is \Define{rigid}
when the only ncp-map $g\colon \scrA\to\scrB$
with $g(1)=f(1)$ and $\ceil{f(p)}=\ceil{g(p)}$ for all
projections~$p$ from~$\scrA$ is~$f$ itself.
\end{point}
\begin{point}{Proposition}%
A rigid map $f\colon \scrA\to\scrB$
between von Neumann algebras
is extreme among the maps $g\colon \scrA\to\scrB$
with $g(1)=f(1)$.
\begin{point}{Proof}%
Given $f\equiv \lambda g_1 + \lambda^\perp g_2$
where~$\lambda\in(0,1)$ 
and~$g_1,g_2\colon \scrA\to\scrB$
are ncp-maps with $g_i(1)=f(1)$,
we must show that~$f=g_1=g_2$.
Note that for every projection~$s$
of~$\scrA$
we have~$f^\bullet(s) = (\lambda g_1+\lambda^\perp g_2)^\bullet(s)
= g_1^\bullet(s)\cup g_2^\bullet(s)$
by~\sref{bullet-sum} and~\sref{equivalent-examples};
and in particular~$g_1^\bullet(s)\leq f^\bullet(s)$.
Then for $h:=\lambda  g_1 + \lambda^\perp f$
we have $h(1)=f(1)$
and~$h^\bullet(s) = g_1^\bullet(s)\cup f^\bullet(s)
= f^\bullet(s)$,
so that~$\lambda g_1 + \lambda^\perp f \equiv 
h=f = \lambda g_1 +\lambda^\perp g_2$ by rigidity of~$f$;
and thus~$f=g_2$.
Similarly, $f=g_1$.\qed%
\end{point}
\end{point}
\begin{point}[nmiu-rigid]{Proposition}%
A nmiu-map $\varrho\colon \scrA\to\scrB$
between von Neumann algebras is rigid.
\begin{point}{Proof}%
Let~$g\colon \scrA\to\scrB$
be an ncpu-map
with~$\ceil{\varrho(p)}=\ceil{g(p)}$
for every projection~$p$ of~$\scrA$.
To show that~$\varrho$ is rigid,
we must show that~$g=\varrho$,
and for this, it suffices to prove that $g(p)=\varrho(p)$
for every projection~$p$ of~$\scrA$ (by~\TODO{...}).
To this end, we'll show that~$g$ is multiplicative,
because then~$g$ maps projections to projections,
so that $g(p)=\ceil{g(p)}=\ceil{\varrho(p)}=\varrho(p)$
for every projection~$p$ of~$\scrA$.
We'll show that $g$ is multiplicative
using~\sref{gardner}
by proving that
$\ceil{g(p)}\ceil{g(q)}=0$
for projections $p$ and~$q$ of~$\scrA$
with~$pq=0$.
Indeed,
$\ceil{g(p)}\ceil{g(q)}=\ceil{\varrho(p)}\ceil{\varrho(q)}
=\varrho(p)\varrho(q)=\varrho(pq)=\varrho(0)=0$.\qed
\end{point}
\end{point}
\begin{point}[canonical-quotient-rigid]{Lemma}%
Given an element~$b$ of a von Neumann algebra~$\scrA$
the ncp-map $a\mapsto b^* a b,\ \ceilr{b}\!\scrA\!\ceilr{b}\to\scrA$
is rigid.
\begin{point}{Proof}%
Let~$g\colon \ceilr{b}\!\scrA\!\ceilr{b}\to\scrA$
be an ncp-map with~$g(1)=b^*b$
and $\ceil{b^*pb}=\ceil{g(p)}$ for every projection~$p$ 
of $\ceilr{b}\!\scrA\!\ceilr{b}$.
To prove that~$c:=b^*(\,\cdot\,) b
\colon \ceilr{b}\!\scrA\!\ceilr{b}\to \scrA$ is rigid,
we must show that~$g=c$.
Since~$c$ is a filter
(by~\sref{canonical-filter})
and~$g(1)=b^*b$
there is a unique ncp-map~$h\colon \ceilr{b}\!\scrA\!\ceilr{b}
\to\ceilr{b}\!\scrA\!\ceilr{b}$
with~$g=c\circ h$.
Our task then is to show that~$h=\id$,
and for this it suffices to show that,
for all~$a\in\ceilr{b}\!\scrA\!\ceilr{b}$,
\begin{equation}
\label{filter-rigid-1}
e_n\, h(\,e_n\, a\, e_n\,)\, e_n
\ = \ e_n \, a\,  e_n
\end{equation}
for some sequence of projections $e_1,e_2,\dotsc$
of~$\ceilr{b}\!\scrA\!\ceilr{b}$
that converges ultrastrongly to~$\ceilr{b}$,
because---as multiplication is jointly ultrastrongly continuous
on bounded sets (by~\TODO{...})---the left-hand side of the equation above 
converges ultrastrongly to~$g(a)$,
while the right-hand side converges ultrastrongly to~$a$.
We'll take $e_N := \sum_{n=1}^N \ceill{t_n}$,
where~$t_1,t_2,\dotsc$
is an approximate pseudoinverse for~$b$,
because $\ceilr{b} = \sum_n\ceill{t_n}$.

Since the identity on~$e_n \scrA e_n$ is rigid
by~\sref{nmiu-rigid},
it suffices (for~\eqref{filter-rigid-1})
to show that 
$e_n h(e_n) e_n = e_n$
and 
$\ceil{e_nh(p)e_n} = p$
for every projection $p$ from $e_n\scrA e_n$.
Writing~$s_N:=\sum_{n=1}^N t_n$,
we have $bs_n = e_n$,
and so
$
\ceil{e_n h(p) e_n}
=
\ceil{s_n^* b^* h(p) b s_n}
=
\ceil{s_n^*g(p) s_n}
=
\ceil{s_n^* \ceil{g(p)} s_n}
=
\ceil{s_n^* \ceil{b^* p b} s_n}
=
\ceil{s_n^* b^* p b s_n}
=
\ceil{e_n p e_n }
$
for every 
projection~$p$ from~$\ceilr{b}\!\scrA\!\ceilr{b}$.
In particular, $\ceil{e_n h(p)e_n} = p$
when~$p$ is from~$e_n \scrA e_n$;
and we see $\ceil{e_n h(e_n^\perp) e_n}=\ceil{e_n e_n^\perp e_n}=0$
when we take~$p=e_n^\perp$,
so that~$e_n h(e_n^\perp) e_n =0$,
which yields $e_nh(e_n)e_n = e_n$.\qed
\end{point}
\end{point}
\begin{point}[pure-is-rigid]{Theorem}%
Every pure map between von Neumann algebras is rigid.
\begin{point}{Proof}%
Let~$f\colon \scrA\to\scrB$ be a pure map between von Neumann algebras,
and let~$g\colon \scrA\to\scrB$ be an ncp-map
with $f(1)=g(1)$
and $f^\bullet = g^\bullet$.
To show that~$f$
is rigid,
we must prove that~$f=g$.
We know by~\sref{square-f}
that $f$ can be written as $f\equiv c_{f(1)} \circ [f]\circ \pi_{\ceil{f}}$,
and that~$c_{f(1)}$ is rigid,
by~\sref{canonical-quotient-rigid},
which we'll use shortly.
Towards this end,
note that since~$f^\bullet = g^\bullet$,
we have $f_\bullet = g_\bullet$,
and so $\ceil{f}=f_\bullet(1)=g_\bullet(1)=\ceil{g}$.
As~$\pi_{\ceil{f}}$ is a corner of~$\ceil{f}=\ceil{g}$,
there is a unique ncp-map $h\colon \ceil{f}\!\scrA\!\ceil{f}\to\scrB$
with $h\circ \pi_{\ceil{f}} =g$. 
Since then
$h^\bullet \circ \pi_{\ceil{f}}^\bullet
= g^\bullet = f^\bullet 
= c_{f(1)}^\bullet
\circ [f]^\bullet \circ \pi_{\ceil{f}}^\bullet$,
 and $\pi_{\ceil{f}}^\bullet$ is clearly surjective,
we get~$h^\bullet = c_{f(1)}^\bullet\circ [f]^\bullet$,
and thus  $(h\circ [f]^{-1})^\bullet = c_{f(1)}^\bullet$,
using here that~$[f]$ is invertible,
because~$f$ is pure.
Now,
using that~$c_{f(1)}$
is rigid,
and $h([f]^{-1}(1))=h(1)=h(\pi_{\ceil{f}}(1))=g(1)=f(1)=c_{f(1)}(1)$,
we get~$h\circ [f]^{-1}=c_{f(1)}$,
which yields
$g=h\circ \pi_{\ceil{f}} 
=h\circ [f]^{-1}\circ [f]\circ \pi_{\ceil{f}}
= c_{f(1)} \circ [f] \circ \pi_{\ceil{f}} = f$,
and thus~$f$ is rigid.\qed
\end{point}
\end{point}
\end{parsec}
\subsection{Pure positivity}
\begin{parsec}%
\begin{point}%
We now turn to the question
to what extend a filter~$c$ is determined by
its action~$c^\bullet\colon e\mapsto \ceil{c(e)}$ on projections;
we will see in~\TODO{}
that two filters $c_1$ and~$c_2$
are equivalent, $c_1^\bullet = c_2^\bullet$,
if and only if~$c_1(1)$ and~$c_2(1)$
are equal up to some central elements,
that is, \emph{centrally similar}.
\end{point}
\begin{point}{Definition}%
We say that positive elements $p$ and~$q$ of a von Neumann algebra~$\scrA$
are \Define{centrally similar}
if~$cp=dq$ for some positive central elements~$c$ and~$d$ of~$\scrA$
with~$\ceil{p}\leq \ceil{c}$
and~$\ceil{q}\leq \ceil{d}$.
\end{point}
\begin{point}[centrally-similar-basic]{Exercise}%
Let~$p$ and~$q$ be positive elements
of a von Neumann algebra~$\scrA$.
\end{point}
\begin{point}[centrally-similar-fundamental]{Lemma}%
Suppose that $\ceil{q \, \vartheta(e)\, q}\leq e$
and~$\ceil{q \,\vartheta(e^\perp)\, q} \leq e^\perp$,
where~$e$ is a projection of a von Neumann algebra~$\scrA$,
$q$ is a positive element of~$\scrA$,
and~$\vartheta\colon \scrA\to\scrA$ is a miu-map.
Then~$eq=qe$ and~$\vartheta(e)=e$.
\begin{point}{Proof}%
We have $\vartheta(e)qe=\vartheta(e)q$,
because~$e\geq  \ceil{q\,\vartheta(e)\,q}
\equiv \ceill{\vartheta(e)q}$ (see~\sref{ceill-basic}).
Similarly, $\vartheta(e^\perp)qe^\perp = \vartheta(e^\perp)q$,
because $e^\perp \geq \ceil{q\,\vartheta(e^\perp)\,q}
\equiv \ceill{\vartheta(e^\perp)q}$,
and so~$\vartheta(e^\perp)qe=0$,
which implies $\vartheta(e)qe=qe$.
Thus~$qe=\vartheta(e)qe=\vartheta(e)q$,
and so $q^2e=q\vartheta(e)q$ is self-adjoint,
which gives us that $q^2e=(q^2e)^*=eq^2$.
Since~$q^2$ commutes with~$e$,
$q=\smash{\sqrt{q^2}}$ commutes
with~$e$ too (see~\sref{sqrt}).
Finally, $\vartheta(e)q=qe=eq$
and~$\ceil{q}=1$
imply that~$\vartheta(e)=e$ by~\sref{mult-cancellation}.\qed
\end{point}
\end{point}
\begin{point}[centrally-similar-corollary]{Corollary}%
A positive element~$q$
of a von Neumann algebra~$\scrA$
with~$\ceil{q}=1$
is central provided
there is a miu-map~$\vartheta\colon \scrA\to\scrA$
with $\ceil{q\,\vartheta(e)\,q}\leq e$
for every projection~$e$ from~$\scrA$;
and in that case~$\vartheta=\id$.
\end{point}
\begin{point}[positive-quotients-centrally-similar]{Proposition}%
Positive elements~$p$ and~$q$
of a von Neumann algebra~$\scrA$
with~$\ceil{p}=\ceil{q}=1$
are centrally similar 
when there is a miu-isomorphism
$\vartheta\colon \scrA\to\scrA$
with~$\ceil{pep}=\ceil{q\,\vartheta(e)\,q}$
for all projections~$e$ of~$\scrA$;
and in that case  $\vartheta=\id$.
\begin{point}{Proof}%
Let~$e$ be a projection from~$\scrA$ with~$ep=pe$.
Since~$1=\ceil{p}=\ceil{\smash{p^2}}$
we have $e=\ceil{e\ceil{\smash{p^2}}e}
=\ceil{e\smash{p^2} e}=\ceil{pep}=\ceil{q\,\vartheta(e)\,q}$.
Since~$e^\perp$ commutes with~$p$ too,
we get~$e^\perp = \ceil{\smash{q\,\vartheta(e^\perp)\,q}}$
by the same token;
and thus~$eq=qe$ and~$\vartheta(e)=e$ 
by~\sref{centrally-similar-fundamental}.
Since~$p$ is the norm limit
of linear combinations of such projections~$e$,
we get $pq=qp$ and~$\vartheta(p)=p$.

Since~$p$ and~$q$ commute,
we can find a sequence
of projections~$e_1\leq e_2 \leq \dotsb$
that commute with~$p$ and~$q$
with~$\bigcup_n e_n =1$
and such that $pe_n$ and~$qe_n$
are invertible, see~\TODO{simultaneous-approximate-pseudoinverse}.
Note that to prove that~$p$ and~$q$ are centrally similar,
it suffices to show that $pe_n$ and~$qe_n$ are centrally similar,
by~\TODO{...}
because $pe_n$ converges ultrastrongly to~$p$
and~$qe_n$ converges ultrastrongly to~$q$
(by~\TODO{mult-uws-cont} and~\TODO{vna-supremum-uslimit}).
Further, to prove that~$\vartheta(a)=a$
for some~$a\in\scrA$,
it suffices to show that~$\vartheta( e_n a e_n  ) = e_n a e_n$,
because $e_n a e_n$ converges ultraweakly to~$a$
by~\TODO{}.
Note that~$\vartheta(e_n)=e_n$,
because~$e_np=pe_n$,
and so~$\vartheta$ maps~$e_n\scrA e_n$ into~$e_n \scrA e_n$.

Thus, by considering~$e_n \scrA e_n$ 
instead of~$\scrA$,
and the restriction of~$\vartheta$ to~$e_n\scrA e_n$
instead of~$\vartheta$,
and~$pe_n$ and~$qe_n$
instead of~$p$ and~$q$,
we reduce the problem to the case that~$p$ and~$q$ are invertible;
and so we may assume without loss of generality that~$p$ and~$q$
are invertible to start with.
Then given an arbitrary projection~$e$ from~$\scrA$
we have $\ceil{p^{-1}q \,\vartheta(e)\, q p^{-1}}
= \ceil{p^{-1}\ceil{q\,\vartheta(e)\,q}p^{-1}}
= \ceil{p^{-1}\ceil{pep}p^{-1}}=e$,
and so~$p^{-1}q$ is central and~$\vartheta=\id$ 
by~\sref{centrally-similar-corollary} ---
and as $q\equiv p^{-1}q \, p$,
$p$ and~$q$ are thus centrally similar.
\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}[positive-map-uniqueness]{Theorem}%
Given a positive element~$p$ of a von Neumann algebra~$\scrA$
there is a unique positive map $f\colon \scrA\to\scrA$
with~$f(1)=p$,
namely~$f=\sqrt{p}(\,\cdot\,)\sqrt{p}$.
\begin{point}{Proof}%
Since we already know by~\TODO{...} that~$\sqrt{p}(\,\cdot\,)\sqrt{p}\colon
\scrA\to\scrA$ is positive and maps~$1$ to~$p$,
we only need to show that any positive map~$f\colon \scrA\to\scrA$
with~$f(1)=p$ equals it.
\begin{point}[positive-map-uniqueness-1]%
We'll first prove this under the assumption that~$\ceil{f}=1$
(that will be dispensed with in~\sref{positive-map-uniqueness-2}).
In that case~$f$ (being pure) is a filter 
of~$p$
(by~\sref{special-pure-maps}),
and thus of the form $f\equiv \sqrt{p}\,\vartheta(\,\cdot\,)\,\sqrt{p}$
for some isomorphism~$\vartheta\colon \scrA\to\scrA$.
Our task then is to show that~$\vartheta=\id$,
and for this
it suffices, by~\sref{positive-quotients-centrally-similar},
to find some positive~$q$ in~$\scrA$ with~$\ceil{q}=1$
and~$f^\bullet(e)\equiv\ceil{\sqrt{p}\,\vartheta(e)\,\sqrt{p}}
= \ceil{qeq}$ for all projections~$e$ in~$\scrA$.

Since~$f$ is positive,
we have~$f\equiv \xi \xi$ for some self-adjoint
map~$\xi\colon \scrA\to\scrA$.
Since~$1=\ceil{f}=f_\bullet(1)=
\xi_\bullet(\xi_\bullet(1))\leq \xi_\bullet(1)=\ceil{\xi}$
we have~$\ceil{\xi}=1$,
and so, $\xi$, being pure and faithful,
is a filter (by~\sref{special-pure-maps}).
Furthermore,
as~$\tilde\xi:=\sqrt{\xi(1)}(\,\cdot\,)\sqrt{\xi(1)}\colon \scrA\to\scrA$
is a filter of~$\xi(1)$ too,
there is an isomorphism~$\alpha\colon \scrA\to\scrA$
with $\xi=\tilde\xi\alpha$.
Now, $ {\tilde\xi}^\bullet \alpha^\bullet
={\xi}^\bullet={\xi}_\bullet
=\alpha_\bullet\tilde \xi_\bullet
= (\alpha^\bullet)^{-1}{\tilde\xi}^\bullet$
implies~${\tilde\xi}^\bullet = \alpha^\bullet 
{\tilde \xi}^\bullet \alpha^\bullet$,
and 
$f^\bullet= (\xi\xi)^\bullet
= {\tilde \xi}^\bullet\alpha^\bullet{\tilde \xi}^\bullet\alpha^\bullet
={\tilde \xi}^\bullet{\tilde \xi}^\bullet=(\tilde \xi\tilde \xi)^\bullet$.
In other words,
$\ceil{\sqrt{p}\,\vartheta(e)\,\sqrt{p}}
=f^\bullet(e)=(\tilde\xi\tilde\xi)^\bullet(e)
= \ceil{\xi(1)\,e\,\xi(1)}$
for all projections~$e$ of~$\scrA$,
which implies that~$\vartheta=\id$
by~\sref{positive-quotients-centrally-similar},
and hence that~$f=\sqrt{p}\,(\,\cdot\,)\,\sqrt{p}$.
\end{point}
\begin{point}[positive-map-uniqueness-2]%
We'll now show that~$f=\sqrt{p}\,(\,\cdot\,)\,\sqrt{p}$
without assuming that~$\ceil{f}=1$.
Since~$\ceil{f(1)}=f^\bullet(1)=f_\bullet(1)=\ceil{f}$,
we can write $f\equiv \zeta f' \pi$,
where $\pi\colon \scrA\to\ceil{f}\scrA\ceil{f}$
is the standard corner of~$\ceil{f}$
mapping~$a$ to $\ceil{f}a\ceil{f}$,
$f'\colon \ceil{f}\scrA\ceil{f}\to\ceil{f}\scrA\ceil{f}$
is an ncp-map,
and~$\zeta\colon \ceil{f}\scrA\ceil{f}\to\scrA$
is the standard filter of~$\ceil{f}$,
mapping~$a$ to itself.
Moreover, by~\TODO{...}  $\ceil{f'}=1$;
and since~$f$ is pure, so is~$f'$ by~\TODO{...}.
Being pure with~$\ceil{f'}=1$, we see that~$f'$ is a filter.

Of course we want to apply~\sref{positive-map-uniqueness-1}
to~$f'$ and for this it remains to be show that~$f'$ is positive.
Since~$f$ is positive,
there is self-adjoint~$g\colon \scrA\to\scrA$
with $f=gg$.
We claim that~$\ceil{g}=\ceil{f}$.
Indeed,
since~$f$ and $g$ are self-adjoint,
we have $\ceil{f}=f_\bullet(1)=f^\bullet(1)=g^\bullet(g^\bullet(1))
= g^\bullet(g_\bullet(1))=g^\bullet(1)=g_\bullet(1)=\ceil{g}$.
It follows that we can write
$g\equiv \zeta g' \pi$ for some ncp-map $g'\colon
\ceil{f}\scrA\ceil{f}\to\ceil{f}\scrA\ceil{f}$,
which will be pure and faithful.
Clearly having~$\pi\zeta = \id$,
we get $\zeta f'\pi
=f = gg = \zeta g' \pi \zeta g' \pi
= \zeta g'g' \pi$,
and so~$f'=g'g'$.
Thus to prove that~$f'$ is positive,
we only need to show that~$g'$ is self-adjoint.
To this end, recall
that $\pi$ and~$\zeta$ being contraposed by~\TODO{...}
satisfy
$\pi^\bullet = \zeta_\bullet$
and~$\zeta^\bullet = \pi_\bullet$,
and note that~$g'=\pi\zeta g' \pi\zeta
= \pi g \zeta $,
so that ${g'}^\bullet = \pi^\bullet g^\bullet \zeta^\bullet
= \zeta_\bullet g_\bullet \pi_\bullet
= (\pi g \zeta)_\bullet = g_\bullet'$.
Hence $f'$ --- being of the form $f'=g'g'$ for self-adjont~$g'$ ---
is positive.

By~\sref{positive-map-uniqueness-1},
$f'(a)=\sqrt{p}\,a\,\sqrt{p}$
for all~$a\in\ceil{f}\!\scrA\!\ceil{f}$.
Thus~$f(a)=\zeta(f'(\pi(a)))
= \sqrt{p}\ceil{f}a\ceil{f}\sqrt{p}$
for all~$a\in\scrA$.
Finally, 
since~$\ceil{f}=f_\bullet(1)=f^\bullet(1)=\ceil{f(1)}=\ceil{p}$,
we get $f(a)=\sqrt{p}a\sqrt{p}$
for all~$a\in\scrA$.\qed
\end{point}
\end{point}
\end{point}
\begin{point}{Corollary (``Square Root Axiom'')}%
Given a positive element~$p$ of a von Neumann algebra~$\scrA$
there is a unique positive map~$g\colon \scrA\to\scrA$
with~$g(g(1))=p$, namely
$g=\sqrt[4]{p}\,(\,\cdot\,)\,\sqrt[4]{p}$.
\begin{point}{Proof}%
Any such positive map~$g\colon \scrA\to\scrA$ with~$g(g(1))=p$
will be of the form
$g=\smash{\sqrt{g(1)}\,(\,\cdot\,)\,\sqrt{g(1)}}$
by~\sref{positive-map-uniqueness};
so that~$p=g(g(1))=g(1)^2$
implies that~$g(1)=\sqrt{p}$
by~\sref{sqrt},
thereby giving~$g=\sqrt[4]{p}\,(\,\cdot\,)\,\sqrt[4]{p}$.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}[uniqueness-sequential-product]{Theorem}%
On the effects of every von Neumann algebra~$\scrA$
there is a unique binary operation~$\ast$
such that for all~$p$ from~$[0,1]_\scrA$,
\begin{enumerate}
\item \label{ax1}
$p\ast 1 = p$,
\item\label{ax2}
$p\ast q = f(q)$
for all~$q$ from~$[0,1]_\scrA$
for some pure map~$f\colon \scrA\to\scrA$,
\item\label{ax3}
$p\ast (p\ast q)=(p\ast p)\ast q$
for all~$q$ from $[0,1]_\scrA$,
\item\label{ax4}
$p=q\ast q$ for some~$q$ from~$[0,1]_\scrA$,
\item\label{ax5}
$p \ast e_1 \leq e_2^\perp
\iff p\ast e_2 \leq e_1^\perp$
for all projections~$e_1,e_2$ from~$\scrA$;
\end{enumerate}
namely, the sequential product,
given by
$p\ast q = \sqrt{p}q\sqrt{p}$
for all~$p, q$ from~$[0,1]_\scrA$.
\begin{point}{Proof}%
Let~$p$ be from $[0,1]_\scrA$ be given.
Pick~$p'$ from~$[0,1]_\scrA$
with $p = p'\ast p'$
using~\ref{ax4},
and find a pure map~$f\colon \scrA\to\scrA$
with~$f(q)=p'\ast q$ for all~$q$ from $[0,1]_\scrA$
using~\ref{ax2}.
Then~$f$ is purely self-adjoint by~\ref{ax5},
and so~$ff$ is purely positive.
Since~$f(f(1))=p'\ast (p'\ast 1)
= p'\ast p'=p$ by~\ref{ax1},
$ff=\sqrt{p}(\,\cdot\,)\sqrt{p}$
by~\sref{positive-map-uniqueness},
so $p\ast q
= (p'\ast p')\ast q
= p'\ast (p' \ast q) = f(f(q))=\sqrt{p}q\sqrt{p}$
for all~$q\in [0,1]_\scrA$ by~\ref{ax3}.\qed
\end{point}
\end{point}
\begin{point}{Exercise}%
We'll show  that none of the axioms
from~\sref{uniqueness-sequential-product}
can be omitted.
\begin{enumerate}
\item
Show that
$p\ast q := \ceil{p}q\ceil{p}$
satisfies all axioms of~\sref{uniqueness-sequential-product}
except~\ref{ax1}.
\item
Show that  $p\ast q := \floor{p}q\floor{p}\ +\ \smash{\sqrt{p-\floor{p}}\,q\,
\sqrt{p-\floor{p}}}$
satisfies all axioms except~\ref{ax2}.
\item
Show that if for every effect~$p$ of~$\scrA$
we pick a unitary~$u_p$ from~$\ceil{p}\!\scrA\!\ceil{p}$
then~$\ast$ given by
$p\ast q= \sqrt{p}u_p^* \,q\, u_p\sqrt{p}$
satisfies~\ref{ax1} and~\ref{ax2}.

Show that this~$\ast$ obeys~\ref{ax3} when~$u_p^2=u_{p^2}$,
and~\ref{ax4} when $pu_p=u_p p$,
and~\ref{ax5} when~$u_p^*=u_p$.

Conclude that when $u_p$ is defined by $u_p:=g(p)$,
where~$g\colon [0,1]\to\{-1,1\}$
is any Borel function with $g(\nicefrac{2}{3})=1$
and~$g(\nicefrac{4}{9})=-1$
the operation~$\ast$ (defined by~$u_p$ as above) satisfies
all conditions of~\sref{uniqueness-sequential-product} except~\ref{ax3}.
\item
\TODO{...}
\item
Show that there is a Borel
function~$g\colon[0,1]\to S^1$
with $g(\nicefrac{1}{2})\neq 1$
and~$g(\lambda^2)=g(\lambda)^2$ for all~$\lambda\in [0,1]$,
and that~$\ast$ given by~$p\ast q = \sqrt{p} g(p)^* \,q \,g(p)\sqrt{p}$
satisfies all conditions of~\sref{uniqueness-sequential-product}
except~\ref{ax5}.




\end{enumerate}
\end{point}
\end{parsec}



\section{To be moved}
\begin{parsec}%
\begin{point}[ncp-uwlim]{Proposition}%
Given von Neumann algebras~$\scrA$
and~$\scrB$
the pointwise ultraweak limit
$f\colon \scrA\to\scrB$
of a net of  positive linear maps $f_\alpha\colon \scrA\to\scrB$
is positive, and, 
\begin{enumerate}
\item
$f$ is completely positive provided
that the $f_\alpha$ are completely positive, and
\item
$f$ is normal provided that the $f_\alpha$ are normal
and the ultraweak convergence of the~$f_\alpha$ to~$f$
is uniform on~$[0,1]_\scrA$.
\end{enumerate}
\begin{point}{Proof}%
Since given~$a\in \scrA$ the element~$f(a)$
is the ultraweak limit of the positive elements~$f_\alpha(a)$,
and therefore positive (by~\sref{vn-positive-basic}),
we see that~$f$ is positive.

Suppose that each~$f_\alpha$ is completely positive.
To show that~$f$ is completely positive,
we must prove, given~$a_1,\dotsc,a_n\in\scrA$
and~$b_1,\dotsc,b_n\in\scrB$,
that 
the element $\sum_{i,j} b_i^* f(a_i^*a_j)b_j$
of~$\scrB$
is positive.
And indeed it is,
being the ultraweak limit of
the positive elements $\sum_{i,j} b_i^* f_\alpha (a_i^* a_j)b_j$,
because  $f_\alpha(a_i^* a_j)$
converges ultraweakly to~$f(a_i^* a_j)$,
and~$b_i^*(\,\cdot\,)b_j\colon \scrB\to\scrB$
is ultraweakly continuous
(\sref{mult-uws-cont})
for any~$i$ and~$j$.

If the~$f_\alpha$ 
are normal,
and converge uniformly on~$[0,1]_\scrA$ ultraweakly
to~$f$,
then~$f$ is ultraweakly continuous
on~$[0,1]_\scrA$
(because the uniform limit of continuous functions is continous),
and thus normal (by~\sref{p-uwcont}).\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}[uwc-bounded]{Proposition}%
An ultraweakly continuous linear map $f\colon \scrA\to\scrB$
between von Neumann algebras is bounded.
\begin{point}[uwc-bounded-1]{Proof}%
Suppose for now that~$\scrB=\C$
(so that the norm topology and ultraweak topology on~$\scrB$ coincide).
Then any sequence $a_1,a_2,\dotsc$
in~$\scrA$ which converges in the norm to~$0$,
also converges ultraweakly to~$0$,
and so~$f(a_1),\,f(a_2),\,\dotsc$ converges
to~$0$ (because~$f$ is ultraweakly continuous).
It follows that~$f$ is continuous with respect to the norm
on~$\scrA$, and therefore bounded.
\begin{point}%
Let~$\scrB$ again be arbitrary.
Writing~$\Omega$ for the set of npu-maps $\omega\colon \scrB\to\C$
we have~\TODO{NO! this is not true}
$\|f(a)\|=\sup_{\omega\in\Omega} \left|\omega(f(a))\right|$
for all~$a\in\scrA$
by \TODO{}.
Hence it suffices to show that $\omega\circ f$
is bounded for each~$\omega\in\Omega$,
because then $\|f(a)\|\leq (\sup_{\omega\in\Omega}\|\omega\circ f\|)\,\|a\|$
for all~$a\in \scrA$,
and~$\sup_{\omega\in \Omega} \|\omega\circ f\|<\infty$
by the Principle of Uniform Boundedness (\sref{pub}).
Now,~$\omega\circ f$ is bounded by~\sref{uwc-bounded-1} 
(where~$\omega\in\Omega$),
because $\omega\circ f$ is ultraweakly continuous
(because $\omega$ and~$f$ are ultraweakly continuous).\qed
\end{point}
\end{point}
\end{point}
\begin{point}[vn-dense-pos]{Lemma}%
Let~$\scrS$ be an ultrastrongly dense $C^*$-subalgebra
of a von Neumann algebra~$\scrA$.
Let~$D$ be a norm dense subset of~$\scrS$.
Then~$\{\,d^*d\colon\,d\in D\,\}$
is ultrastrongly dense in~$\pos{\scrA}$.
\begin{point}{Proof}%
By Kaplansky's Density Theorem (\sref{kaplansky})
$\pos{\scrS}$ 
is ultrastrongly dense in~$\pos{\scrA}$,
so it suffices to show that $\{\, d^*d\,\colon d\in D\}$
is ultrastrongly dense in~$\pos{\scrS}$.
Given~$a\in \pos{\scrS}$,
there is a sequence $d_1,d_2,\dotsc \in D$
that norm converges to~$\sqrt{a}$,
so that~$d_1^*d_1,\,d_2^*d_2,\,\dotsc$
converges to~$\sqrt{a}^*\sqrt{a}\equiv a$
with respect to the norm, and thus ultrastrongly too.\qed
\end{point}
\end{point}
\end{parsec}%
\section{Tensor Product}
\TODO{complete}
\begin{parsec}%
\begin{point}{Definition}%
Let~$\scrA$ and~$\scrB$ be von Neumann algebras.
\begin{enumerate}
\item
The \Define{ultraweak tensor product topology}
on the algebraic tensor product~$\scrA\odot\scrB$
is the least topology that makes
all linear maps of the form $\sum_n \omega_n
\colon \scrA \odot \scrB\to\C$
continuous,
where $\omega_1,\omega_2,\dotsc \colon \scrA\to \C$
are linear maps which
are \emph{simple} and \emph{positive} (see below),
and $\sum_n \omega_n(1) <\infty$.

A linear map $\omega\colon \scrA\odot \scrB\to\C$
is 
\begin{enumerate}
\item
\Define{simple}
iff $\omega$ is of the form $\omega \equiv \sum_{n=1}^N \sigma_n\odot\tau_n$
for some ultraweakly continuous linear maps 
$\sigma_1,\dotsc,\sigma_N\colon \scrA\to\C$ and 
$\tau_1,\dotsc,\tau_N\colon \scrB\to\C$;
\item
\Define{positive}
iff $\sum_{i,j}\omega(\,a_i^*a_j\,\otimes\, b_i^*b_j\,)$
is positive 
for all $a_1,\dots,a_N\in\scrA$
and~$b_1,\dotsc,b_N\in\scrB$.
\end{enumerate}
\item
A bilinear map $\beta\colon \scrA\times \scrB\to\scrC$
to a von Neumann algebra~$\scrC$
is called \Define{normal}
when the unique extension $\beta_\odot \colon \scrA\odot \scrB\to \scrC$
is continuous with respect to the ultraweak tensor product topology 
on~$\scrA\odot\scrB$
and the ultraweak topology on~$\scrC$.
\end{enumerate}
\end{point}
\begin{point}{Theorem}%
Given von Neumann algebras~$\scrA$ and~$\scrB$
there is a von Neumann algebra~$\Define{\scrA\otimes\scrB}$
(called the \Define{tensor product} of~$\scrA$ and~$\scrB$)
and a normal
bilinear map $\Define{\otimes} \colon \scrA\times \scrB\to
\scrA\otimes \scrB$
with the property, that for every 
normal bilinear map $\beta\colon \scrA\times \scrB\to\scrC$
to a von Neumann algebra~$\scrC$
there is a unique ultraweakly continuous
map $\Define{\beta_\otimes}\colon \scrA\otimes \scrB
\to \scrC$ with $\beta_\otimes(a\otimes b) = \beta(a,b)$
for all~$a\in \scrA$ and $b\in\scrB$.
Moreover,
$\beta_\otimes$ is
\begin{enumerate}
\item
multiplicative
iff $\beta(a_1,b_1)\beta(a_2,b_2)=\beta(a_1a_2,b_1b_2)$
for all~$a_1,a_2\in\scrA$ and $b_1,b_2\in\scrB$;
\item
involution preserving
iff $\beta(a,b)^* = \beta(a^*,b^*)$ for all~$a\in\scrA$
and $b\in\scrB$;
\item
unital iff $\beta(1,1)=1$;
subunital iff $\beta(1,1)\leq 1$;
\item
positive iff 
$\sum_{i,j} \beta(a_i^*a_j,b_i^*b_j) \geq 0$
for all~$a_1,\dotsc,a_N\in\scrA$,$b_1,\dotsc,b_N\in\scrB$;
\item
completely positive iff 
the matrix $(\ \beta(a_i^*a_j,b_i^*b_j)\ )_{i,j}\geq 0$
is positive
for all~$a_1,\dotsc,a_N\in\scrA$
and $b_1,\dotsc,b_N\in\scrB$;
\end{enumerate}
Given ultraweakly continuous maps $f\colon \scrA\to\scrA'$
and $g\colon \scrB\to\scrB'$
to von Neumann algebras $\scrA'$ and~$\scrB'$,
the assignment $(a,b)\mapsto f(a)\otimes g(b)$
gives a normal bilinear map 
$\beta\colon \scrA\times \scrB\to \scrA'\otimes \scrB'$.
Then $\Define{f\otimes g}:=\beta_\otimes\colon \scrA\otimes \scrB
\to\scrA'\otimes \scrB'$
is
\begin{enumerate}
\item multiplicative
when $f$ and~$g$ are multiplicative;
\item involution preserving
when $f$ and~$g$ are involution preserving;
\item unital when $f$ and~$g$ are unital;
	subunital when $f$ and~$g$ are subunital;
\item completely positive when $f$ and~$g$ are completely positive.
\end{enumerate}
\end{point}
\end{parsec}
\end{document}
