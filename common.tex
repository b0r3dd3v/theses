%\usepackage[showframe]{geometry}
\usepackage{geometry}
\geometry{nohead,
%height=466pt,
width=345pt, % <- make sure the width is the same as b5
%tmargin=113pt,
paperwidth=170truemm,
paperheight=240truemm}
%\usepackage[frame,noinfo,width=176truemm,height=246truemm,center]{crop}
\usepackage[noinfo,width=176truemm,height=246truemm,center]{crop}

\usepackage{ccicons}
\usepackage{cite}
\usepackage{caption}
\usepackage{xfrac}
\usepackage{xparse}
\usepackage{relsize}
\usepackage{colortbl}
\usepackage{bussproofs}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{makeidx}
\usepackage{xstring}
\usepackage{braket}
\usepackage{mathtools}
\usepackage{multicol}
\usepackage{marginnote}
\usepackage{ifthen}
\usepackage{xifthen}
\usepackage{paralist}
\usepackage{calc}
\usepackage{tikz}
\usepackage{tikz-cd}
\usetikzlibrary{calc,arrows,matrix,decorations.pathreplacing}
\usepackage{picins}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{mathrsfs}
\usepackage{nicefrac}
\usepackage{stmaryrd}
\usepackage{sectsty}
\usepackage{xr}
\usepackage{tikz}
\usepackage[all]{xypic}
\usepackage{hyperref} % <- should be last because it redefined \ref, etc..

\renewcommand{\thefootnote}{\fnsymbol{footnote}}

% for in main.bib
\newcommand{\doi}[1]{\href{https://doi.org/#1}{doi:#1}}
\newcommand{\arXiv}[1]{\href{https://arxiv.org/abs/#1}{arXiv:#1}}


\newcommand{\purl}[1]{\href{#1}{#1}}

\newcommand{\spacingfix}[0]{\vspace{-1\baselineskip}\ignorespaces}
% used to correct the spacing issues when a point is ended with 
% an \end{enumerate} or \end{equation}

\newcommand{\IGNORE}[1]{}

\newcommand{\colofon}[4]{%
\vspace*{8em}
\noindent
\begin{center}
    \textcolor{darkblue}{\textsf{\textbf{ Identifiers}}}
    \vspace{.5em}

\href{https://hdl.handle.net/#4}{hdl:~#4}
    \vspace{.5em}

\href{https://arxiv.org/abs/#3}{arXiv:~#3}
    \vspace{.5em}

\textsc{isbn:}~#2
\end{center}
\vspace{3em}
\begin{center}
    \textcolor{darkblue}{\textsf{\textbf{ Persistent links}}}

\vspace{.5em}
\purl{https://arxiv.org/abs/#3}

\vspace{.5em}
\purl{https://doi.org/#4}

\vspace{.5em}
\purl{https://hdl.handle.net/#4}
\end{center}
\vspace{3em}

\begin{center}
    \textcolor{darkblue}{\textsf{\textbf{ \LaTeX{} code}}}
\vspace{.5em}

\purl{https://github.com/westerbaan/theses}
\end{center}
\vfill{}

\noindent
Printed by GVO drukkers \& vormgevers B.V., Ede, 
\purl{https://proefschriften.nl}.

\vspace{1em}
\noindent
Where applicable,
\ccCopy{}~2019 #1,
\ccLogo{}\,\ccAttribution{}  available under \textsc{cc by}, \cite{ccby40}.
\newpage
}

% macros concerning textstyle
\colorlet{darkgreen}{green!50!black}
\colorlet{darkblue}{blue!75!black}
\colorlet{lightblue}{blue!50!white}
\colorlet{lightgray}{gray!50!white}
\colorlet{darkgray}{gray!75!black}
\colorlet{darkred}{red!75!black}

\allsectionsfont{\sffamily\color{darkblue}}

\newcommand{\textPointHeaderI}[1]{\textcolor{darkblue}{\textbf{\textsf{#1}}}}
\newcommand{\textPointHeaderII}[1]{\textcolor{darkblue}{\textsf{#1}}}
\newcommand{\textPointHeaderIII}[1]{\textcolor{lightgray}{\textsf{#1}}}
\newcommand{\textParsecNumber}[1]{\textcolor{darkblue}{\textbf{\textsf{#1}}}}
\newcommand{\textPointNumberI}[1]{\textcolor{darkblue}{\textsf{#1}}}
\newcommand{\textPointNumberII}[1]{\textcolor{lightblue}{\textsf{#1}}}
\newcommand{\textPointNumberIII}[1]{\textcolor{lightgray}{\textsf{#1}}}
\newcommand{\textDefine}[1]{\textcolor{darkblue}{#1}}
\newcommand{\textSref}[1]{\textsf{#1}}
\newcommand{\textTodo}[1]{\textcolor{darkred}{#1}}
\newcommand{\textRemark}[1]{\textcolor{purple}{#1}}

\newcommand{\Define}[1]{\textDefine{#1}}

\newcommand{\grayed}[1]{\textcolor{darkgray}{#1}}

\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}
\renewcommand{\nleq}{\not\leqslant}
\renewcommand{\ngeq}{\not\geqslant}

\newcommand{\Cat}[1]{\mathbf{#1}}
\newcommand{\cW}[1]{\Cat{cW}^*_{\text{\textsc{#1}}}}
\newcommand{\haW}[1]{\Cat{haW}^*_{\text{\textsc{#1}}}}
\newcommand{\W}[1]{\Cat{W}^*_{\text{\textsc{#1}}}}
\newcommand{\dW}[1]{\Cat{dW}^*_{\text{\textsc{#1}}}}
\newcommand{\cCstar}[1]{\Cat{cC}^*_{\text{\textsc{#1}}}}
\newcommand{\Cstar}[1]{\Cat{C}^*_{\text{\textsc{#1}}}}
\newcommand{\CH}{\Cat{CH}}
\newcommand{\op}[1]{{#1}{^{\mathsf{op}}}}

\newcommand{\ketbra}[2]{\left|#1\right>\!\left<#2\right|}
\newcommand{\uleq}{\mathbin{\rotatebox[origin=c]{90}{$\leq$}}}
\newcommand{\TR}{\mathop{\mathrm{tr}}}
\newcommand{\wn}{\mathop{\mathrm{wn}}}

\newcommand{\bsp}{\scrB}

\NewDocumentCommand{\vmleq}{o}{\mathrel{%
\IfNoValueTF{#1}{\lesssim}{\lesssim_{#1}}}}

% Common symbols
\newcommand{\C}{\mathbb{C}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\I}{\mathbb{I}}
\newcommand{\spec}{\mathrm{sp}}
\newcommand{\scrA}{\mathscr{A}}
\newcommand{\scrB}{\mathscr{B}}
\newcommand{\scrC}{\mathscr{C}}
\newcommand{\scrD}{\mathscr{D}}
\newcommand{\scrE}{\mathscr{E}}
\newcommand{\scrG}{\mathscr{G}}
\newcommand{\scrH}{\mathscr{H}}
\newcommand{\scrF}{\mathscr{F}}
\newcommand{\scrP}{\mathscr{P}}
\newcommand{\scrK}{\mathscr{K}}
\newcommand{\scrL}{\mathscr{L}}
\newcommand{\scrR}{\mathscr{R}}
\newcommand{\scrS}{\mathscr{S}}
\newcommand{\scrT}{\mathscr{T}}
\newcommand{\scrX}{\mathscr{X}}
\newcommand{\scrY}{\mathscr{Y}}
\newcommand{\scrZ}{\mathscr{Z}}

\newcommand{\ceil}[1]{\left\lceil#1\right\rceil}
\newcommand{\cceil}[1]{\left\lceil\!\!\left\lceil#1\right\rceil\!\!\right\rceil}
\newcommand{\cfloor}[1]{\left\lfloor\!\!\left\lfloor#1\right\rfloor\!\!\right\rfloor}
\newcommand{\floor}[1]{\left\lfloor#1\right\rfloor}
\newcommand{\ceill}[1]{\left\lceil#1\right)}
\newcommand{\ceilr}[1]{\left(#1\right\rceil}
\newcommand{\floorl}[1]{\left\lfloor#1\right)}
\newcommand{\floorr}[1]{\left(#1\right\rfloor}
\newcommand{\absl}[1]{\left|#1\right)}
\newcommand{\absr}[1]{\left(#1\right|}

\newcommand{\linf}{\ell^\infty}
\newcommand{\incfun}{\mathcal{J}}
\newcommand{\limp}{\mathbin{\multimap}}
\newcommand{\Mon}{\mathrm{Mon}}
\newcommand{\CMon}{\mathrm{cMon}}
\newcommand{\nsp}{\mathrm{nsp}}
\newcommand{\qbit}{\mathsf{qubit}}
\newcommand{\bit}{\mathsf{bit}}
\DeclarePairedDelimiter{\sem}{\llbracket}{\rrbracket}

\newcommand{\Real}[1]{#1_{\R}}
\newcommand{\Imag}[1]{#1_{\I}}
\newcommand{\sa}[1]{#1_{\R}}
\newcommand{\pos}[1]{#1_{+}}
\newcommand{\bang}{\mathord{!}}

\newcommand\T{\mathrm{t}} % for transpose

\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\length}{length}
\DeclareMathOperator{\interior}{in}
\DeclareMathOperator{\Stat}{Stat}
\DeclareMathOperator{\Pred}{Pred}
\DeclareMathOperator{\Pure}{Pure}
\DeclareMathOperator{\SPred}{SPred}
\DeclareMathOperator{\IM}{im}
%\newcommand\BOX{{\rlap{\kern-1pt\rotatebox[origin=c]{45}{$\diamond$}}\phantom{\diamond}}}
\newcommand\BOX{%
    % {\tikz[baseline]{\draw (-0.3ex,0) rectangle (0.3ex,0.6ex)}}%
    {\rlap{\kern .5pt\tikz[baseline]{\draw[line width=0.08ex] (0,0) rectangle (0.6ex,0.6ex)}}%
    \phantom{\diamond}}}
\DeclareMathOperator{\IMperp}{im^\perp}
\DeclareMathOperator{\cok}{cok}
\DeclareMathOperator{\Par}{Par}
\DeclareMathOperator{\Tot}{Tot}
\newcommand{\andthen}[2]{#1 \mathbin{\&} #2}
\newcommand\asrt{\mathrm{asrt}}
\newcommand\sef{\mathrm{seff}}
\newcommand\pproj{\mathord{\vartriangleright}}
\newcommand{\cmpr}[2]{\ensuremath{\{#1|{\kern.2ex}#2\}}}
\newcommand{\id}{\mathrm{id}}
\DeclareMathOperator{\NStat}{NStat}
\DeclareMathOperator{\Scal}{Scal}
\DeclareMathOperator{\Cont}{C}
\DeclareMathOperator{\Colim}{Colim}
\DeclareMathOperator{\hZ}{hZ}
\DeclareMathOperator{\Inv}{Inv}
\DeclareMathOperator{\Proj}{Proj}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\Ker}{Ker}
\DeclareMathOperator{\Ran}{Ran}
\DeclareMathOperator{\Nsb}{Nsb}
\newenvironment{spmatrix}{%
    \left(\begin{smallmatrix}}{%
    \end{smallmatrix}\right)}

\newcommand\after{\mathop{\circ}}
\newcommand\hafter{\mathop{\hat\circ}}
\newcommand\hotimes{\mathbin{\hat{\otimes}}}
\newcommand\ad{\mathrm{ad}}
\newcommand{\uwlim}{\qopname\relax m{uwlim}}
\newcommand{\unlim}{\qopname\relax m{unlim}}
\newcommand{\uslim}{\qopname\relax m{uslim}}
\newcommand\concat{\mathbin{\raisebox{1ex}{\scalebox{.7}{$\frown$}}}}
\newcommand\ncp{\mathrm{ncp}}
\newcommand\pto{\rightharpoonup}
\newcommand\pfrom{\leftharpoonup}
\newcommand{\pullback}[1][dr]{\save*!/#1-1.2pc/#1:(-1,1)@^{|-}\restore}
\newcommand\vN{\mathsf{vN}}
\newcommand\CvN{\mathsf{CvN}}
\newcommand\OUG{\mathsf{OUG}}
\newcommand\EJA{\mathsf{EJA}}
\newcommand\OUS{\mathsf{OUS}}
\newcommand\SET{\mathsf{Set}}
\newcommand\CRng{\mathsf{CRng}}
\newcommand\Rng{\mathsf{Rng}}
\newcommand\bCH{\mathsf{CH}}
\newcommand\AConvM{\mathsf{AConv}_M}
\newcommand\EMod{\mathsf{EMod}}
\newcommand{\bigovee}{\mathop{\vphantom{\sum}\mathchoice%
        {\vcenter{\hbox{\huge $\ovee$}}}%
        {\vcenter{\hbox{\Large $\ovee$}}}%
        {\ovee}{\ovee}}\displaylimits}
\DeclareMathOperator{\Kl}{\mathcal{K}\!\ell}
\newcommand\rfrac[2]{\reflectbox{\nicefrac{\reflectbox{\ensuremath{#1}}}{\reflectbox{\ensuremath{#2}}}}}

\makeatletter
\newcommand{\bigperp}{%
  \mathop{\mathpalette\bigp@rp\relax}%
  \displaylimits
}

\newcommand{\bigp@rp}[2]{%
  \vcenter{
    \m@th\hbox{\scalebox{\ifx#1\displaystyle2.1\else1.5\fi}{$#1\perp$}}
  }%
}
\makeatother


\makeatletter
\def\ourrawref#1{%
    \expandafter\expandafter\expandafter
    \@car\csname r@#1\endcsname\@nil
}
\makeatother

% number a single equation in an align*
% http://tex.stackexchange.com/questions/42726/
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}

% typesetting theorems
\newcommand{\qed}{\hfill\textcolor{darkblue}{\ensuremath{\square}}}


% used for arithmetic
\newcounter{tmptmp} 
\newcounter{tmptmp2} 

% The content of this thesis is grouped into numbered paragraphs,
% which are called "parsecs" (for paragraph--section),
% and these parsecs contain several points.
\newcounter{parsec} % keeps track of the current parsec number
\newcounter{parsecMajor}
\newcounter{parsecMinor} % parsec = 10 * parsecMajor + parsecMinor

\newcommand\refsforparsec{%
    \setcounter{parsecMajor}{\value{parsec}/10}%
    \setcounter{parsecMinor}{\value{parsec}-10*\value{parsecMajor}}%
    \setcounter{parsec}{\value{parsec}-1}%
    \refstepcounter{parsec}%
}

% The first argument is the label this parsec will have--use \sref 
% 	to refer to a parsec.
\NewDocumentEnvironment{parsec}{g o}{%
	\leavevmode\unskip%
	\par\vskip1em\noindent%
    \renewcommand{\theparsec}{\the\value{parsecMajor}\alph{parsecMinor}}%
    \setcounter{parsec}{#1}%
    \refsforparsec{}%
	%%\setcounter{point}{0}% - point is set to 0 by \numberwithin
	% In the footer of every odd page we list the parsecs present on 
	% the spread.  We pass this information to the footer via the 
	% \markboth,\leftmark,\rightmark-mechanism, which is normally
	% used to display the section and subsection names and numbers
	% in the header.
	% 	Recall that \leftmark will return the LAST value passed
	% to the first argument of \markboth on this page. (The difficulty
	% of implementing \leftmark is that a \markboth that will belong
	% to the next page can be called before the current page is shipped,
	% because this \markboth may be part of the text that overflows the
	% current page.)
	%	\rightmark will return the FIRST value passed to the second
	% argument of \markboth on this page.
	%	Since we would not only like to know if this parsec with number
	% say  N  is present on this spread, but also whether it spills over 
	% to the next spread (or has spilled over from the previous spread),
	% we keep track of whether the parsec started on this spread, 
	% encoded by  2N,  or whether the parsec ended on this spread,
	% encoded by  2N+1.
	\setcounter{tmptmp}{2*\value{parsec}}%
	\markboth{\the\value{tmptmp}}{\the\value{tmptmp}}%
	\IfValueT{#2}{\label{#2}}%
    % For the table of contents:
    \renewcommand{\thepoint}{\the\value{parsecMajor}\alph{parsecMinor}}%
    \setcounter{point}{\value{point}-1}%
    \refstepcounter{point}% 
    \label{parsec-\the\value{parsec}}%
	% Display the parsec number in the margin.
        \marginnote{\makebox[3em][c]{\textParsecNumber{%
            \the\value{parsecMajor}%
            \alph{parsecMinor}%
            }}}%
	\ignorespaces%
}{%
	\leavevmode\unskip%
	\setcounter{tmptmp}{2*\value{parsec}+1}%
	\markboth{\the\value{tmptmp}}{\the\value{tmptmp}}%
	\ignorespaces%
}

\newcounter{point} % keeps track of the current point
\newcounter{pointMajor}
\newcounter{pointMinor}
\numberwithin{point}{parsec}
\newcounter{pointdepth}  % keeps track of the depth of the current point
			 % --- points may be nested.

\newcommand\refsforpoint{%
    \setcounter{pointMajor}{\value{point}/10}%
    \setcounter{pointMinor}{\value{point}-10*\value{pointMajor}}%
    \setcounter{point}{\value{point}-1}%
    \refstepcounter{point}%
}

\NewDocumentEnvironment{point}{g o g}{%
	\leavevmode\unskip%
	\setcounter{pointdepth}{\value{pointdepth}+1}%
	\refstepcounter{point}% TODO: <- is this needed?
    \setcounter{point}{#1}%
    % setup labels
    \IfValueT{#2}{%
        \renewcommand{\thepoint}{\the\value{parsec}}%
        \refsforpoint{}%
        \label{#2::parsec}%
        \renewcommand{\thepoint}{\Roman{pointMajor}\alph{pointMinor}}%
        \refsforpoint{}%
        \label{#2::point}%
        \renewcommand{\thepoint}{\theparsec\,\Roman{pointMajor}\alph{pointMinor}}%
        \refsforpoint{}%
        \label{#2}%
    }%
    \renewcommand{\thepoint}{\theparsec\,\Roman{pointMajor}\alph{pointMinor}}%
    \refsforpoint{}%
    \label{parsec-\the\value{parsec}.\the\value{point}}%
	\ifthenelse{\equal{\value{point}}{10}}{}{%
		\ifthenelse{\equal{\value{pointdepth}}{1}}{%
			\par\penalty-100\vskip.6em\noindent%
		}{%
			\ifthenelse{\equal{\value{pointdepth}}{2}}{%
				\par\penalty-50\vskip.2em\noindent%
			}{%
				\par\penalty-25\vskip.1em\noindent%
			}%
		}%
		\marginnote{\makebox[2em][c]{\small%
                    \ifthenelse{\equal{\value{pointdepth}}{1}}{%
                        \textPointNumberI{\Roman{pointMajor}\alph{pointMinor}}%
                    }{%
                        \ifthenelse{\equal{\value{pointdepth}}{2}}{%
                            \textPointNumberII{\Roman{pointMajor}\alph{pointMinor}}%
                        }{%
                            \textPointNumberIII{\Roman{pointMajor}\alph{pointMinor}}%
                        }%
		}}}%
	}%
	\IfValueT{#3}{%
		\ifthenelse{\equal{\value{pointdepth}}{1}}{%
			\textPointHeaderI{#3}%
		}{%
			\ifthenelse{\equal{\value{pointdepth}}{2}}{%
				\textPointHeaderII{#3}%
			}{%
				\textPointHeaderIII{(#3)}%
			}}%
	\ \ }%	
\ignorespaces%
}{%
\leavevmode\unskip%
\setcounter{pointdepth}{\value{pointdepth}-1}%
\ignorespaces%
}

% Refer to a parsec.
\NewDocumentCommand{\sref}{m}{\textSref{%
	\ifthenelse{%
		\equal{\value{parsec}}{\ourrawref{#1::parsec}}%
	}{%
		\ref{#1::point}%
	}{%
        \ref{#1}%
	}%
}}

% Adjust footer and header:
\usepackage{fancyhdr}
\pagestyle{fancy}
\renewcommand{\headrulewidth}{0pt} % we want no header line

% Since we use \markboth,\leftmark,\rightmark to keep track of the parsecs
% on a given spread, we should neutralize its old user:
\renewcommand{\chaptermark}[1]{}  
\renewcommand{\sectionmark}[1]{}

\fancyhead{}

% These counters are used for computation
\newcounter{firstParsec}
\newcounter{lastParsec}
\newcounter{firstParsecF}
\newcounter{lastParsecF}
\newcounter{firstParsecMajor}
\newcounter{firstParsecMinor}
\newcounter{lastParsecMajor}
\newcounter{lastParsecMinor}

% parsecToBeContinued is 1 if the previous spread spilled a parsec,
% and 0 otherwise.
\newcounter{parsecToBeContinued}  
\setcounter{parsecToBeContinued}{0}

\newcommand\ourfancyfooters{%
    % Set the footer.  It contains the parsecs on this page.
    % We use "\rightmark+0", because \rightmark might be empty.
    \fancyfoot[CE]{%
        \IfInteger{\rightmark}{%
            \setcounter{tmptmp}{\leftmark+0}%
            \ifthenelse{\equal{\value{tmptmp}}{\value{lastParsecF}}}{%
                % the last parsec encountered on this page is the same as
                % the last parsec encountered on the previous page;
                % so either the parsec spans the whole of this even page,
                % or there's no parsec active at all.
                % In both cases the first parsec on the spread will
                % be the first parsec on the odd page that 
                % comes next, so we need not set firstParsecF here.
                \setcounter{firstParsecF}{0}%
            }{%
                \setcounter{firstParsecF}{\rightmark+0}%
            }
        }{%
        }%
    }%
    \fancyfoot[RO]{%
        \textsf{\footnotesize\textcolor{lightgray}{\thepage}}}%
    \fancyfoot[CO]{%
        % firstParsecF is already set by the even page that came before,
        %  ... unless it is 0.
        \ifthenelse{\equal{\value{firstParsecF}}{0}}{%
            \setcounter{firstParsecF}{\rightmark+0}%
        }{% 
            %do nothing
        }
        \setcounter{firstParsec}{\value{firstParsecF}/2}%
        \setcounter{lastParsecF}{\leftmark+0}%
        \ifthenelse{\equal{\value{lastParsecF}}{0}}{%
            % do nothing
        }{%
            \setcounter{lastParsec}{\value{lastParsecF}/2}%
            \textPointNumberI{%
                \ifthenelse{\equal{\value{parsecToBeContinued}}{1}}{..}{}%
                \setcounter{firstParsecMajor}{\value{firstParsec}/10}%
                \setcounter{firstParsecMinor}{\value{firstParsec}-\value{firstParsecMajor}*10}%
                \the\value{firstParsecMajor}\alph{firstParsecMinor}%
                \ifthenelse{\equal{\value{firstParsec}}{\value{lastParsec}}}{%
                    % TODO
                }{%  no footer without parsecs
                    \setcounter{tmptmp}{\value{firstParsec}+1}%
                    \ifthenelse{\equal{\value{tmptmp}}{\value{lastParsec}}}{, }{--}% TODO: fix this, maybe?
                    \setcounter{lastParsecMajor}{\value{lastParsec}/10}%
                    \setcounter{lastParsecMinor}{\value{lastParsec}-\value{lastParsecMajor}*10}%
                    \the\value{lastParsecMajor}\alph{lastParsecMinor}%
                }%
                \setcounter{tmptmp}{\value{lastParsec}*2}%
                \ifthenelse{\equal{\value{tmptmp}}{\value{lastParsecF}}}{%
                    ..\setcounter{parsecToBeContinued}{1}%
                }{%
                    \setcounter{parsecToBeContinued}{0}%
                }%
            }%
        }%
    }%
}

\ourfancyfooters
\fancypagestyle{plain}{\ourfancyfooters}

% Index support for parsecs
\def\parsechyperlink#1{\sref{parsec-#1}}
\makeatletter
\def\@wrindex#1{%
   \protected@write\@indexfile{}%
   {\string\indexentry{#1|parsechyperlink{\the\value{parsec}.\the\value{point}}}{\the\value{parsec}.\the\value{point}}}%
 \endgroup
 \@esphack}%
\makeatother


% TOC support for parsecs
\let\oldchapter\chapter%
\renewcommand\chapter[1]{%
    \oldchapter{#1}%
    \setcounter{tmptmp}{(\value{parsec}/10)*10+10}
    \addtocontents{parsectoc}{\protect\contentsline{chapter}{\numberline{\thechapter} #1}{\sref{parsec-\the\value{tmptmp}}}{chapter.\thechapter}}%
}
\let\oldsection\section%
\renewcommand\section[1]{%
    \oldsection{#1}%
    \setcounter{tmptmp}{(\value{parsec}/10)*10+10}
    \addtocontents{parsectoc}{\protect\contentsline{section}{\numberline{\thesection} #1}{\sref{parsec-\the\value{tmptmp}}}{section.\thesection}}%
}
\let\oldsubsection\subsection%
\renewcommand\subsection[1]{%
    \oldsubsection{#1}%
    \setcounter{tmptmp}{(\value{parsec}/10)*10+10}
    \addtocontents{parsectoc}{\protect\contentsline{subsection}{\numberline{\thesubsection} #1}{\sref{parsec-\the\value{tmptmp}}}{subsection.\thesubsection}}%
}
\let\oldsubsubsection\subsubsection%
\renewcommand\subsubsection[1]{%
    \oldsubsubsection{#1}%
    \setcounter{tmptmp}{(\value{parsec}/10)*10+10}
    \addtocontents{parsectoc}{\protect\contentsline{subsubsection}{\numberline{\thesubsubsection} #1}{\sref{parsec-\the\value{tmptmp}}}{subsubsection.\thesubsubsection}}%
}

\newcommand\backmattertitle[1]{{%
    \sffamily\color{darkblue}\Huge\bfseries #1\vspace{1em}}}

% customize title of index
\makeatletter
\renewenvironment{theindex}
               {\if@twocolumn
                  \@restonecolfalse
                \else
                  \@restonecoltrue
                \fi
                \twocolumn[\backmattertitle{Index}]%
                \thispagestyle{plain}\parindent\z@
                \parskip\z@ \@plus .3\p@\relax
                \columnseprule \z@
                \columnsep 35\p@
                \let\item\@idxitem}
               {\if@restonecol\onecolumn\else\clearpage\fi}
\makeatother
