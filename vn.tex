\documentclass[a]{subfiles}
\begin{document}
\chapter{Von Neumann Algebras}
%
% von Neumann algebras
%
\section{Definition and counterexamples}
\begin{parsec}[vna]%
\begin{point}{Definition}%
A $C^*$-algebra~$\scrA$
is a \Define{von Neumann algebra}
when
\begin{enumerate}
\item
every bounded directed subset~$D$
of self-adjoint elements of~$\scrA$ (so $D\subseteq \sa{\scrA}$) 
has a supremum $\bigvee D$ in $\sa{\scrA}$, and
\item
if $a$ is a positive element of~$\scrA$
with $\omega(a)=0$ for every \emph{normal} (see below) positive 
linear map $\omega\colon \scrA\to \C$,
then~$a=0$.
\end{enumerate}
\begin{point}%
A positive linear map $\omega\colon \scrA\to \C$
is called \Define{normal}
if $\omega(\bigvee D) = \bigvee_{d\in D} \omega(d)$
for every bounded directed subset of self-adjoint elements of~$D$
which has a supremum $\bigvee D$ in $\sa{\scrA}$.
\end{point}%
\begin{point}%
The \Define{ultraweak topology} on $\scrA$
is the least topology on~$\scrA$
that makes all normal positive linear maps $\omega\colon \scrA\to \C$
continuous.
The \Define{ultrastrong topology} on~$\scrA$
is the least topology on~$\scrA$
that makes $a\mapsto \omega(a^*a)$ continuous
for every np-map~$\omega\colon \scrA\to \C$.
\end{point}
\end{point}
\begin{point}%
We work with the ultraweak and ultrastrong topology in tandem,
because neither is ideal, and they tend to be complementary:
for example, $a\mapsto a^*$ is ultraweakly continuous
but not ultrastrongly (see~\TODO{}), 
while $a\mapsto \left|a\right|$
is ultrastrongly continuous (see~\TODO{}) but not ultraweakly
(\TODO{}).

When dealing with the ultrastrong topology
it is useful to recall that
every np-map gives rise
to an inner-product $[a,b]_\omega = \omega(a^*b)$
and semi-norm $\|a\|_\omega = \|[a,a]_\omega\|^{\nicefrac{1}{2}}
= \omega(a^*a)^{\nicefrac{1}{2}}$.
\TODO{finish}
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}[von-neumann-subalgebra]{Example}%
A $C^*$-subalgebra~$\scrB$
of a von Neumann algebra~$\scrA$
is called a \Define{von Neumann subalgebra}
(and is itself a von Neumann algebra)
if for every bounded directed subset~$D$
of self-adjoint elements from~$\scrB$
we have $\bigvee D\in\scrB$
(where the supremum is taken in~$\sa{\scrA}$).
\end{point}

\TODO{add more examples}
\end{parsec}
\begin{parsec}%
\begin{point}{Exercise}%
We start with some counterexamples in $\scrB(\ell^2)$
to sharpen your understanding of the ultrastrong and ultraweak topologies,
and so that you may better appreciate
the strange maneuvers we'll need to pull off later on.
\begin{enumerate}
\item
Given~$n,m\in \N$,
we denote by $\ketbra{n}{m}$
the bounded operator on~$\ell^2$
given by $(\ketbra{n}{m})(f)(n)=f(m)$
and~$(\ketbra{n}{m})(f)(k)=0$ for $k\neq n$
and $f\in \ell^2$.

Verify the following computation rules,
where $k,\ell,m,n\in \N$.
\begin{equation*}
(\ketbra{n}{m})^*\ =\ \ketbra{m}{n},
\qquad
\ketbra{n}{m}\ketbra{\ell}{k}\ =\ 
\begin{cases}
\ \ \ketbra{n}{k} & \text{if $m=k$} \\
\ \ 0 & \text{otherwise}
\end{cases}
\end{equation*}
\item
Show that $\bigvee_N \sum_{n=0}^N \ketbra{n}{n}=1$.

Conclude that~$(\,\ketbra{n}{n}\,)_n$
converges ultrastrongly (and ultraweakly) to~$0$.

Thus ultrastrong (and ultraweak) convergence does not imply norm convergence,
as one might have expected.
But we also see that if a sequence~$(b_n)_n$ converges ultrastrongly
(or ultraweakly) to some~$b$,
then $(\|b_n\|)_n$ doesn't even have to converge to~$\|b\|$
(compare this with Lebesgue's dominated convergence
theorem \TODO{add ref.}).

(Note that~$(\ketbra{n}{n})_n$ resembles a moving bump, from measure theory.)
\item
Show that~$(\,\ketbra{0}{n}\,)_n$ converges ultrastrongly 
(and ultraweakly) to~$0$.

Deduce that $(\,\ketbra{n}{0}\,)_n$ converges ultraweakly to~$0$,
but doesn't converge ultrastrongly at all.

Conclude that~$a\mapsto a^*$ is not ultrastrongly continuous 
on~$\scrB(\ell^2)$.

(This has the annoying side-effect,
that it is not immediately clear that the ultrastrong
closure of a $C^*$-subalgebra of a von Neumann algebra
ultrastrongly closed; we'll deal with this in~\sref{ultraclosed}.)
\item
Show that $\ketbra{n}{0}+\ketbra{0}{n}$
converges ultraweakly to~$0$ as $n\to \infty$,
while $(\ketbra{n}{0}+\ketbra{0}{n})^2\equiv \ketbra{0}{0}+\ketbra{n}{n}$
converges ultraweakly to~$\ketbra{0}{0}$.

Conclude that~$a\mapsto a^2$ is not ultraweakly continuous on~$\scrB(\ell^2)$.

Conclude that $a,b\mapsto ab$ is not jointly ultraweakly continuous
on~$\scrB(\ell^2)$.

Prove that~$\left|\, \ketbra{n}{0}+\ketbra{0}{n}\,\right|
= \ketbra{0}{0}+\ketbra{n}{n}$.

Conclude that~$a\mapsto \left|a\right|$
is not ultraweakly continuous on~$\sa{(\scrB(\ell^2))}$.

(We'll see in~\sref{proto-kaplansky} that $a\mapsto \left|a\right|$
is ultrastrongly continuous on self-adjoint elements.)

\item
Let us consider the two extensions of~$\left|\,\cdot\,\right|$
to arbitrary elements, namely
$a\mapsto \sqrt{a^*a}=:\Define{\left|a\right|_s}$ and 
$a\mapsto \sqrt{aa^*}=:\Define{\left|a\right|_r}$.

Prove that $\ketbra{0}{0} + \ketbra{0}{n}$
converges ultrastrongly to~$\ketbra{0}{0}$ as $n\to \infty$.

Show that $\left|\,\ketbra{0}{0}+\ketbra{0}{n}\,\right|_s
= \ketbra{0}{0}
+\ketbra{0}{n}
+\ketbra{n}{0}
+\ketbra{n}{n}$
converges ultraweakly to~$\left|\,\ketbra{0}{0}\,\right|_s
\equiv \ketbra{0}{0}$
as $n\to \infty$,
but not ultrastrongly.

Show that $\left|\,\ketbra{0}{0}+\ketbra{0}{n}\,\right|_r
= \sqrt{2} \ketbra{0}{0}$.

Conclude that $\left|\,\cdot\,\right|_s$
and $\left|\,\cdot\,\right|_r$
are not ultrastrongly continuous on~$\scrB(\ell^2)$.

(However, we'll see in~\TODO{}
that if a net $(b_\alpha)_\alpha$
in a von Neumann algebra
converges ultrastrongly, to say~$b$,
and $(b_\alpha^*)_\alpha$
converges ultrastrongly too,
then $(\,\left|b_\alpha\right|_s\,)_\alpha$
converges ultrastrongly to~$\left|b\right|_s$.)

\item
Show that $1+\ketbra{n}{0}+\ketbra{0}{n}$
are positive,
and 
converge ultraweakly to~$1$,
while their squares
$1+\ketbra{n}{n}+\ketbra{0}{0}+2\ketbra{n}{0}+2\ketbra{0}{n}$
converge ultraweakly to $1+\ketbra{0}{0}$
(as $n\to\infty$).

Hence~$a\mapsto a^2$
and $a\mapsto \sqrt{a}$
are not ultraweakly continuous on $\pos{\scrB(\ell^2)}$.

\item
For the next counterexample,
we need a growing moving bump,
which still converges ultraweakly.
Sequences won't work here:

Show that $n\ketbra{n}{n}$ does not converge ultraweakly as~$n\to\infty$.

Show that $n \ketbra{f(n)}{f(n)}$ does not converge ultraweakly
as $n\to\infty$
for every strictly monotone map~$f\colon \N\to\N$.

So we'll resort to a net.
Let~$D$ be the directed set which consists of pairs $(n,f)$,
where $n\in \N\backslash\{0\}$ and $f\colon \N\to\N$
is monotone, ordered by $(n,f)\leq (m,g)$ iff $n\leq m$ and $f\leq g$.

Show that the net $(\, n\ketbra{f(n)}{f(n)}\,)_{n,f\in D}$
converges ultrastrongly to~$0$.

So a net which converges ultrastrongly need not be bounded!
(The cure for this pathology is Kaplansky's density theorem, 
see~\TODO{kaplansky})

Show that $\frac{1}{n} \ketbra{f(n)}{0}$
converges ultrastrongly to~$0$ as $D\ni(n,f)\to \infty$.

Show that the product
$\ketbra{f(n)}{0} = (\,n\ketbra{f(n)}{f(n)}\,)\,(\,\frac{1}{n}
\ketbra{f(n)}{0}\,)$
does not converge ultrastrongly 
as $D\ni(n,f)\to\infty$.

Conclude that multiplication $a,b\mapsto ab$
is not jointly ultrastrongly continuous on~$\scrB(\ell^2)$,
even when~$b$ is restricted to a bounded set.

(Nevertheless we'll see that multiplication is ultrastrongly continuous
when~$a$ is restricted to a bounded set,
and that multiplication is ultrastrongly continuous
separately in both arguments.)

\item
Show that
$a_{n,f} = \frac{1}{n}(\ketbra{f(n)}{0}+\ketbra{0}{f(n)})
\,+\, n\ketbra{f(n)}{f(n)}$
converges ultrastrongly to~$0$
as $D\ni(n,f)\to\infty$,
while $a_{n,f}^2$ does not.

Hence~$a\mapsto a^2$ is not ultrastrongly continuous on~$\sa{\scrB(\ell^2)}$.

\item
Let us show that~$\scrB(\ell^2)$
is not ultraweakly complete.

Show that there is an unbounded linear map~$f\colon \ell^2\to\C$,
and that for each finite dimensional linear subspace~$S$ of~$\ell^2$,
there is a unique vector~$x_S\in S$ 
with
$f(x)=\left<x_S,y\right>$ for all~$y\in S$
(using~\sref{riesz-representation-theorem}).

Consider the net~$(\,\ketbra{e}{x_S}\,)_S$
where~$S$ ranges over the finite dimensional subspaces of~$\ell^2$
ordered by inclusion,
and~$e$ is some fixed vector in~$\ell^2$ with~$\|e\|=1$.

Let~$\omega\colon \scrB(\ell^2)\to\C$
be an np-map,
so $\omega\equiv \sum_n \left<y_n,(\,\cdot\,)y_n\right>$
for $y_1,y_2,\dotsc \in \ell^2$ with $\sum_n \|y_n\|^2 <\infty$,
see~\sref{bh-np}.

Show that $\omega(\,\ketbra{e}{x_S}-\ketbra{e}{x_T}\,)
= \left<\,x_S-x_T,\,\sum_n y_n\left<y_n,e\right>\,\right> = 0$
when $S$ and~$T$ are finite dimensional linear subspaces of~$\ell_2$
which contain the vector $\sum_n y_n\left<y_n,e\right>$.

Conclude that~$(\,\ketbra{e}{x_S}\,)_S$
is ultraweakly Cauchy.

Show that if~$(\,\ketbra{e}{x_S}\,)_S$
converges ultraweakly to some~$A$ in~$\scrB(\ell^2)$,
then we have~$\left<e,Ay\right>=f(y)$
for all~$y\in\ell^2$.

Conclude that~$(\,\ketbra{e}{x_S}\,)_S$
does not converge ultraweakly,
and that~$\scrB(\ell^2)$ is not ultraweakly complete.

(Nevertheless, we'll see that every von Neumann algebra
is ultrastrongly complete, and that
every norm-bounded ultraweakly-Cauchy net
in a von Neumann converges, in~\sref{vn-complete}.)
\end{enumerate}
\end{point}
\end{parsec}
\section{The basics}
%
% multiplication turns suprema into ultraweak limits
%
\begin{parsec}%
\begin{point}%
It is clear that translation and scaling
on a von Neumann algebra
are ultraweakly (and ultrastrongly) continuous.
We will see in this paragraph that multiplication
is also ultraweakly (and ultrastrongly) continuous
in each coordinate.
Quite surprisingly,
the problem reduces to the ultraweak continuity
of $b\mapsto a^*ba$ by the following identity
(cf.~\TODO{refer to polarization identity}).
\end{point}
\begin{point}[mult-polarization]{Exercise}%
Show that for elements~$a,b,c$ of a $C^*$-algebra,
\begin{equation*}
\textstyle
a^*\,c\,b\ =\ \frac{1}{4}\,\sum_{k=0}^3\ i^k\  (i^ka+b)^*\,c\,(i^ka+b).
\end{equation*}
\end{point}
\begin{point}[vanishing-effects]{Lemma}%
Let~$(x_\alpha)_{\alpha\in D}$ be 
a net of effects of a von Neumann algebra~$\scrA$,
which converges ultraweakly to~$0$.
Let~$(b_\alpha)_{\alpha\in D}$ be a 
net of elements with~$\|b_\alpha\| \leq 1$ for all~$\alpha$.
Then $(x_\alpha b_\alpha)_\alpha$ converges ultraweakly
to~$0$.
\begin{point}{Proof}%
Let~$\omega\colon \scrA\to \C$ be an np-map.
We have, for each~$\alpha$,
\begin{alignat*}{3}
\left|\,\omega(x_\alpha b_\alpha)\,\right|^2
\ &=\ 
\left|\, \omega(\,\sqrt{x_\alpha}\,\sqrt{x_\alpha}\,b_\alpha\,)\, \right|^2
\qquad&&\text{since $x_\alpha\geq 0$}\\
\ &\leq\ 
\omega(x_\alpha)\  \omega(\,b_\alpha^* x_\alpha b_\alpha\,) 
\qquad&&\text{by \sref{cstar-cs}}\\
\ &\leq\ 
\omega(x_\alpha)\ \omega(b_\alpha^* b_\alpha)
\qquad&&\text{since $x_\alpha\leq 1$}\\
\ &\leq\ 
\omega(x_\alpha)\ \omega(1)
\qquad&&\text{since $b_\alpha^*b_\alpha\leq 1$ by \TODO{}}.
\end{alignat*}
Thus,
since $(\omega(x_\alpha))_\alpha$
converges to~$0$,
we see that $(\omega(x_\alpha b_\alpha))_\alpha$
converges to~$0$,
and so $(x_\alpha b_\alpha)_\alpha$ converges ultraweakly to~$0$.\qed
\end{point}
\end{point}
\begin{point}{Exercise}%
Let~$D$ be a bounded directed set of self-adjoint
elements of a von Neumann algebra~$\scrA$,
and let~$a\in \scrA$.
\begin{point}[vna-supremum-uwlimit]%
Show that the net~$(d)_{d\in D}$ converges ultraweakly to~$\bigvee D$.
\end{point}
\begin{point}[vna-supremum-mult]%
Use~\sref{vanishing-effects}
to show that $(da)_d$ converges ultraweakly to~$(\bigvee D)a$,
and that~$(a^*d)_d$ converges ultraweakly to~$a^* (\bigvee D)$.
\end{point}
\begin{point}[vna-supremum-commutes]%
Show that if~$ad=da$ for all~$d\in D$,
then $a(\bigvee D) = (\bigvee D)a $.
\end{point}
\begin{point}[vna-supremum-uslimit]%
Use~\sref{vanishing-effects}
to show that $(\bigvee D-d)^2$ converges ultraweakly to~$0$.

Conclude that~$(d)_{d\in D}$ converges ultrastrongly to~$\bigvee D$.
\end{point}
\end{point}
%
%  ad is normal
%
\begin{point}[ad-normal]{Proposition}%
Let~$a$ be an element of a von Neumann algebra~$\scrA$.
Then~$\bigvee_{d\in D} a^*\,d\,a = a^*\,(\bigvee D)\, a$
for every bounded directed subset~$D$ of self-adjoint
elements of~$\scrA$.
\begin{point}[ad-normal-1]{Proof}%
If~$a$ is invertible,
then the (by~\sref{ad-monotone}) order preserving map $b\mapsto a^*ba$
has an order preserving inverse (namely $b\mapsto (a^{-1})^* b a^{-1}$),
and therefor preserves all suprema.
\begin{point}%
The general case reduces to the case that~$a$ 
is invertible
in the following way.
There is (by~\sref{spectrum-bounded})
 $\lambda>0$ such that $\lambda+a$ is invertible.
Then as $d$ increases 
\begin{equation*}
a^*\,d\,a \ \equiv\  (\lambda+a)^*\,d\,(\lambda+a) \,-\,
 \lambda^2d \,-\, \lambda a^*d \,-\, \lambda da
\end{equation*}
converges ultraweakly
to~$a^* \,(\bigvee D)\,a$,
because $(\ (\lambda+a)^*\,d\,(\lambda+a)\ )_d$
converges ultraweakly to $(\lambda+a)^*\,(\bigvee D)\,(\lambda+a)$
by~\sref{ad-normal-1} and~\sref{vna-supremum-uwlimit},
and $(a^*d+da)_d$ converges ultraweakly to $a^*(\bigvee D)+(\bigvee D)a$
by~\sref{vna-supremum-mult}.
Since~$(a^*da)_d$ converges to~$\bigvee_{d\in D} a^*d a$ too,
we conclude that~$\bigvee_{d\in D} a^* \,d\, a = a^*\,(\bigvee D)\,a$.\qed
\end{point}
\end{point}
\end{point}
\begin{point}[p-uwcont]{Exercise}%
Show that for a positive linear map $f\colon \scrA\to\scrB$
between von Neumann algebras,
the following are equivalent.
\begin{enumerate}
\item
$f$ is ultraweakly continuous;
\item
$f(\bigvee D)=\bigvee_{d\in D}f(d)$ for each bounded 
directed~$D\subseteq\sa{\scrA}$;
\item 
$\omega\circ f\colon \scrA\to\C$ is normal 
for each np-map $\omega\colon \scrB\to\C$.
\end{enumerate}
Conclude that $b\mapsto a^*ba,\,\scrA\to\scrA$
is ultraweakly
continuous for every element~$a$ of a von Neumann 
algebra~$\scrA$.

Show that if such a positive linear map $f\colon \scrA\to\scrB$
is ultrastrongly continuous, then~$f$ is ultraweakly continuous.
(Hint: use that a bounded directed set 
$D\subseteq \sa{\scrA}$ converges ultrastrongly to~$\bigvee D$.)

The converse does not hold: give an example of a map~$f$ 
which is ultraweakly continuous, but 
not be ultrastrongly continuous. (Hint: transpose.)
\end{point}
\begin{point}[cp-uscont]{Proposition}%
Let $f\colon \scrA\to \scrB$
be a
positive linear map 
between von Neumann algebras $\scrA$ and~$\scrB$
with $f(a)^*f(a)\leq f(a^*a) \,\|f(1)\|$
for all~$a\in\scrA$.

If~$f$ is ultraweakly continuous,
then~$f$ is ultrastrongly continuous.
\begin{point}{Proof}%
To show that~$f$
is ultrastrongly continuous,
it suffices to show that~$f$ is ultrastrongly continuous at~$0$.
So let~$(b_\alpha)_\alpha$ be a net in~$\scrA$
which converges ultrastrongly to~$0$;
we must show that $(f(b_\alpha))_\alpha$
converges ultrastrongly to~$0$, c.q.~that
$(\,f(b_\alpha)^*f(b_\alpha)\,)_\alpha$ converges ultraweakly to~$0$.
Since
$f(b_\alpha)^*f(b_\alpha) \leq f(b_\alpha^*b_\alpha) \|f(1)\|$
it suffices to show that~$(\,f(b_\alpha^*b_\alpha)\,)_\alpha$
converges ultraweakly to~$0$,
but this follows from the
fact that~$f$ is ultraweakly continuous,
and~$(b_\alpha^*b_\alpha)_\alpha$
converges ultraweakly to~$0$
(since~$(b_\alpha)_\alpha$ converges ultrastrongly to~$0$).\qed
\end{point}
\end{point}
\begin{point}[mult-uws-cont]{Exercise}%
Let~$\scrA$ be a von Neumann algebra.
Show that~$b^*a^*b\,b^*ab \leq b^*a^*ab \|b^*b\|$
for all~$a,b\in\scrA$.
Conclude (using~\sref{cp-uscont}) 
that the map $a\mapsto b^*ab,\,\scrA\to\scrA$
is ultrastrongly continuous for every
 element~$b\in\scrA$.

Use this,
and~\sref{mult-polarization},
to
show that $b\mapsto ab,\,ba\colon\ \scrA\to\scrA$
are ultraweakly and ultrastrongly continuous
for every element~$a$ of a von Neumann algebra~$\scrA$.
\end{point}
\begin{point}[npuws]{Exercise}%
Show that for a positive linear map $\omega \colon \scrA\to\C$
on a von Neumann algebra~$\scrA$
the following are equivalent
\begin{enumerate}
\item
	$\omega$ is normal;
\item
	$\omega$ is ultraweakly continuous;
\item
	$\omega$ is ultrastrongly continuous.
\end{enumerate}
(Hint: combine~\sref{p-uwcont} and \sref{cp-uscont}.)
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}%
Before we deepen our understanding
of the ultraweak and ultrastrong topologies,
let us quickly prove that every von Neumann algebra
is isomorphic to a von Neumann algebra of operators on a 
Hilbert space (see~\sref{ngns}).
\end{point}
\begin{point}{Proposition}%
Given an np-map~$\omega\colon \scrA \to \C$
on a von Neumann algebra~$\scrA$,
the map $\varrho_\omega\colon \scrA\to\scrB(\scrH_\omega)$
from~\sref{gns} is normal.
\begin{point}{Proof}%
Let~$D$ be a bounded directed subset of~$\Real{\scrA}$.
Given $a\in \scrA$, we have
\begin{alignat*}{3}
	\textstyle
	\left<\,\eta_\omega(a),\, 
	\bigvee_{d\in D}\varrho_\omega(d)
	\,\eta_\omega(a)\,\right>
\ &=\ 
	\textstyle
	\bigvee_{d\in D}\ \left<\,\eta_\omega(a),\, 
	\varrho_\omega(d)
	\,\eta_\omega(a)\,\right>\\
\ &=\
	\textstyle
	\bigvee_{d\in D}\ \omega(a^*d a) \\
\ &=\ 
	\textstyle
	\omega(a^*\,\bigvee D\, a) \\
\ &=\
	\textstyle
	\left<\,\eta_\omega(a),\, 
	\varrho_\omega(\bigvee D)
	\,\eta_\omega(a)\,\right>.
\end{alignat*}
Since~$\{\,\eta_\omega(a)\colon \,a\in\scrA\,\}$
is dense in~$\scrH_\omega$,
we conclude \TODO{} that~$\bigvee_{d\in D} \varrho_\omega(d)
= \varrho_\omega(\bigvee D)$,
and so~$\varrho_\omega$ is normal.\qed
\end{point}
\end{point}
\begin{point}[varrho-Omega-normal]{Exercise}%
Show that the map $\varrho_\Omega$ 
from~\sref{gelfand-naimark-representation}
is normal for every collection~$\Omega$ of np-maps $\scrA\to\C$
on a von Neumann algebra $\scrA$.
\end{point}
\begin{point}[injective-nmiu-iso-on-image]{Lemma}%
Let~$f\colon \scrA\to\scrB$ be an injective nmiu-map
between von Neumann algebras.
Then~$f(\scrA)$ is a von Neumann subalgebra of~$\scrB$,
and~$f$ restricts to a nmiu-isomorphism from~$\scrA$
to~$f(\scrA)$.
\begin{point}{Proof}%
We already know by~\sref{injective-miu-iso-on-image}
that~$f(\scrA)$ is a $C^*$-subalgebra of~$\scrA$,
and that~$f$ restricts to a miu-isomorphism~$f'\colon \scrA\to f(\scrA)$.
The only thing left to show is that~$f(\scrA)$
is a von Neumann subalgebra of~$\scrB$,
because a miu-isomorphism between von Neumann algebras
(being an order isomorphism)
will automatically be a nmiu-isomorphism.
Let~$D$ be a bounded directed subset of~$f(D)$.
Note that~$S:=(f')^{-1}(D)$ is a bounded
directed subset of~$\scrA$,
and so~$\bigvee D\equiv  \bigvee f(\,S\,)
= f(\bigvee S)$, because~$f$ is normal.
Thus~$\bigvee f(D)\in f(\scrA)$,
and so $f(\scrA)$ is a von Neumann subalgebra of~$\scrB$.\qed
\end{point}
\end{point}
\begin{point}[ngns]{Theorem (normal Gelfand--Naimark)}%
Every von Neumann algebra~$\scrA$ is nmiu-isomorphic
to von Neumann algebra of operators on a Hilbert space.
\begin{point}{Proof}%
Recall that an element $a\in \scrA$ is zero iff $\omega(a)=0$
for all np-maps $\omega\colon \scrA\to\C$.
It follows that the collection~$\Omega$
of all np-maps $\scrA\to\C$
obeys the condition of~\sref{proto-gelfand-naimark},
and so the miu-map $\varrho_\Omega\colon \scrA\to\scrB(\scrH_\Omega)$
(from~\sref{gelfand-naimark-representation})
is injective.
Since~$\varrho_\Omega$
is also normal by~\sref{varrho-Omega-normal},
we see by~\sref{injective-nmiu-iso-on-image} that~$\varrho_\Omega$
restricts to a nmiu-isomorphism
from~$\scrA$ to the von Neumann subalgebra~$\varrho_\Omega(\scrA)$
of~$\scrB(\scrH_\Omega)$.\qed
\end{point}
\end{point}
\end{parsec}
\section{Completeness}
\begin{parsec}%
\begin{point}%
	We have just seen (in~\sref{npuws})
	that a \emph{positive} linear functional~$f$
on a von Neumann algebra 
is ultrastrongly continuous iff it is ultraweakly continuous.
In this section, we'll show that the same result holds
for an arbitrary linear functional~$f$.
Note that if~$f$ is ultraweakly continuous,
then~$f$ is automatically ultrastrongly continuous
(because ultrastrong convergence implies ultraweak convergence).
For the other direction,
we'll show that if~$f$ is ultrastrongly continuous,
then~$f$ can be written as a linear combination
$f\equiv f_0+if_1-f_2-if_3$,
of np-maps $f_1,\dotsc,f_4$,
and must therefore be ultraweakly continuous.
We'll need the following tool.
\end{point}
\begin{point}[bstaromega]{Definition}%
Let~$\scrA$ be a von Neumann algebra.
Given an np-map $\omega\colon \scrA\to\C$,
and~$b\in \scrA$,
define~$\Define{b*\omega}\colon \scrA\to \C$ by
$(b*\omega)(a)=\omega(b^*ab)$ for all~$a\in \scrA$.
\end{point}
\begin{point}[bstaromega-basic]{Exercise}%
Let~$\omega\colon \scrA\to \C$ be an np-map on a von Neumann algebra~$\scrA$.
\begin{enumerate}
\item
Show that $b*\omega\colon \scrA\to\C$
is an np-map for all~$b\in \scrA$
(using \TODO{}).
\item
Show that $\left|\omega(a^*bc)\right| 
\,\leq\, \|\omega\|\,\|a\|_\omega\, \|b\|\, \|c\|_\omega$
for all~$a,b,c\in\scrA$.

Deduce that $\| b*\omega - b'*\omega\|
\,\leq\, \|\omega\| \,\|b-b'\|_\omega\, (\|b\|_\omega + \|b'\|_\omega)$
for all~$b,b'\in\scrA$.

\item
Let~$b_1,b_2,\dotsc$  a sequence in~$\scrA$,
which is Cauchy with respect to~$\|\,\cdot\,\|_\omega$.
Show that the sequence~$b_1*\omega,\,b_2*\omega,\,\dotsc$ 
is Cauchy (in the operator norm
on bounded linear functionals $\scrA\to\C$),
and converges to a bounded linear map~$f\colon \scrA\to\C$.
Show that~$f$ is an np-map.
\end{enumerate}
\end{point}
\begin{point}{Exercise}%
Let~$f\colon \scrA\to \C$ be a ultrastrongly continuous linear
functional on a von Neumann algebra~$\scrA$.
Show that there is an np-map
$\omega\colon \scrA\to \C$
and $\delta>0$
with $\left|f(a)\right|\leq 1$
for all~$a\in\scrA$ with $\|a\|_\omega \leq \delta$.

(Keep this in mind when reading the following lemma.)
\end{point}
\begin{point}[normal-functionals-lemma]{Lemma}%
Let~$\omega\colon \scrA\to\C$ be an np-map,
and let~$f\colon \scrA\to \C$ be a linear map.
The following are equivalent.
\begin{enumerate}
\item\label{normal-functionals-lemma-0}
$\left|f(a)\right|\leq B$ for all~$a\in \scrA$
with $\|a\|_\omega\leq \delta$, for some $\delta,B>0$;
\item\label{normal-functionals-lemma-1}
$\left|f(a)\right| \leq B \|a\|_\omega$ for all~$a\in\scrA$,
for some~$B>0$;
\item\label{normal-functionals-lemma-2}
$f(a)=[b,a]_\omega$ for all~$a\in\scrA$, 
for some~$b\in\scrH_\omega$
(where $\scrH_\omega$ is the Hilbert space completion of~$\scrA$
with respect to the inner-product
$[\,\cdot\,,\,\cdot\,]_\omega$).
\item\label{normal-functionals-lemma-3}
$f\equiv f_0+if_1-f_2-if_3$
where $f_0,\dotsc,f_3\colon \scrA\to \C$
are np-maps for which there is~$B>0$
such that~$f_k(a)\leq B \omega(a)$ for all~$a\in\pos{\scrA}$ 
and~$k$. 
\end{enumerate}
\begin{point}{Proof}%
We make a circle.
\begin{point}{%
\ref{normal-functionals-lemma-3}$\Longrightarrow$%
\ref{normal-functionals-lemma-0}}%
For $a\in \scrA$ and~$k$, we have
$\left|f_k(a)\right|^2 \leq
f_k(1)\,f_k(a^*a) \leq f_k(1)B \,\omega(a^*a)$,
giving~$\left|f_k(a)\right| \leq (f_k(1)B)^{\nicefrac{1}{2}} \|a\|_\omega$,
and so~$\left|f(a)\right|\leq \tilde{B} \|a\|_\omega$,
where $\tilde{B} = B^{\nicefrac{1}{2}}\sum_{k=0}^3f_k(1)^{\nicefrac{1}{2}}$.
Hence~$\left|f(a)\right|\leq \tilde{B}$
for all~$a\in\scrA$ with $\|a\|_\omega\leq 1$.
\end{point}
\begin{point}{\ref{normal-functionals-lemma-0}$\Longrightarrow$%
\ref{normal-functionals-lemma-1}}%
Let~$a\in\scrA$, and~$\varepsilon>0$ be given.
Then for~$\tilde{a}:=\delta(\varepsilon+\|a\|_\omega)^{-1}\,a$,
we have $\|\tilde{a}\|_\omega\leq \delta$,
and so~$\left|f(\tilde{a})\right|
\equiv \delta(\varepsilon +\|a\|_\omega)^{-1} \,\left|f(a)\right|
\leq B$,
which entails $\left|f(a)\right|\leq 
B\delta^{-1}(\varepsilon+\|a\|_\omega)$.
Since~$\varepsilon>0$ was arbitrary, we get~$\left|f(a)\right|\leq
B\delta^{-1}\|a\|_\omega$.
\end{point}
\begin{point}{%
\ref{normal-functionals-lemma-1}$\Longrightarrow$%
\ref{normal-functionals-lemma-2}}%
Since~$\left|f(a)\right|\leq B\|a\|_\omega$ for all~$a\in\scrA$,
the map~$f$ can be extended to a bounded linear map 
$\tilde{f}\colon \scrH_\omega\to \C$.
Then by Riesz' representation theorem (\TODO{}),
there is~$b\in \scrH_\omega$ with $\tilde{f}(x)=[b,x]_\omega$
for all~$x\in \scrH_\omega$.  
In particular,
$f(a)=[b,a]_\omega$ for all~$a\in \scrA$.
\end{point}
\begin{point}{\ref{normal-functionals-lemma-2}$\Longrightarrow$%
\ref{normal-functionals-lemma-3}}%
We know that~$f(a)\equiv [b,a]_\omega$ for all~$a\in \scrA$,
for some~$b\in\scrH_\omega$.
Then, by definition of~$\scrH_\omega$,
there is a sequence~$b_1,b_2,\dotsc$ in~$\scrA$
which converges to~$b$ in~$\scrH_\omega$.
Then the maps $[b_n,\,\cdot\,]_\omega\colon \scrA\to \C$
approximate~$f=[b,\,\cdot\,]_\omega$
in the sense that 
$\left|f(a)-[b_n,a]_\omega\right|=\left|[b-b_n,a]_\omega\right|
\leq \|b-b_n\|_\omega \|a\|_\omega
\leq \|b-b_n\|_\omega \|\omega\| \|a\|$
for all~$a\in \scrA$.
In particular, $[b_1,\,\cdot\,]_\omega,\,[b_2,\,\cdot\,]_\omega,\,\dotsc$
converges to~$f$ (in the operator norm).
By ``polarization'' (c.f.~\sref{mult-polarization}),
we have $[b_n,a]_\omega = \sum_{k=0}^3 i^kf_{k,n}(a)$,
where $f_{k,n} := (i^kb_n+1)*\omega$ is an np-map.
Since~$(i^kb_n+1)_n$ is Cauchy with respect to~$\|\,\cdot\|_\omega$,
we see by~\sref{bstaromega-basic} that 
$(f_{k,n})_n$ converges to an np-map $f_k\colon \scrA\to\C$
(with respect to the operator norm).
It follows that~$f=\sum_{k=0}^3 i^k f_k$.

It remains to be shown that there is~$B>0$ with $f_k(a)\leq B\omega(a)$
for all~$k$ and~$a\in\pos{\scrA}$.
Note that since $f_{k,n}(a) \leq \|i^kb_n+1\|_\omega \,\omega(a)
\leq (\|b_n\|_\omega+1) \,\omega(a)$,
for all~$n$, $k$, and~$a\in\pos{\scrA}$,
the number $B:=\lim_n \|b_n\|_\omega +1 $ will do.\qed
\end{point}
\end{point}
\end{point}
\begin{point}[luws]{Corollary}%
For a linear map~$f\colon \scrA\to \C$
on a von Neumann algebra~$\scrA$ the following are equivalent.
\begin{enumerate}
\item
$f$ is ultrastrongly continuous;
\item
$f$ is ultraweakly continuous;
\item
$f\equiv f_0+if_1-f_2-if_3$
for some~np-maps $f_0,\dotsc,f_3\colon \scrA\to\C$;
\item
``$f$ is bounded on some $\|\,\cdot\,\|_\omega$-ball,''
that is,
\begin{equation*}
	\sup\{\ \left|f(a)\right|\colon a\in \scrA\colon 
		\|a\|_\omega\leq \delta\ \}\ <\ \infty
\end{equation*}
for some $\delta>0$ and  np-map $\omega\colon \scrA\to\C$;
\item
$\left|f(a)\right|\leq \|a\|_\omega$
for all~$a\in \scrA$, for some np-map $\omega\colon \scrA\to\C$.
\end{enumerate}
\end{point}
\end{parsec}
%
%	ultrastrong and ultraweak closure of a convex subset
%
\begin{parsec}%
\begin{point}%
We'll show that the ultrastrong and ultraweak closure
of a convex set agree. 
For this we need the following proto-Hahn--Banach separation theorem,
which concerns the following notion of openess.
\end{point}
\begin{point}{Definition}%
A subset~$A$ of a real vector space~$V$ 
is called \Define{radially open}
if for all~$a\in A$ and~$v\in V$
there is $t\in (0,\infty)$
with $a+sv\in A$ for all~$s\in [0,t)$.
\end{point}
\begin{point}{Exercise}%
Let~$V$ be a vector space.
\begin{enumerate}
\item
Show that the radially open subsets of~$V$ form a topology.
\item
Show that with respect to this topology,
scalar multiplication and translations $x\mapsto x+a$
by a fixed vector~$a\in V$ are continuous.
\item
Show that $\{(0,0)\}\cup B_1(-1)\cup B_1(1)\cup B_2(-2)^c\cup B_2(2)^c$
is a radially open subset of~$\R^2$, 
which is not open
in the usual topology.\TODO{picture}

\item
Show that addition on~$\R^2$ is not jointly radially continuous.
\item
Show that nevertheless $\{s\in \R \colon sx+s^\perp y\in A\}$
is open for every radially open~$A\subseteq V$, and $x,y\in V$.
\item
Show that $A+B$ is radially open when~$A,B\subseteq V$ are radially open.

Show that $\{\lambda a\colon a\in A,\lambda>0\}$ is radially open
when~$A$ is radially open.
\end{enumerate}
\end{point}
\begin{point}[hahn-banach]{Theorem}%
For every radially open
convex subset~$K$ of a real vector space~$V$
with~$0\notin K$
there is a linear map $f\colon V\to\R$
with $f(x)>0$ for all~$x\in K$.
\begin{point}{Proof}%
(Based on Theorem~1.1.2 of~\cite{kr}.)

By Zorn's Lemma we may assume without loss of generality that~$K$ is maximal
among radially open convex subsets of~$V$ that do not contain~$0$.

We also assume that~$K$ is non-empty,
because if~$K=\varnothing$, the result is trivial.

We will show in a moment that~$H:=\{x\in V\colon -x,x\notin K\}$
is a linear subspace and~$V/H$ is one-dimensional.
From this we see that there is a linear map $f\colon V\to\R$
with~$\ker(f)=H$.
Since~$f(K)$ is a convex subset which does not contain~$0$
(because $H\cap K=\varnothing$)
we either have $f(K)\subseteq (0,\infty)$
or $f(K)\subseteq(-\infty,0)$.
Thus, by replacing $f$ by $-f$ if necessary,
we see that there is a linear map $f\colon V\to \R$
with $f(x)>0$ for all~$x\in K$.
\begin{point}{$H$ is a linear subspace}%
Note that~$x\in K,\,\lambda>0\implies \lambda x\in K$,
because the subset 
$\{\lambda x\colon x\in K,\lambda\in(0,\infty)\}\supseteq K$
is radially open, convex, doesn't contain~$0$,
and is thus~$K$ itself.
Furthermore,
$x,y\in K\implies x+y\in K$, because
$x+y=2(\frac{1}{2}x + \frac{1}{2}y)$, and~$K$ is convex.

Let~$\overline{K}$ be the set of all~$x\in V$
with $x+y\in K$ for all~$y\in K$.
Then it is not difficult to check that~$\overline{K}$ is a cone:
 $0\in\overline{K}$,
and
$x\in \overline{K},\lambda\geq 0\implies \lambda x\in \overline{K}$, and
$x,y\in\overline{K}\implies x+y\in \overline{K}$.

We claim that~$x\in \overline{K}$ iff $-x\notin K$.
Indeed, if~$x\in\overline{K}$, then $-x\notin K$, because otherwise
$-x\in K$ and so
$0=x+(-x)\in K$, which is absurd.
For the other direction, suppose that $-x\notin K$.
Then $x+y\in K$ for all~$y\in K$,
because
$\{\lambda x+y\colon y\in K,\lambda\geq0\}\supseteq K$
is radially open, convex, doesn't contain~$0$,
and is thus~$K$.

It follows that~$H=\overline{K}\cap -\overline{K}$.
Since~$\overline{K}$ is a cone, $-\overline{K}$ is a cone,
and thus~$H$ is a cone.  But then~$-H=H$ is a cone too,
and thus~$H$ is a linear subspace.
\end{point}
\begin{point}{$V/H$ is one-dimensional}%
Note that~$H\neq V$, because~$K\cap H=\varnothing$
and~$K$ is (assumed to be) non-empty.
So to show that~$V/H$ is one-dimensional,
it suffices to show that
any~$x,y\in V$ 
 are linearly dependent in~$V/H$.
We may assume that~$x\in K$ and~$y\in -K$.
It suffices to find~$s\in [0,1]$ with $0=sx+s^\perp y$.
The trick is to consider the sets
 $S_0 = \{s\in [0,1]\colon sx+s^\perp y \in -K\}$
and~$S_1 = \{s\in [0,1]\colon sx+s^\perp y \in K\}$,
which are open (because~$K$ and~$-K$ are radially open),
non-empty (because $0\in S_0$ and~$1\in S_1$),
and therefore not disjoint
(because~$[0,1]$ is connected).
So there is~$s\in [0,1]$ with $sx+s^\perp y \in H$.\qed
\end{point}
\end{point}
\end{point}
\begin{point}[ultraclosed]{Exercise}%
We will use~\sref{hahn-banach}
to prove that 
an ultrastrongly closed convex subset~$K$ of a 
von Neumann algebra~$\scrA$
is ultraweakly closed as well.

Let us first simplify the problem a bit.
If~$K$ is empty, the result is trivial,
so we may as well assume that $K\neq \varnothing$.
Note that we must show that no net in~$K$ converges ultraweakly
to any element~$a_0\in\scrA$ outside~$K$,
but by considering~$K-a_0$ instead of~$K$,
we see that it suffices to show that
no net in~$K$ converges ultraweakly to~$0$
under the assumption that~$0\notin K$.
To this end we'll find an ultraweakly continuous linear map
$g\colon \scrA\to \C$ and~$\delta>0$ 
with~$\Real{g(k)}\geq \delta$ for all~$k\in K$---if
a net $(k_\alpha)_\alpha$ in~$K$ were to converge ultraweakly to~$0$,
then~$\Real{g(k_\alpha)}$ would converge to~$0$ as well,
which is impossible.
\begin{enumerate}
\item
	Show that 
	there is an np-map~$\omega \colon\scrA\to\C$
	and~$\varepsilon>0$ 
	with $\|k\|_\omega \geq \varepsilon$ for all~$k\in K$.
	(Hint: use that~$K$ is ultrastrongly closed).
\item
	Show that~$B:= \{ b\in \scrA\colon \|b\|_\omega < \varepsilon\}$
	 is convex, radially open, $B\cap K=\varnothing$.

	Show that $B-K$ is convex, radially open, and $0\notin B-K$.
\item
	Use~\sref{hahn-banach} to show that
	 there is an $\R$-linear map $f\colon \scrA\to \R$
	with $f(b)<f(k)$ for all~$b\in B$ and~$k\in K$.
	Show that~$f$
	can be extended to a $\C$-linear map
	$g \colon \scrA\to \C$
	by $g(a)= f(a)-if(ia)$ for all~$a\in\scrA$.
\item
	Show that $\left| f(b)\right| \leq f(k)$ 
	and $\left|g(b)\right|\leq 2f(k)$
	for all~$b\in B$ and $k\in K$.\\
	(Hint: $b\in B\implies -b\in B$.)

	Conclude that~$g$ is ultraweakly continuous
	(using~\sref{luws} and $K\neq \varnothing$).
\item
	It remains to be shown that
	there is $\delta>0$ with $f(k)\equiv \Real{g(k)}\geq \delta$
	for all~$k\in K$.
	Show that there is $b_0\in B$
	with $f(b_0) >0$.
	Conclude that $f(k)\geq f(b_0)>0 $ for all~$k\in K$.
\end{enumerate}
\end{point}

\end{parsec}
\begin{parsec}%
\begin{point}%
One pertinant feature
of von Neumann algebras
is an abundance of projections:
above each effect~$a$ 
there is a least projection~$\ceil{a}$
called the ceiling of~$a$;
for every np-map $\omega\colon \scrA\to \scrB$
between von Neumann algebras
there is a least projection~$p$ with~$\omega(p^\perp)$
called the carrier of~$\omega$;
the directed supremum of projections is again a projection;
the partial order of projections forms a complete lattice;
and each element is the norm limit
of linear combinations of projections.
\end{point}
\begin{point}{Definition}%
An element~$p$ of a $C^*$-algebra
is a \Define{projection}
when~$p^*p=p$.
\end{point}
\begin{point}{Exercise}%
Show that in a $C^*$-algebra:
\begin{enumerate}
\item
$0$ and~$1$ are projections.
\item
A projection~$p$ is an effect,
that is, $p^*=p$
and $0\leq p\leq 1$.
\item
An effect~$a$ is a projection iff $aa^\perp=0$.
\end{enumerate}
\end{point}
\begin{point}[ad-contraposed]{Lemma}%
Let~$a$ be an element of a $C^*$-algebra~$\scrA$
with $\|a\|\leq 1$,
and let~$p$ and~$q$ be projections on~$\scrA$.
Then 
$a^* p a \leq q^\perp$
iff $paq=0$
iff  $aqa^*\leq p^\perp$.
\begin{point}{Proof}%
Suppose that~$a^*pa\leq q^\perp$.
Then we have $q a^*pa q \leq qq^\perp q = 0$
(see \sref{ad-monotone})
and so $paq=0$,
because $\|paq\|^2=\|(paq)^*paq\|=0$
by the $C^*$-identity.
Applying $(\,\cdot\,)^*$,
we get $qa^*p=0$, and so both $qa^* = qa^*p^\perp$
and $aq = p^\perp aq$, giving
us $aqa^* = p^\perp a q a^* p^\perp 
\leq p^\perp$,
where we used that $aqa^*\leq aa^*\leq \|aa^*\|=\|a\|^2\leq 1$.
By a similar reasoning,
we get $aqa^*\leq p^\perp \implies paq=0\implies a^*pa\leq q^\perp$.\qed
\end{point}
\end{point}
\begin{point}{Exercise}%
Let~$a$ be an effect of a $C^*$-algebra~$\scrA$,
and~$p$ be a projection from~$\scrA$.
\begin{point}[projection-above-effect]%
Show that $a\leq p$
iff $p\sqrt{a} = \sqrt{a}$
iff $\sqrt{a}p = \sqrt{a}$
iff $p^\perp\sqrt{a} = 0$
iff $\sqrt{a}p^\perp = 0$
iff $a^2\leq p$
iff $p a  = a$
iff $ a p = a $
iff $p^\perp a  = 0$
iff $ap^\perp = 0$
iff $\sqrt{a}\leq p$.
\end{point}
\begin{point}[projection-below-effect]%
Show that $p\leq a$
iff $p \sqrt{a} = p$
iff $\sqrt{a} p = p$
iff $ p\sqrt{a}^\perp = 0$
iff $\sqrt{a}^\perp p = 0$
iff $p\leq a^2$
iff $ap=p$
iff $pa = p$
iff $pa^\perp =0$
iff $a^\perp p =0$
iff $p\leq \sqrt{a}$.
\end{point}
\end{point}
\begin{point}[projection-below-projection]{Exercise}%
Let~$p$ and~$q$ be projections from a $C^*$-algebra
with~$p\leq q$.\\
Show that~$q-p$ is a projection.
\end{point}
\begin{point}[vna-ceil]{Proposition}%
Above every effect~$b$ of a von Neumann algebra~$\scrA$,
there is a smallest projection, \Define{$\ceil{b}$},
called the \Define{ceiling} of~$b$,
 given by $\ceil{b}=\bigvee_{n=0}^\infty b^{\nicefrac{1}{2^n}}$.
\begin{point}[vna-ceil-commutes]%
Moreover, if $a\in \scrA$ commutes with $b$,
then~$a$ commutes with~$\ceil{b}$.

\TODO{Remark that $\ceil{\,\cdot\,}$ is not continuous in any sense
because $\nicefrac{1}{n}\to 0$
in any topology, while $\ceil{\nicefrac{1}{n}}\equiv1 \to 1\neq  0$.}
\end{point}
\begin{point}{Proof}
Let~$p$ denote the supremum of~$0\leq b\leq b^{\nicefrac{1}{2}}\leq
b^{\nicefrac{1}{4}}\leq\dotsb\leq 1$.
\begin{point}[vna-ceil-point-1]%
To begin,
note that if~$a\in \scrA$
commutes with~$b$,
then~$a$ commutes with~$p$.
Indeed, for such~$a$ we have~$a\sqrt{b}=\sqrt{b}a$
by~\sref{cstar-square-commutes},
and so $a b^{\nicefrac{1}{2^n}} = b^{\nicefrac{1}{2^n}} a$
for each~$n$
by induction.
Thus~$ap=pa$ by~\sref{vna-supremum-commutes}.
\end{point}
\begin{point}%
Let us prove that~$p$ is a projection, c.q.~$p^2=p$. 
Since~$p\leq 1$, we already have $p^2\equiv \sqrt{p}p\sqrt{p}\leq p$
by~\sref{ad-monotone},
and so we only need to show that $p\leq p^2$. We have:
\begin{alignat*}{3}
 p^2 \ &=\  \textstyle \bigvee_m \sqrt{p} \,b^{\nicefrac{1}{2^m}} \,\sqrt{p}
\qquad&&\text{by \sref{ad-normal}} \\
&=\ \textstyle\bigvee_m b^{\nicefrac{1}{2^{m+1}}}\, p\,
b^{\nicefrac{1}{2^{m+1}}} 
\qquad&&\text{by \sref{vna-ceil-point-1} and \sref{cstar-square-commutes}} \\
&=\ \textstyle \bigvee_m \bigvee_n \, 
b^{\nicefrac{1}{2^{m+1}}}\, b^{\nicefrac{1}{2^n}}\,
b^{\nicefrac{1}{2^{m+1}}} \qquad && \text{by \sref{ad-normal}}
\end{alignat*}
Thus $p^2 \geq b^{\nicefrac{1}{2^k}}$
for each~$k$ (taking $n=m=k+1$,)
and so~$p^2 \geq p$.
\end{point}
\begin{point}%
It remains to be shown that~$p$ is the \emph{least} projection
above~$b$.
Let~$q$ be a projection in~$\scrA$ with $b\leq q$;
we must show that~$q\leq p$.
We have $b^{\nicefrac{1}{2}}\leq q$
by~\sref{projection-above-effect},
and so $b^{\nicefrac{1}{2^n}}\leq q$ for each~$n$ by induction.
Hence $p\leq q$.\qed
\end{point}
\end{point}
\end{point}
\begin{point}[vna-floor]{Proposition}%
Below every effect~$b$ of a von Neumann algebra~$\scrA$,
there is greatest projection, \Define{$\floor{b}$},
called the \Define{floor} of~$b$,
given by~$\floor{b} = \bigwedge_{n=0}^\infty b^{2^{n}}$.
\begin{point}%
Moreover, if~$a\in \scrA$ commutes with~$b$,
then~$b$ commutes with~$\floor{b}$.
\end{point}
\begin{point}{Proof}%
Let~$p$ denote the infimum of $1\geq b\geq b^2 \geq b^4 \geq  \dotsb \geq 0$.
\begin{point}[vna-floor-point-1]%
If~$a\in \scrA$ commutes with~$b$,
then~$a$ commutes with~$p$.
Indeed, such~$a$ commutes with~$b^2$ (because
$ab^2 = bab = b^2a$,)
and so~$a$ commutes with~$b^{2^n}$ for each~$n$ by induction.
Thus~$a$ commutes with~$p\equiv\bigwedge_n b^{2^n}$ 
(by a variation on~\sref{vna-supremum-commutes}.)
\end{point}
\begin{point}%
To see that~$p$ is a projection, c.q.~$p^2=p$,
we only need to show that~$p\leq p^2$,
because we get $p^2\equiv \sqrt{p}\,p\,\sqrt{p}\leq p$
from $p\leq 1$ (using~\sref{ad-monotone}.)
Now, since
\begin{alignat*}{3}
p^2 \ &=\ \textstyle \bigwedge_m\  \sqrt{p}\, b^{2^m} \sqrt{p}\qquad
&&\text{by a variation on~\sref{ad-normal}}\\
&=\ \textstyle \bigwedge_m \ b^{2^{m-1}} p\, b^{2^{m-1}}\qquad
&&\text{by~\sref{vna-floor-point-1} and~\sref{cstar-square-commutes}}\\
&=\ \textstyle \bigwedge_m \bigwedge_n \ 
b^{2^{m-1}}\, b^{2^n}\, b^{2^{m-1}}\qquad
&&\text{by~\sref{ad-normal},}
\end{alignat*}
and $p\leq b^{2^{m-1}}\, b^{2^n}\,b^{2^{m-1}}$
for all~$n,m$, we get~$p\leq p^2$.
\end{point}
\begin{point}%
It remains to be shown that~$p$ is the greatest projection above~$b$.
Let~$q$ be a projection in~$\scrA$ with~$q\leq b$
we must show that~$q\leq p$.
Since~$q\leq b$,
we have~$q\leq b^2$ (by~\sref{projection-below-effect}),
and so~$q\leq b^{2^n}$ for each~$n$ by induction.
Thus~$q\leq p\equiv\bigwedge_n b^{2^n}$.
\end{point}
\end{point}
\end{point}
\begin{point}{Exercise}%
Let~$a,b$ be effects of a von Neumann algebra~$\scrA$,
and let~$\lambda\in [0,1]$.
\begin{point}%
Show that $\ceil{a}^\perp = \floor{a^\perp}$
and $\floor{a}^\perp = \ceil{a^\perp}$.
\end{point}
\begin{point}[vna-binary-supremum-projections]%
Show that~$\ceil{\lambda a} = \ceil{a}$
when~$\lambda\neq 0$.
Use this to prove that~$\ceil{\lambda a+\lambda^\perp b}$
is the supremum of~$\ceil{a}$ and~$\ceil{b}$
in the poset of projections of~$\scrA$
when~$\lambda\neq 0$ and~$\lambda\neq 1$.
\end{point}
\begin{point}[vna-floor-square]%
Show that $\floor{a}=\floor{a^2}$.
\end{point}
\end{point}
\begin{point}[vna-directed-supremum-projections]{Lemma}%
The supremum of a directed set~$D$ of projections
from a von Neumann algebra~$\scrA$ is a projection.
\begin{point}{Proof}%
Writing $p=\bigvee D$,
we must show that $p^2=p$.
Note that $dp=d$ for all~$d\in D$
(by~\sref{projection-below-effect} because~$d\leq p$.)
Now, on the one hand, $(d)_{d\in D}$
converges ultraweakly to~$p$.
On the other hand,
$(dp)_{d\in D}$
converges ultraweakly to~$p^2$ by~\sref{vna-supremum-mult}.
Hence~$p=p^2$ by uniqueness of ultraweak limits.
\end{point}
\end{point}
\begin{point}{Exercise}%
Deduce from this result
 that every set~$A$ of projections from~$\scrA$
has a supremum $\Define{\bigcup A}$
and an infimum $\Define{\bigcap A}$
\emph{in the poset of projections from~$\scrA$}.\\
(Hint: use~\sref{vna-binary-supremum-projections},
and the fact that $p\mapsto p^\perp$ 
is an order isomorphism on the poset of projections on~$\scrA$.)
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}[proto-kaplansky]{Proposition}%
Let~$\scrA$ be a von Neumann algebra,
and let~$f\colon \R\to\R$ be a continuous map 
with $f(t)=\mathcal{O}(t)$,
that is,
there are~$n\in \N$ and~$b\in [0,\infty)$
such that $\left|f(t)\right|\leq b\left|t\right|$
for all~$t\in \R$ with~$\left|t\right| \geq n$.

Then~$a\mapsto f(a),\,\sa{\scrA}\to\sa{\scrA}$ is ultrastrongly continuous
(see \TODO{reference to the continuous functional calculus}).
\begin{point}{Proof}%
(An adaptation of Lemma~44.2 from~\cite{conway2000}.)

Let~$S$ denote the set of all continuous $g\colon \R\to\R$
such that $a\mapsto g(a),\,\sa{\scrA}\to\sa{\scrA}$
is ultrastrongly continuous.
We must show that~$f\in S$.

Let us first make some general observations.
The identity map $t\mapsto t$ is in~$S$,
any constant function is in~$S$,
and~$S$ is closed under addition,
and scalar multiplication.
In particular, any affine transformation ($t\mapsto at+b$)
is in~$S$.
Moreover, we have~$g\circ h\in S$ when $g,h\in S$,
and also~$gh\in S$
provided that~$g$ is bounded.
Finally, $S$ is closed with respect to uniform convergence.

Now,
as $f(t)=f(t)\,\smash{\frac{1}{1+t^2}\,+\, f(t)\,\frac{t^2}{1+t^2}}$
 one can see from the remarks above
that it suffices
to show
that~$t\mapsto f(t)\,\smash{\frac{1}{1+t^2}}$ is in~$S$
--- here we use that $t\mapsto f(t) \,\smash{\frac{t}{1+t^2}}$ is bounded.
In other words,
we may assume without loss of generality,
that~$f$ vanishes at infinity, i.e.~$\lim_{t\to \infty}f(t)=0$.

Suppose for the moment
that there is $e\in S$, $e\neq 0$,
which vanishes at infinity.
Let~$a,b\in \R$.
Then $e_{a,b}\colon \R\to\R, t\mapsto e(at+b)$
--- an affine transformation followed by~$e$ ---
is also in~$S$,
vanishes at infinity,
and can be extended to a continuous real-valued
function on the one-point compactification $\R\cup \{ \infty\}$
of~$\R$
(by defining $e_{a,b}(\infty)=0$).
It is easy to see that the $C^*$-subalgebra
of~$C(\R\cup\{\infty\})$
generated by these extended~$e_{a,b}$'s 
separates the points of~$\R\cup\{\infty\}$,
and is thus~$C(\R\cup\{\infty\})$ itself
by Stone--Weierstra\ss' theorem (see~\sref{stone-weierstrass}).
Since~$f$ vanishes at infinity,
$f$ can be extended to an element of $C(\R\cup\{\infty\})$,
 and can thus be obtained
(by taking real parts if necessary)
from the extended $e_{a,b}$'s and real constants 
via uniform limits, addition and (real scalar)
multiplication. 
Since~$S$ contains the $e_{a,b}$'s and constants
and is closed under these operations (acting on bounded functions),
we see that~$f\in S$.

To complete the proof,
we show that such~$e$ indeed exists.
Let $e,s\colon \R\to\R$ 
be given by $e(t)=ts(t)$ and $s(t)=\smash{\frac{1}{1+t^2}}$.
Clearly~$e$ and~$s$
are continuous
and
vanish at infinity.
To see that~$e$ is ultrastrongly continuous,
let $(b_\alpha)_\alpha$ be a net of self-adjoint elements of~$\scrA$
which converges ultrastrongly to $a\in\sa{\scrA}$,
and let~$\omega\colon \scrA\to \C$
be an npu-map. A simple computation yields
\begin{equation*}
e(b_\alpha)-e(a) \ =\ s(b_\alpha)\,(b_\alpha-b)\,s(a)
\,-\, e(b_\alpha)\,(b_\alpha-b)\,e(a).
\end{equation*}
Since $\|s(b_\alpha)\|\leq 1$,
we have $\|s(b_\alpha)(b_\alpha-a)s(a)\|_\omega 
\leq  \,\|(b_\alpha-b)s(a)\|_\omega
\equiv \|b_\alpha-b\|_{s(a)*\omega}$.
\TODO{Add Lemma for $\|ab\|_\omega\leq \|a\|\|b\|_\omega$
and definition of $a*\omega$.}
Since similarly~$\|e(b_\alpha)\|\leq 1$,
we get
\begin{alignat*}{3}
\|e(b_\alpha)-e(a)\|_\omega
\ \leq\ \|b_\alpha-a\|_{s(a)*\omega}\,+\,\|b_\alpha-a\|_{e(a)*\omega}.
\end{alignat*}
Thus~$e(b_\alpha)$ converges ultrastrongly to~$e(a)$,
and so~$e$ is ultrastrongly continuous.\qed
\end{point}
\end{point}

\begin{point}[mult-us-cont]%
\TODO{Prove that~$a\mapsto \left|a\right|$ is ultrastrongly continuous.}
\end{point}
\begin{point}[kaplansky]{Kaplansky Density Theorem}%
Let~$\scrA$ be a $C^*$-subalgebra
of a von Neumann algebra~$\scrB$.
Let~$b$ be an effect of~$\scrA$ which is the ultrastrong limit
of a net in~$\scrA$.
Then~$b$ is the ultrastrong limit of a net of effects from~$\scrA$.
\begin{point}{Proof}%
Let~$(b_\alpha)_\alpha$
be a net in~$\scrA$ which converges ultrastrongly
to~$b$.
Then the effects  $(0\vee b_\alpha)\wedge 1$
of~$\scrA$ 
converge ultrastrongly to~$(0\vee b)\wedge 1 = b$
by~\TODO{}.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}[bh-us-complete]{Proposition}%
The von Neumann algebra~$\scrB(\scrH)$
of bounded operators on a Hilbert space~$\scrH$
is ultrastrongly complete.
\begin{point}{Proof}
Let~$(T_\alpha)_\alpha$ be an ultrastrongly-Cauchy net
in~$\scrB(\scrH)$
(which must be shown to converge ultrastrongly to
some operator~$T$ in~$\scrB(\scrH)$).

Note that given~$x\in \scrH$,
the net~$(T_\alpha x)_\alpha$ in~$\scrH$
is norm Cauchy,
because $\|(T_\alpha-T_\beta) x\|
= \| T_\alpha-T_\beta \|_{\left<x,(\,\cdot\,)x\right>}$
vanishes for sufficiently large~$\alpha,\beta$,
and so we may define~$Tx :=\lim_\alpha T_\alpha x$,
giving a map~$T\colon \scrH\to\scrH$.

It is clear that~$T$ will be linear,
but the question is whether~$T$ is bounded,
and whether in that 
case~$(T_\alpha)_\alpha$ converges ultrastrongly to~$T$.

Suppose towards a contradiction that~$T$ is not bounded.
Then we can find~$x_1,x_2,\dotsc\in\scrH$
with $\|x_n\|^2\leq 2^{-n}$
and $\|Tx_n\|^2\geq 1$ for all~$n$.
Since~$\omega:=\sum_n \left<x_n,(\,\cdot\,)x_n\right>\colon 
\scrB(\scrH)\to\C$
is an np-map by~\TODO{}, 
it follows that~$\|T_\alpha\|_\omega^2\equiv \sum_{n=1}^\infty 
\|T_\alpha x_n\|^2$
converges to some positive number~$R$.
Since any partial sum $\sum_{n=1}^N \|T_\alpha x_n\|^2
\leq \|T_\alpha\|_\omega^2$
converges to~$\sum_{n=1}^N \|T x_n\|^2\geq N$,
we must conclude that~$R\geq N$,
for all natural numbers~$N$,
which is absurd.
Hence~$T$ is bounded.

It remains to be shown that~$(T_\alpha)_\alpha$
converges ultrastrongly to~$T$.
So let $\omega\colon \scrB(\scrH)\to\C$ be an arbitrary
np-map,
being of the form~$\omega\equiv \sum_n\left<x_n,(\,\cdot\,)x_n\right>$
for some $x_1,x_2,\dotsc\in\scrH$ with $\sum_n \|x_n\|^2 <\infty$.
We must show that~$\|T-T_\alpha\|_\omega
\equiv (\sum_n \|(T-T_\alpha)x_n\|^2)^{\nicefrac{1}{2}}$ 
converges to~$0$ as $\alpha\to 0$.

Let~$\varepsilon>0$ be given,
and pick~$\alpha_0$
such that $\|T_\alpha-T_\beta\|_\omega \leq 
\smash{\frac{1}{2\sqrt{2}}}\,\varepsilon$
for all~$\alpha,\beta\geq \alpha_0$
--- this is possible, because~$(T_\alpha)_\alpha$ is ultrastrongly Cauchy.
We claim that $\|T-T_\alpha\|_\omega \leq \varepsilon$
for any~$\alpha\geq \alpha_0$.
Since for such~$\alpha$
the sum
\begin{equation*}
	\sum_{n=1}^\infty \|(T-T_\alpha)x_n\|^2 
	\ = \ 
	\sum_{n=1}^{N-1} \|(T-T_\alpha)x_n\|^2
	\ +\ 
	\sum_{n=N}^\infty
	\|(T-T_\alpha)x_n\|^2
\end{equation*}
converges (to~$\|T-T_\alpha\|_\omega^2$),
we can find~$N$ such that the second term in the bound above
is below~$\frac{1}{2}\varepsilon^2$.
The first term will also be below~$\frac{1}{2}\varepsilon^2$,
because
\begin{equation*}
	\bigl(\sum_{n=1}^{N-1} \|(T - T_\alpha)x_n\|^2\,\bigr)^{\nicefrac{1}{2}}
	\ \leq\ 
\bigl(\,
\sum_{n=1}^{N-1} \|(T-T_{\beta})x_n\|^2
\,\bigr)^{\nicefrac{1}{2}}
\ +\ 
\bigl(\,
\sum_{n=1}^{N-1} \|(T_\beta-T_\alpha)x_n\|^2
\,\bigr)^{\nicefrac{1}{2}}
\end{equation*}
for any~$\beta$,
and in particular for~$\beta$
large enough that the first term on the right-hand side above
is below~$\smash{\frac{1}{2\sqrt{2}}}\,\varepsilon$.
If we choose $\beta\geq \alpha_0$
the second term will be below~$\smash{\frac{1}{2\sqrt{2}}}\,\varepsilon$ too,
and we get $\|T-T_\alpha\|_\omega^2 \leq \frac{1}{2}\varepsilon^2
+ (\smash{\frac{1}{2\sqrt{2}}\,\varepsilon 
+ \frac{1}{2\sqrt{2}}\,\varepsilon})^2
\equiv \varepsilon^2$ 
all in all.

Hence~$\scrB(\scrH)$ is ultrastrongly complete.\qed
\end{point}

\TODO{Add example that the strong operator topology in not complete.}
\end{point}
\begin{point}[bh-bounded-uw-complete]{Proposition}%
The von Neumann algebra~$\scrB(\scrH)$
of bounded operators on a Hilbert space~$\scrH$
is bounded ultraweakly complete.
\begin{point}{Proof}%
Let~$(T_\alpha)_\alpha$ be a norm-bounded ultraweakly-Cauchy net
in~$\scrB(\scrH)$.
We must show that~$(T_\alpha)_\alpha$
converges ultraweakly
to some bounded operator~$T$ on~$\scrH$.

Note that given $x,y\in\scrH$
the net $(\,\left<x,T_\alpha y\right>\,)_\alpha$
is Cauchy
(because $\left<x,(\,\cdot\,)y\right>
\equiv \frac{1}{4}\sum_{k=0}^3 i^k\left<i^kx+y,(\,\cdot\,)(i^kx+y)\right>$
is ultraweakly continuous),
and so we may define $[x,y] = \lim_\alpha \left<x,T_\alpha y\right>$.
The resulting `form'
$[\,\cdot\,,\,\cdot\,]\colon \scrH\times\scrH\to \C$
(see~\sref{chilb-form})
is bounded, 
because~$\left|[x,y]\right| \leq (\sup_\alpha \|T_\alpha\|)\|x\|\|y\|$
for all~$x,y\in\scrH$
and $\sup_\alpha\|T_\alpha\|<\infty$
since $(T_\alpha)_\alpha$
is norm bounded.
By~\sref{chilb-form-representation},
there is a unique bounded operator~$T$
with $\left<x,Ty\right>=[x,y]$
for all~$x,y\in\scrH$.

By definition of~$T$ it is clear 
that~$\lim_\alpha \left<x,(T-T_\alpha)x\right>=0$
for any~$x\in\scrH$,
but it is not yet clear that~$(T_\alpha)_\alpha$ converges ultraweakly to~$T$.
For this we must show that $\lim_\alpha \omega(T-T_\alpha)=0$
for any np-map~$\omega\colon \scrB(\scrH)\to \C$.
By~\sref{bh-np},
we know that such~$\omega$ is of the form
$\omega=\sum_n \left<x_n,(\,\cdot\,)x_n\right>$
for some $x_1,x_2,\dotsc\in\scrH$ with $\sum_n\|x_n\|^2<\infty$.
Now, given~$N$ and~$\alpha$ we easily obtain the 
following bound.
\begin{equation*}
	|\,\omega(T-T_\alpha)| \ \leq\  
	\sum_{n=1}^{N-1} \left|\left<x_n(T-T_\alpha),x_n\right>\right|
\ +\ \bigl(\,\|T\|+\sup_\alpha\|T_\alpha\|\,\bigr)\,\sum_{n=N}^\infty \|x_n\|^2 
\end{equation*}
Since the first term of this bound converges to~$0$ as~$\alpha\to\infty$,
we get, for all~$N$,
\begin{equation*}
	\limsup_\alpha |\,\omega(T-T_\alpha)| \ \leq\ 
	\bigl(\,\|T\|+\sup_\alpha\|T_\alpha\|\,\bigr)\,\sum_{n=N}^\infty \|x_n\|^2.
\end{equation*}
Since the tail $\sum_{n=N}^\infty\|x_n\|^2$
converges to~$0$ as~$N\to \infty$,
$\limsup_\alpha \left|\omega(T-T_\alpha)\right|=0$.
Hence $\omega(T)=\lim_\alpha \omega(T_\alpha)$,
and so~$(T_\alpha)_\alpha$ converges ultraweakly to~$T$.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}[carrier]{Definition}%
Let $f\colon\scrA\to\scrB$
be an np-map between von Neumann algebras.
The \Define{carrier} of~$f$, denoted by~$\Define{\ceil{f}}$,
is the greatest projection~$p$
of~$\scrA$ with~$f(p^\perp)= 0 $.

\TODO{Add proof that such projection exists.}
\end{point}
\begin{point}[carrier-basic]{Exercise}%
Show that $\ceil{\lambda f} = \ceil{f}$ for~$\lambda>0$,
and~$\ceil{f+g} = \ceil{f}\cup \ceil{g}$.
\end{point}
\begin{point}{Definition}%
We call a projection~$p$ of a von Neumann algebra~$\scrA$
\Define{ultracyclic} if~$p=\ceil{\omega}$
for some np-map $\omega\colon \scrA\to\C$.
\end{point}
\begin{point}[ultracyclic-basic]{Exercise}%
Verify the following facts about ultracyclic projections.
\begin{enumerate}
\item
If~$p$ and~$q$ are ultracyclic projections,
so is~$p\cup q$.
\item
If~$p \leq q$ are projections,
and~$q$ is ultracyclic,
then~$p$ is ultracyclic.

\TODO{add definition of $(\,\cdot\,)_\bullet$}
\item
Every projection is a directed supremum
of ultracyclic projections.\\
(Hint: first show that~$1$ is the supremum of all ultracyclic projections.)
\end{enumerate}
\end{point}
\end{parsec}%
\begin{parsec}%
\begin{point}%
Recall that according to our definition (\sref{von-neumann-subalgebra})
a von Neumann subalgebra~$\scrB$ 
of a von Neumann algebra~$\scrA$
is a $C^*$-subalgebra of~$\scrA$
which is closed under suprema
of bounded directed sets of self-adjoint elements.
We will show that such~$\scrB$ is ultrastrongly closed in~$\scrA$.
\end{point}
\begin{point}[sequence-separation-lemma]{Lemma}%
Let~$\scrB$ be a von Neumann subalgebra
of a von Neumann algebra~$\scrA$.
Let~$\omega_0,\omega_1\colon \scrA\to\C$
be npu-maps,
which are separated
by a net $(b_\alpha)_\alpha$
of effects of~$\scrB$ 
in the sense that~$\lim_\alpha \omega_0(b_\alpha)=0$
and $\lim_\alpha \omega_1(b_\alpha^\perp)=0$.
Then~$\omega_0$ and~$\omega_1$ are separated by a 
projection~$q$ of~$\scrB$ 
in the sense that~$\omega_0(q)= 0 = \omega_1(q^\perp)$.
\begin{point}{Proof}%
(Based on Lemma~45.3 and Theorem~45.6 of~\cite{conway2000}.)

Note that it suffices to find an effect~$a$ in~$\scrB$
with $\omega_0(a) = 0 = \omega_1(a^\perp)$,
because then~$\omega_0(\ceil{a}) = 0 = \omega_1(\ceil{a}^\perp)$
and~$\ceil{a}\in\scrB$ by~\TODO{}.

Note that we may find a subsequence~$(b_n)_n$ of~$(b_\alpha)_\alpha$
such that $\omega_0( b_n ) 
\leq n2^{-n}$
and $\omega_1(b_n^\perp)\leq n^{-1}$
for all~$n$.
For~$n < m$, define
\begin{equation*}
\textstyle
a_{nm}\ = \ (1+\sum_{k=n}^m kb_k)^{-1} \,\sum_{k=n}^m kb_k.
\end{equation*}
Since we have seen in~\sref{}
that the map~$d\mapsto (1+d)^{-1}d$ is order preserving
(on~$\pos{\scrB}$),
we have $0\leq a_{nm}\leq \frac{1}{2}$
and we get the formation
\begin{equation*}
\renewcommand{\labelstyle}{\textstyle}
\xymatrix{
a_{12}\ar@{}|-{\leq}[r] & 
a_{13}\ar@{}|-{\leq}[r] & 
a_{14}\ar@{}|-{\leq}[r]  & 
\dotsb & \ar@{}|-{\leq}[r]& a_1 \\
&
a_{23} \ar@{}|-{\leq}[r] \ar@{}[u]|-{\uleq} &
a_{24} \ar@{}|-{\leq}[r]  \ar@{}[u]|-{\uleq} &
\dotsb &\ar@{}|-{\leq}[r]& a_2  \ar@{}[u]|-{\uleq} \\
&
&
a_{34} \ar@{}|-{\leq}[r]  \ar@{}[u]|-{\uleq} & 
\dotsb & \ar@{}|-{\leq}[r] & a_3  \ar@{}[u]|-{\uleq} 
\\
&&&\ddots&&\vdots \ar@{}[u]|-{\uleq}& \\
&&&&&a\ar@{}[u]|-{\uleq}
},
\end{equation*}
where~$a_n:= \bigvee_{m\geq n} a_{nm}$
and~$a := \bigwedge_n a_n$.
We'll prove that~$\omega_0(a)=0=\omega_1(a^\perp)$.
\begin{point}{$\omega_0(a^\perp)=0$}%
Since~$\omega_0(b_n)\leq n2^n$ 
and $a_{nm}\leq \sum_{k=n}^m k b_k$,
we get~$\omega_0(a_{nm})=\sum_{k=n}^m k\omega_0(b_k) \leq 2^{n-1}$,
and so $\omega_0(a)=\bigwedge_n\bigvee_{m\geq n} \omega_0(a_{nm})
\leq \bigwedge_n 2^{n-1} = 0$.
\end{point}
\begin{point}{$\omega_1(a)=0$}%
Let~$m> n$ be given.
Since~$\sum_{k=n}^m b_k \geq mb_k$
and $d\mapsto (1+d)^{-1}d$
is monotone on~$\pos{\scrB}$
we get~$a_{nm} \geq (1+mb_m)^{-1} mb_m$,
and so~$a_{nm}^\perp \leq (1+mb_m)^{-1}$.

Observe that for a real number $t\in[0,1]$,
we have $tt^\perp \geq 0$,
and so $(1+mt)(1+mt^\perp) = 1+m+m^2tt^\perp \geq 1+m$.
This yields the inequality $(1+mt)^{-1}\leq (1+m)^{-1}(1+mt^\perp)$
for real numbers~$t\in[0,1]$.
The corresponding inequality for effects of a $C^*$-algebra
(obtained via Gelfand's representation theorem, \sref{gelfand})
gives us $\omega_1(a_{nm}^\perp)\leq \omega_1((1+mb_m)^{-1})
\leq (1+m)^{-1}(1+m\omega_1(b_m^\perp))\leq \frac{2}{1+m}$,
where we have used that~$\omega_1(b_m^\perp)\leq \frac{1}{m}$.
Hence~$\omega_1(a_n^\perp)=\bigwedge_{m\geq n} \omega_1(a_{nm}^\perp)
\leq \bigwedge_{m\geq n} \frac{2}{1+m}=0$ for all~$n$,
and so~$\omega_1(a^\perp)=\bigvee_1\omega_1(a_n^\perp)=0$.\qed
\end{point}
\end{point}


\end{point}
\begin{point}[kadisons-lemma]{Lemma}%
Let~$\scrB$ be a von Neumann subalgebra
of a von Neumann algebra~$\scrA$.
Let~$p$ be a projection of~$\scrA$,
which is the ultrastrong limit of a net in~$\scrB$.

For all npu-maps $\omega_0,\omega_1\colon \scrA\to\C$
with~$\omega_0(p)=0= \omega_1(p^\perp)$
there is a projection~$q$ of~$\scrB$
with~$\omega_0(q)=0=\omega_1(q^\perp)$.
\begin{point}{Proof}%
Let~$(b_\alpha)_\alpha$ be a net in~$\scrB$
which converges ultrastrongly to~$p$.
We may assume that all~$b_\alpha$
are effects
by Kaplansky's density theorem (\sref{kaplansky}).
% Since~$pp^\perp=0=p^\perp p$
%and multiplication by a fixed element is ultrastrongly 
%continuous (\sref{mult-us-cont}),
%we see that $(b_\alpha p^\perp)_\alpha$ and $(b_\alpha^\perp p)_\alpha$
%converge ultrastrongly to~$0$.
Note that~$(\omega_0(b_\alpha))_\alpha$ converges to~$\omega_0(p)\equiv 0$,
and $(\omega_1(b^\perp_\alpha))_\alpha$ converges 
to~$\omega_1(p^\perp)\equiv 0$.
Now apply~\sref{sequence-separation-lemma}.\qed
\end{point}
\end{point}
\begin{point}[vnsa-usc]{Theorem}%
A von Neumann subalgebra~$\scrB$ of a von Neumann algebra~$\scrA$
is ultrastrongly closed.
\begin{point}{Proof}%
Let~$p$ be a projection of~$\scrA$ which is the ultrastrong limit
of a net from~$\scrB$. It suffices to show that~$p\in\scrB$,
because the ultrastrong closure of~$\scrB$
being a von Neumann algebra (\TODO{add ref.})
is generated by its projections (\TODO{add ref.}).
Note that given an np-map $\omega\colon \scrA\to\C$,
the carrier~$\ceil{\omega}$ of~$\omega$
need not be equal to the carrier
of~$\omega$ restricted to~$\scrB$,
which we'll therefore denote by~$\ceil{\omega}_\scrB$;
but we do have $\ceil{\omega}\leq \ceil{\omega}_\scrB$.
Then by~\sref{ultracyclic-basic}
\begin{equation}
\label{ultracyclic-proof}
\textstyle
\bigvee_{\omega_1}
\ceil{\omega_1}_\scrB \ \geq\ 
\bigvee_{\omega_1}
\ceil{\omega_1}\ =\ p\ =\ 
\bigwedge_{\omega_0} \ceil{\omega_0}^\perp
\ \geq\ \bigwedge_{\omega_0} \ceil{\omega_0}_{\scrB}^\perp,
\end{equation}
where~$\omega_0$ ranges over np-maps $\omega_0\colon \scrA\to\C$
with~$\omega_0(p)=0$,
 and $\omega_1$ ranges over
np-maps $\omega_1\colon \scrA\to\C$ with~$\omega_1(p^\perp)=0$.
Since for such~$\omega_0$ and~$\omega_1$
there is 
by~\sref{kadisons-lemma}
a projection~$q$ in~$\scrB$
with $\omega_0(q)=0=\omega_1(q^\perp)$,
we get 
$\ceil{\omega_1}_\scrB \geq q \geq 
\ceil{\omega_0}_\scrB^\perp$,
and so~$\bigwedge_{\omega_0} \ceil{\omega_0}_\scrB^\perp 
\geq \bigvee_{\omega_1} \ceil{\omega_1}_\scrB$.
It follows that the inequalities in~\eqref{ultracyclic-proof}
are in fact equalities,
and so~$p=\bigvee_{\omega_1}\ceil{\omega_1}_\scrB \in \scrB$.\qed
\end{point}
\end{point}
\begin{point}[vn-complete]{Theorem}%
A von Neumann algebra~$\scrA$ is ultrastrongly complete
and bounded ultraweakly complete.
\begin{point}{Proof}%
Recall that~$\scrA$
is nmiu-isomorphic
to a von Neumann algebra~$\scrR$ of operators on some Hilbert space~$\scrH$
by~\sref{ngns}.
Since~$\scrB(\scrH)$ is ultrastrongly complete
(\sref{bh-us-complete}),
and the ultrastrong topology on~$\scrB(\scrH)$
coincides on~$\scrR$ with the ultrastrong topology of~$\scrR$
(by~\sref{us-permanence}),
and~$\scrR$ is 
 ultrastrongly closed in~$\scrB(\scrH)$
(see~\sref{vnsa-usc} ),
we see that $\scrR$ (and therefore~$\scrA$) is 
ultrastrongly complete.

Since similarly~$\scrB(\scrH)$
is bounded ultraweakly complete (\sref{bh-bounded-uw-complete}),
the ultraweak topology on~$\scrB(\scrH)$
coincides on~$\scrR$ with the ultraweak topology on~$\scrR$
(\sref{uw-permanence}),
and~$\scrR$ is ultraweakly closed 
(= ultrastrongly closed, see~\sref{ultraclosed})
in~$\scrB(\scrH)$,
we see that~$\scrR$ is bounded ultraweakly complete.\qed
\end{point}
\end{point}
\end{parsec}



\TODO{NCPsU-maps with sharp $f(1)$ as restriction category}

\TODO{Central carier and von Neumann--Murray equivalence (for Paschke.)}

%
%
%
\begin{parsec}[floor-sequential-product]%
\begin{point}{Lemma}%
Let~$a,b$ be effects of a von Neumann algebra~$\scrA$.
Then~$\floor{\sqrt{a}b\sqrt{a}}$ is the greatest projection
below~$a$ and~$b$, that is, in symbols, 
$\floor{\sqrt{a}b\sqrt{a}}=\floor{a}\cap \floor{b}$.
\end{point}
\begin{point}{Proof}%
Surely, $\floor{\sqrt{a}b\sqrt{a}}\leq \sqrt{a}b\sqrt{a} \leq a$.
Let us prove that~$\floor{\sqrt{a}b\sqrt{a}}\leq b$.
To this end,
recall
that (by~\sref{projection-below-effect})
a projection~$e$ is below an effect~$c$
iff $ec=e$ iff $e\sqrt{c}=e$.
In particular,
since~$\floor{\sqrt{a}b\sqrt{a}}\leq \sqrt{a}b\sqrt{a}$ and 
$\floor{\sqrt{a}b\sqrt{a}}\leq a$,
we get
\begin{equation*}
\floor{\sqrt{a}b\sqrt{a}}
\ =\ \floor{\sqrt{a}b\sqrt{a}}\sqrt{a}b\sqrt{a}\floor{\sqrt{a}b\sqrt{a}} \ =\ 
\floor{\sqrt{a}b\sqrt{a}}b\floor{\sqrt{a}b\sqrt{a}},
\end{equation*}
and so $\floor{\sqrt{a}b\sqrt{a}}b^\perp\floor{\sqrt{a}b\sqrt{a}}=0$,
which implies that
$\floor{\sqrt{a}b\sqrt{a}}\leq b$ by~\sref{ad-contraposed}.
\begin{point}%
Now,
let~$e$ be a projection below~$a$ and~$b$,
that is, $e\sqrt{a}=e$ and~$eb=e$.
We must show that~$e\leq \floor{\sqrt{a}b\sqrt{a}}$,
or equivalently, $e\leq \sqrt{a}b\sqrt{a}$,
or put yet differently, $e\sqrt{a}b\sqrt{a}=e$.
But this is obvious: $e=e\sqrt{a}=eb\sqrt{a}=e\sqrt{a}b\sqrt{a}$.
\end{point}
\end{point}
\end{parsec}

\begin{parsec}%
\begin{point}%
Having seen that~$\floor{\sqrt{a}b\sqrt{a}} = \floor{a}\cap\floor{b}$
in~\sref{floor-sequential-product}
one might wonder whether
there is a similar expression for $\ceil{\sqrt{a}b\sqrt{a}}$.
If~$a$ and~$b$ are projection,
$\ceil{aba}$ turns out to coincide with the \Define{Sasaki product},
$a\cap (a^\perp \cup b)$,
as we will show below.
\TODO{Reference for the Sasaki product.}
\TODO{Thank Kenta}
\end{point}
\begin{point}[floor-difference]{Lemma}%
Let~$p$ be a projection,
and let~$a$ be an effect of a von Neumann algebra
with $a\leq p$.
We have $p-\ceil{a}=\floor{p-a}$.
\end{point}
\begin{point}{Proof}%
We must show that $p-\ceil{a}$ is the greatest projection below $p-a$.
To begin, $p-\ceil{a}\leq p-a$,
because $a\leq \ceil{a}$.
Further, since~$a\leq p$, we have $\ceil{a}\leq p$,
and so~$p-\ceil{a}$ is a projection
(by~\sref{projection-below-projection}).
\begin{point}%
Let~$q$ be a projection below~$p-a$.
We must show that~$q\leq p-\ceil{a}$.
The trick is to note that~$a\leq p-q$.
Since~$p-q$ is a projection (by~\sref{projection-below-projection}
because $q\leq p-a\leq p$),
we have $\ceil{a}\leq p-q$,
and so $q\leq p-\ceil{a}$.
\begin{point}[ceil-sequential-product]{Lemma}%
For projections $p,q$ from a von Neumann algebra,
$\ceil{pqp}=p\cap (p^\perp \cup q)$.
\end{point}
\end{point}
\end{point}
\begin{point}[ceil-sequential-product-1]{Proof}%
Observe that $(\ p\cap (p^\perp \cup q)\ )^\perp 
= p^\perp \cup(p\cap q^\perp)$.
Since~$p^\perp$ and $p\cap q^\perp$ are disjoint,
we have $p^\perp \cup (p\cap q^\perp) = p^\perp + p\cap q^\perp$,
and so $p\cap (p^\perp \cup q) = p-p\cap q^\perp$.
\begin{point}%
By point~\sref{ceil-sequential-product-1}, 
it suffices to show that~$\ceil{pqp}=p- p\cap q^\perp$,
that is, $p-\ceil{pqp}=p\cap q^\perp$.
Since $p-\ceil{pqp} = \floor{p-pqp}$
by~\sref{floor-difference} and $\floor{pq^\perp p}=p\cap q^\perp$
by~\sref{floor-sequential-product} we are done.
\end{point}
\end{point}
\end{parsec}

%
% About maps between von Neumann algebras
%

\begin{parsec}%
\begin{point}{Proposition}%
For a cp-map~$f\colon \scrA\to\scrB$
 between $C^*$-algebras, and $a,b\in\scrA$, 
\begin{equation*}
f(b^*a)\,f(a^*b)\ \leq\ \|f(a^*a)\|\,f(b^*b).
\end{equation*}
\end{point}%
\begin{point}{Proof}%
\TODO{add}
\end{point}
\end{parsec}
%
%
%
\begin{parsec}%
\begin{point}{Exercise}%
Let~$f\colon \scrA\to\scrB$ be a ncpsu-map
between von Neumann algebras
with~$f(1)\leq 1$,
and let~$a\in \scrA$ be positive.
\begin{point}[cp-kadisons-ineq]%
Show that~$f(a)^2 \leq f(a^2)$.
\end{point}
\begin{point}%
Use this, and~\sref{cstar-sqrt-monotone},
to show that~$f(a^{\nicefrac{1}{2}}) \leq f(a)^{\nicefrac{1}{2}}$.
\end{point}
\begin{point}[cpsu-2nthroot]%
Go on, and show that $f(a^{\nicefrac{1}{2^n}})
\leq f(a)^{\nicefrac{1}{2^n}}$ for each~$n$.
\end{point}
\end{point}
\end{parsec}

%
%
%
\begin{parsec}%
\begin{point}{Proposition}%
Let $f\colon \scrA\to\scrB$ be a ncpsu-map
between von Neumann algebras.
Then $\ceil{f(a)}=\ceil{f(\ceil{a})}$
for every effect~$a$ from~$\scrA$.

\TODO{Use Kadison's inequality instead of complete positivity?}
\end{point}
\begin{point}{Proof}%
Since~$a\leq \ceil{a}$
we have $f(a)\leq f(\ceil{a})$,
and so~$\ceil{f(a)}\leq \ceil{f(\ceil{a})}$.
\begin{point}%
It remains to be shown that $\ceil{f(\ceil{a})}\leq \ceil{f(a)}$,
that is, $f(\ceil{a})\leq \ceil{f(a)}$.
Since  $\ceil{a}=\bigvee_n a^{\nicefrac{1}{2^n}}$ 
(by~\sref{vna-ceil})
and~$f$ is normal,
we have $f(\ceil{a})=\bigvee_n f(a^{\nicefrac{1}{2^n}})$.
Now, since $f(a^{\nicefrac{1}{2^n}})\leq f(a)^{\nicefrac{1}{2^n}}
\leq \ceil{f(a)}$
by~\sref{cpsu-2nthroot} for each~$n$,
we have~$f(\ceil{a})\leq \ceil{f(a)}$.
\end{point}
\end{point}
\end{parsec}
%
%
%
\begin{parsec}%
\begin{point}{Proposition}%
Let~$f\colon \scrA\to\scrB$ be a ncpsu-map
between von Neumann algebras.
Then~$\floor{f(a)}=\floor{f(\floor{a})}$
for every effect~$a$ from~$\scrA$.
\end{point}
\begin{point}{Proof}%
Since~$\floor{a}\leq a$,
we have~$\floor{f(\floor{a})}\leq \floor{f(a)}$.
Thus we only need to show that~$\floor{f(a)}\leq \floor{f(\floor{a})}$,
or equivalently, $\floor{f(a)}\leq f(\floor{a})$.
We have
\begin{equation*}
\floor{f(a)}
\ \stackrel{\sref{vna-floor-square}}{=}\ 
\floor{f(a)^2}
\ \stackrel{\sref{cp-kadisons-ineq}}{\leq}\  
\floor{f(a^2)} \ \leq\ \floor{f(a)},
\end{equation*}
and so~$\floor{f(a)}=\floor{f(a^2)}$.
By induction,
and similar reasoning,
we get~$\floor{f(a)}=\floor{f(a^{2^n})}\leq f(a^{2^n})$
for every~$n$,
and so
$\floor{f(a)}\leq \bigwedge_n f(a^{2^n})
= f(\bigwedge_n a^{2^n})=f(\floor{a})$,
where we used that~$f$ is normal,
and~$\floor{a}=\bigwedge_n a^{2^n}$ (see~\sref{vna-floor}).
\end{point}
\end{parsec}

\begin{parsec}%
\begin{point}%
Parsec about commutative $C^*$-algebras:
\end{point}
\begin{point}[ccstar-proj]{Theorem}%
The projections~$\Proj(\scrA)$ of a commutative $C^*$-algebra~$\scrA$
form a Boolean algebra.
If~$\scrA$ is monotone complete,
then~$\Proj(\scrA)$ is a complete Boolean algebra.
\end{point}
\end{parsec}

\begin{parsec}%
\begin{point}%
Let us now turn to quotients of von Neumann algebras.
Recall that given a norm closed two-sided ideal~$\scrD$
of a $C^*$-algebra $\scrA$
we can form the quotient $\scrA/\scrD$,
(which is again a $C^*$-algebra),
and the quotient map $q\colon \scrA\to \scrA/\scrD$
which is a \textsc{miu}-map.
If~$\scrA$ is a von Neumann algebra,
then~$\scrA/\scrD$ might not be a von Neumann algebra,
either because~$\scrA/\scrD$ is not be monotone complete 
(see~\sref{vn-quotient-not-monotone-complete}),
or because~$\scrA/\scrD$ does not have a separating set of normal states
(see~\TODO{}).
However, if~$\scrD$ is ultraweakly closed,
then~$\scrA/\scrD$ is a von Neumann algebra,
as one might have suspected.
To prove this,
we need the somewhat surprising
fact that every ultraweakly closed
ideal~$\scrD$ is of the form $\scrD\equiv c\scrA$,
where~$c$ is a central projection~$c$ of~$\scrA$.
(The quotient~$\scrA/c\scrA$ is then simply~$c^\perp\scrA$.)
\TODO{connection between uw-closed ideals and central projections}
\TODO{universal property for \textsc{n(c)p(s)(u)}-maps}
\end{point}
\begin{point}[vn-quotient-not-monotone-complete]{Example}%
The quotient of a von Neumann algebra
by an closed ideal
need not be a von Neumann algebra:
we will show that $\ell^\infty/c_0$
is not monotone complete,
where~$\ell^\infty$ is the von Neumann algebra
of bounded sequences,
and~$c_0\subseteq \ell^\infty$
is the norm closed ideal of
sequences which converge to~$0$.
By~\sref{ccstar-proj}
it suffices to show that the Boolean algebra~$\Proj(\ell^\infty/c_0)$
of projections of~$\ell^\infty/c_0$ is not complete.
\begin{point}%
We claim that $\Proj(\ell^\infty/c_0)$
is isomorphic to the Boolean algebra
 $\wp(\N)/\wp_{fin}(\N)$
of subsets of~$\N$ modulo 
the filter~$\wp_{fin}(\N)$ of finite subsets.

It is easy to see that the assignment $A\mapsto [\mathbf{1}_A]_{c_0}$
(where $\mathbf{1}_A$ is the indicator function of~$A$)
gives a Boolean algebra homomorphism 
$f\colon \wp(\N)\to \Proj(\ell^\infty/c_0)$,
that the kernel of~$f$
is $\wp_{fin}(\N)$
(because for $A\subseteq \N$
we have $\mathbf{1}_A\in c_0$ iff $A$ is finite).
It remains to be shown that~$f$ is surjective,
which requires some fiddling.

Let~$\alpha\in \ell^\infty$
be
such that $[\alpha]_{c_0}$ is a projection in $\ell^\infty/c_0$.
We claim that
$\mathbf{1}_A - \alpha \in c_0$ (and so $\alpha=f(A)$)
for some~$A\subseteq \N$.
Note that since $[\alpha]_{c_0}$ is self-adjoint,
we have $[\alpha]_{c_0}=(\,[\alpha]_{c_0}\,)_\R = [\,\alpha_\R\,]_{c_0}$,
and so we may assume without loss of generality
that~$\alpha$ is self-adjoint
(replacing $\alpha$ by $\alpha_\R$ is necessary).
Define $A=\{n\in\N\colon \left|1-\alpha(n)\right|<\frac{1}{2}\}$.

Let~$\varepsilon>0$ with $\varepsilon<\nicefrac{1}{2}$ be given.
We must find~$N\in\N$ with 
$\left| \mathbf{1}_A(n)-\alpha(n)\right|\leq \varepsilon$
for all~$n\geq N$.
Since~$[\alpha]_{c_0}$ is a projection,
$\alpha-\alpha^2\in c_0$,
and so
there is~$N\in \N$
with $\left|\alpha(n)\right| \,\left| 1-\alpha(n)\right|
\,\equiv\, \left| \alpha(n) - \alpha(n)^2 \right| \leq 
\nicefrac{1}{2}\,\varepsilon < \nicefrac{1}{4}$
for all~$n\geq N$.

Let~$n\geq N$ be given.
Note that either 
$\left|1-\alpha(n)\right|\geq \nicefrac{1}{2}$
or 
$\left|\alpha(n)\right|\geq \nicefrac{1}{2}$.
If~$\left|1-\alpha(n)\right|\geq\nicefrac{1}{2}$,
then $\mathbf{1}_A(n)=0$
(by definition of~$A$),
and so $\left|\mathbf{1}_A(n)-\alpha(n)\right|\equiv \left|\alpha(n)\right| 
\leq 2 \,\left|\alpha(n)\right|\,\left| 1-\alpha(n)\right|
\leq \varepsilon$.
On the other hand,
if  $\left|\alpha(n)\right| \geq \nicefrac{1}{2}$,
then $\left|1-\alpha(n)\right| < \nicefrac{1}{2}$
(because otherwise $\left|\alpha(n)\right|\left|1-\alpha(n)\right|
\geq \nicefrac{1}{4}$),
so $\mathbf{1}_A(n)=1$,
and thus
$\left|\mathbf{1}_A(n)-\alpha(n)\right|
\equiv \left|1-\alpha(n)\right|
\leq 2 \left|\alpha(n)\right|\left|1-\alpha(n)\right|
\leq \varepsilon$.

Hence $\mathbf{1}_A - \alpha \in c_0$,
and so~$f$ is surjective.
It follows that $\Proj(\ell^\infty/c_0)$
is isomorphic to $\wp(\N)/\wp_{fin}(\N)$.
\end{point}
\begin{point}%
We claim that the Boolean algebra~$\wp(\N)/\wp_{fin}(\N)$
is not complete.
To see this,
find a partition of~$\N$ into infinite subsets
$A_1,A_2,\dotsc$.
We claim that~$A_1,A_2,\dotsc$ has no supremum in~$\wp(\N)/\wp_{fin}(\N)$
because there is no minimal upper bound.
Indeed,
let~$A$ be an upper bound of~$A_1,A_2,\dotsc$ in~$\wp(\N)/\wp_{fin}(\N)$,
that is, $A_n\backslash A$ is finite for every~$n$;
we will define an upper bound~$A'$ of $A_1,A_2,\dotsc$
which is strictly below~$A$ in~$\wp(\N)/\wp_{fin}(\N)$.
Since~$A_n$ is infinite,
and~$A_n\backslash A$ is finite,
we can pick $a_n\in A_n\cap A$ for each~$n$.
Then~$A':=A \backslash \{a_1,a_2,a_3,\dotsc\}$
is an upper bound for~$A_1,A_2,\dotsc$,
because $A_n\backslash A' = (A_n\backslash A)\cup\{a_n\}$ is finite
for each~$n$,
and~$A'$ is strictly below~$A$ in~$\wp(\N)/\wp_{fin}(\N)$,
because $A'\backslash A$ is infinite.
Hence~$\wp(\N)/\wp_{fin}(\N)$
is not complete.
\end{point}
\begin{point}%
\TODO{connection with $\beta\N\backslash\N$
being non-Stonean.}
\end{point}
\end{point}
\begin{point}{Proposition}%
\label{prop:weakly-closed-ideal}
For every ultraweakly closed two-sided
ideal~$\mathscr{D}$ of a von Neumann algebra~$\scrA$
there is a unique central projection~$c\in\scrA$
such that $\mathscr{D} = c\scrA$.

Moreover, $c$ is the greatest projection in~$\mathscr{D}$.
\begin{point}{Proof}%
\emph{(if $a\in \mathscr{D}\cap [0,1]_{\scrA}$, 
then $\ceil{a}\in\mathscr{D}$)}\ 
Let~$a\in\mathscr{D}$ with $0\leq a \leq 1$
be given.
Recall that $\ceil{a}$
is the ultraweak limit of $a,\ a^{\frac{1}{2}},\ a^{\frac{1}{4}},\ \dotsc$.
Since~$\mathscr{D}$ is a $C^*$-subalgebra of~$\scrA$,
we have $a^{\frac{1}{2}}\in \mathscr{D}$.
Then $(a^{\frac{1}{2}})^{\frac{1}{2}} \equiv a^{\frac{1}{4}}\in \mathscr{D}$
by the same token,
and so on.
Thus, as~$\mathscr{D}$ is ultraweakly closed, $\ceil{a}\in\mathscr{D}$.

\emph{($\mathscr{D}\cap [0,1]_\scrA$ is directed)}\ 
Let~$a,b\in \mathscr{D}\cap[0,1]_\scrA$ be given.
We're looking for an element~$u\in \mathscr{D}\cap[0,1]_\scrA$
with $a\leq u$ and $b\leq u$.
Note that $\frac{1}{2}a + \frac{1}{2}b$
is in~$\mathscr{D}\cap[0,1]_{\scrA}$.
Define
$u:=\ceil{\frac{1}{2}a+\frac{1}{2}b}$.
Then  $u\in \mathscr{D}\cap[0,1]_\scrA$
by the previous point.
Now, 
as $\frac{1}{2}a \leq \frac{1}{2}a+\frac{1}{2}b \leq u$,
we have $a \leq \ceil{a} =\ceil{\frac{1}{2}a} \leq 
\ceil{ \frac{1}{2}a+\frac{1}{2}b} = u$.
Similarly, $b\leq u$.


\emph{($\mathscr{D}\cap [0,1]_\scrA$
has a greatest element, $c$)}\ 
As~$\mathscr{D}\cap[0,1]_\scrA$
is a directed subset of self-adjoint elements 
of~$\scrA$ bounded above by~$1$,
it has a supremum in~$\scrA_\mathrm{sa}$,
say~$c$.
As~$c$ is the ultraweak limit of~$(c)_{c\in \mathscr{D}\cap[0,1]_\scrA}$
and~$\mathscr{D}\cap[0,1]_\scrA$ is ultraweakly closed,
we have~$c\in \mathscr{D}\cap[0,1]_\scrA$.
Thus~$c$ is the greatest element of~$\mathscr{D}\cap[0,1]_\scrA$.

\emph{($c$ is a projection)}\ 
It suffices to show that~$c=\ceil{c}$ since~$\ceil{c}$ is a projection.
Since~$c\leq \ceil{c}$, it suffices to show that~$\ceil{c}\leq c$.
As before,~$c\in \mathscr{D}\cap[0,1]_\scrA$
entails~$\ceil{c}\in\mathscr{D}\cap[0,1]_\scrA$.
Thus~$\ceil{c}\leq c$, since~$c$ is the
greatest element of~$\mathscr{D}\cap[0,1]_\scrA$.
Hence~$c=\ceil{c}$ is a projection.

\emph{(for all $a\in \scrA$
we have: $a\in \mathscr{D}$ iff $ca=a$)}\ 
Since~$c\in \mathscr{D}$,
and~$\mathscr{D}$ is a two-sided ideal,
$ca\in \mathscr{D}$, and so $ca=a$ entails~$a\in\mathscr{D}$.
Thus we only need to show that~$a\in\mathscr{D}$
entails~$ca=a$.
Let~$a\in\mathscr{D}$
be given.
We must show that~$ca=a$.

If~$a\in [0,1]_\scrA$,
then this is clear:
$a\leq c$, since~$c$ is the greatest element
of~$\mathscr{D}\cap [0,1]_\scrA$,
and so~$ca=ac=a$ by Lemma~\ref{lem:projection-order}.

If~$a\in \scrA_{\mathrm{sa}}$
with~$a\neq 0$,
then $a\cdot\|a\|^{-1} \in [0,1]_\scrA\cap \mathscr{D}$,
and so $ca \|a\|^{-1} = a \|a\|^{-1}$,
which entails $ca = a$.

(For arbitrary $a\in \scrA$,)
we have $a= a_{\mathbb{R}} + i a_{\mathbb{I}}$,
where $a_\mathbb{R}=\frac{1}{2}(a+a^*)$
and $a_\mathbb{I} = \frac{1}{2i}(a-a^*)$
are self-adjoint elements of~$\mathscr{D}$.
Then~$ca_\mathbb{R}=a_\mathbb{R}$
and $ca_\mathbb{I}=a_\mathbb{I}$
by the previous paragraph.
Thus~$ca=ca_\mathbb{R}+ica_\mathbb{I}=a_\mathbb{R}+ia_\mathbb{I}=a$.

\emph{($c$ is central)}\ 
Let~$a\in\scrA$ be given.
We must show that~$ca=ac$.
Since~$\mathscr{D}$ is a two-sided ideal,
we have~$ac\in \mathscr{D}$,
and so~$c(ac)=ac$ by the previous point.
By a similar reasoning we get~$(ca)c=ca$.
Thus~$ac=ca$.
Thus~$c$ is central.

\emph{($\mathscr{D} = c\scrA$)}\ 
Clearly $c\scrA\subseteq\mathscr{D}$
since~$c\in\mathscr{D}$ and~$\mathscr{D}$ is an ideal.
On the other hand,
if~$a\in\mathscr{D}$,
then~$ca=a$
(as we saw),
and thus~$a\in c\scrA$.
Hence~$\mathscr{D} = c\scrA$.

\emph{(uniqueness)}\ 
Let~$c_1$ and~$c_2$ be central projections 
with~$c_1\scrA = \mathscr{D}=c_2\scrA$.
We must show that~$c_1=c_2$.

As~$c_2\in\mathscr{D}=c_1 \scrA$,
there is~$a_1\in \scrA$
with~$c_2 = c_1a_1$.
Then~$c_2 = c_2c_2^* = c_1a_1a_1^*c_1^*\leq 
c_1c_1^*\|a_1a_1^*\|=c_1\|a_1\|^2$.
Thus~$c_1c_2=c_2c_1=c_2$ by Lemma~\ref{lem:projection-order}.

Similarly, $c_2c_1 = c_1c_2 = c_1$, and so $c_1=c_1c_2=c_2$.

\emph{($c$ is the greatest projection of~$\mathscr{D}$)}\ 
Let~$p$ be a projection in~$\mathscr{D}$.
We must show that~$p\leq c$.
Since~$p$ is a projection,
we have $0\leq p\leq 1$, and so $p\in \mathscr{D}\cap [0,1]_\scrA$.
Thus, $p\leq c$, by definition of~$c$.
\end{point}
\end{point}
\end{parsec}
\end{document}

