\documentclass[a]{subfiles}
\begin{document}
\chapter{Von Neumann Algebras}
%
% von Neumann algebras
%
\section{Definition and counterexamples}
\begin{parsec}[vna]%
\begin{point}{Definition}%
A $C^*$-algebra~$\scrA$
is a \Define{von Neumann algebra}
when
\begin{enumerate}
\item
every bounded directed subset~$D$
of self-adjoint elements of~$\scrA$ (so $D\subseteq \sa{\scrA}$) 
has a supremum $\bigvee D$ in $\sa{\scrA}$, and
\item
if $a$ is a positive element of~$\scrA$
with $\omega(a)=0$ for every \emph{normal} (see below) positive 
linear map $\omega\colon \scrA\to \C$,
then~$a=0$.
\end{enumerate}
\begin{point}%
A positive linear map $\omega\colon \scrA\to \C$
is called \Define{normal}
if $\omega(\bigvee D) = \bigvee_{d\in D} \omega(d)$
for every bounded directed subset of self-adjoint elements of~$D$
which has a supremum $\bigvee D$ in $\sa{\scrA}$.
\end{point}%
\begin{point}%
The \Define{ultraweak topology} on $\scrA$
is the least topology on~$\scrA$
that makes all normal positive linear maps $\omega\colon \scrA\to \C$
continuous.
The \Define{ultrastrong topology} on~$\scrA$
is the least topology on~$\scrA$
that makes $a\mapsto \omega(a^*a)$ continuous
for every np-map~$\omega\colon \scrA\to \C$.
\end{point}
\end{point}
\begin{point}%
We work with the ultraweak and ultrastrong topology in tandem,
because neither is ideal, and they tend to be complementary:
for example, $a\mapsto a^*$ is ultraweakly continuous
but not ultrastrongly (see~\TODO{}), 
while $a\mapsto \left|a\right|$
is ultrastrongly continuous (see~\TODO{}) but not ultraweakly
(\TODO{}).

When dealing with the ultrastrong topology
it is useful to recall that
every np-map gives rise
to an inner-product $[a,b]_\omega = \omega(a^*b)$
and semi-norm $\|a\|_\omega = \|[a,a]_\omega\|^{\nicefrac{1}{2}}
= \omega(a^*a)^{\nicefrac{1}{2}}$.
\TODO{finish}
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}[von-neumann-subalgebra]{Example}%
A $C^*$-subalgebra~$\scrB$
of a von Neumann algebra~$\scrA$
is called a \Define{von Neumann subalgebra}
(and is itself a von Neumann algebra)
if for every bounded directed subset~$D$
of self-adjoint elements from~$\scrB$
we have $\bigvee D\in\scrB$
(where the supremum is taken in~$\sa{\scrA}$).
\end{point}

\TODO{add more examples}
\end{parsec}
\begin{parsec}%
\begin{point}{Exercise}%
We start with some counterexamples in $\scrB(\ell^2)$
to sharpen your understanding of the ultrastrong and ultraweak topologies,
and so that you may better appreciate
the strange maneuvers we'll need to pull off later on.
\begin{enumerate}
\item
Given~$n,m\in \N$,
we denote by $\ketbra{n}{m}$
the bounded operator on~$\ell^2$
given by $(\ketbra{n}{m})(f)(n)=f(m)$
and~$(\ketbra{n}{m})(f)(k)=0$ for $k\neq n$
and $f\in \ell^2$.

Verify the following computation rules,
where $k,\ell,m,n\in \N$.
\begin{equation*}
(\ketbra{n}{m})^*\ =\ \ketbra{m}{n},
\qquad
\ketbra{n}{m}\ketbra{\ell}{k}\ =\ 
\begin{cases}
\ \ \ketbra{n}{k} & \text{if $m=k$} \\
\ \ 0 & \text{otherwise}
\end{cases}
\end{equation*}
\item
Show that $\bigvee_N \sum_{n=0}^N \ketbra{n}{n}=1$.

Conclude that~$(\,\ketbra{n}{n}\,)_n$
converges ultrastrongly (and ultraweakly) to~$0$.

Thus ultrastrong (and ultraweak) convergence does not imply norm convergence,
as one might have expected.
But we also see that if a sequence~$(b_n)_n$ converges ultrastrongly
(or ultraweakly) to some~$b$,
then $(\|b_n\|)_n$ doesn't even have to converge to~$\|b\|$
(compare this with Lebesgue's dominated convergence
theorem \TODO{add ref.}).

(Note that~$(\ketbra{n}{n})_n$ resembles a moving bump, from measure theory.)
\item
Note that when a net $(a_\alpha)_\alpha$
(in, say, $\scrB(\ell_2)$)
converges ultrastrongly to~$a$,
then $(\,a_\alpha^*a_\alpha\,)_\alpha$
is norm-bounded and
converges ultraweakly to~$a^*a$.

The converse does not hold:
show that (already in~$\C$)
$e^{in}$
does not converge ultraweakly 
(nor ultrastrongly) as $n\to \infty$,
while $1\equiv e^{-in} e^{in}$
is norm-bounded and
converges ultraweakly to~$1$ as~$n\to\infty$.
\item
Show that~$(\,\ketbra{0}{n}\,)_n$ converges ultrastrongly 
(and ultraweakly) to~$0$.

Deduce that $(\,\ketbra{n}{0}\,)_n$ converges ultraweakly to~$0$,
but doesn't converge ultrastrongly at all.

Conclude that~$a\mapsto a^*$ is not ultrastrongly continuous 
on~$\scrB(\ell^2)$.

(This has the annoying side-effect,
that it is not immediately clear that the ultrastrong
closure of a $C^*$-subalgebra of a von Neumann algebra
ultrastrongly closed; we'll deal with this in~\sref{ultraclosed}.)
\item
Show that the unit ball~$(\,\scrB(\ell^2)\,)_1$
of~$\scrB(\ell^2)$ is not ultrastrongly compact
by proving that $(\,\ketbra{0}{n}\,)_n$
has no ultrastrongly-convergent subnet.

(But we'll see in~\sref{vn-ball-compact} that
the unit ball of a von Neumann algebra
is ultraweakly compact.)

\item
Show that $\ketbra{n}{0}+\ketbra{0}{n}$
converges ultraweakly to~$0$ as $n\to \infty$,
while $(\ketbra{n}{0}+\ketbra{0}{n})^2\equiv \ketbra{0}{0}+\ketbra{n}{n}$
converges ultraweakly to~$\ketbra{0}{0}$.

Conclude that~$a\mapsto a^2$ is not ultraweakly continuous on~$\scrB(\ell^2)$.

Conclude that $a,b\mapsto ab$ is not jointly ultraweakly continuous
on~$\scrB(\ell^2)$.

Prove that~$\left|\, \ketbra{n}{0}+\ketbra{0}{n}\,\right|
= \ketbra{0}{0}+\ketbra{n}{n}$.

Conclude that~$a\mapsto \left|a\right|$
is not ultraweakly continuous on~$\sa{(\scrB(\ell^2))}$.

(We'll see in~\sref{proto-kaplansky} that $a\mapsto \left|a\right|$
is ultrastrongly continuous on self-adjoint elements.)

\item
Let us consider the two extensions of~$\left|\,\cdot\,\right|$
to arbitrary elements, namely
$a\mapsto \sqrt{a^*a}=:\Define{\left|a\right|_s}$ and 
$a\mapsto \sqrt{aa^*}=:\Define{\left|a\right|_r}$.

Prove that $\ketbra{0}{0} + \ketbra{0}{n}$
converges ultrastrongly to~$\ketbra{0}{0}$ as $n\to \infty$.

Show that $\left|\,\ketbra{0}{0}+\ketbra{0}{n}\,\right|_s
= \ketbra{0}{0}
+\ketbra{0}{n}
+\ketbra{n}{0}
+\ketbra{n}{n}$
converges ultraweakly to~$\left|\,\ketbra{0}{0}\,\right|_s
\equiv \ketbra{0}{0}$
as $n\to \infty$,
but not ultrastrongly.

Show that $\left|\,\ketbra{0}{0}+\ketbra{0}{n}\,\right|_r
= \sqrt{2} \ketbra{0}{0}$.

Conclude that $\left|\,\cdot\,\right|_s$
and $\left|\,\cdot\,\right|_r$
are not ultrastrongly continuous on~$\scrB(\ell^2)$.

(However, we'll see in~\TODO{}
that if a net $(b_\alpha)_\alpha$
in a von Neumann algebra
converges ultrastrongly, to say~$b$,
and $(b_\alpha^*)_\alpha$
converges ultrastrongly too,
then $(\,\left|b_\alpha\right|_s\,)_\alpha$
converges ultrastrongly to~$\left|b\right|_s$.)

\item
Show that $1+\ketbra{n}{0}+\ketbra{0}{n}$
are positive,
and 
converge ultraweakly to~$1$,
while their squares
$1+\ketbra{n}{n}+\ketbra{0}{0}+2\ketbra{n}{0}+2\ketbra{0}{n}$
converge ultraweakly to $1+\ketbra{0}{0}$
(as $n\to\infty$).

Hence~$a\mapsto a^2$
and $a\mapsto \sqrt{a}$
are not ultraweakly continuous on $\pos{\scrB(\ell^2)}$.

\item
For the next counterexample,
we need a growing moving bump,
which still converges ultraweakly.
Sequences won't work here:

Show that $n\ketbra{n}{n}$ does not converge ultraweakly as~$n\to\infty$.

Show that $n \ketbra{f(n)}{f(n)}$ does not converge ultraweakly
as $n\to\infty$
for every strictly monotone map~$f\colon \N\to\N$.

So we'll resort to a net.
Let~$D$ be the directed set which consists of pairs $(n,f)$,
where $n\in \N\backslash\{0\}$ and $f\colon \N\to\N$
is monotone, ordered by $(n,f)\leq (m,g)$ iff $n\leq m$ and $f\leq g$.

Show that the net $(\, n\ketbra{f(n)}{f(n)}\,)_{n,f\in D}$
converges ultrastrongly to~$0$.

So a net which converges ultrastrongly need not be bounded!
(The cure for this pathology is Kaplansky's density theorem, 
see~\TODO{kaplansky})

Show that $\frac{1}{n} \ketbra{f(n)}{0}$
converges ultrastrongly to~$0$ as $D\ni(n,f)\to \infty$.

Show that the product
$\ketbra{f(n)}{0} = (\,n\ketbra{f(n)}{f(n)}\,)\,(\,\frac{1}{n}
\ketbra{f(n)}{0}\,)$
does not converge ultrastrongly 
as $D\ni(n,f)\to\infty$.

Conclude that multiplication $a,b\mapsto ab$
is not jointly ultrastrongly continuous on~$\scrB(\ell^2)$,
even when~$b$ is restricted to a bounded set.

(Nevertheless we'll see that multiplication is ultrastrongly continuous
when~$a$ is restricted to a bounded set,
and that multiplication is ultrastrongly continuous
separately in both arguments.)

\item
Show that
$a_{n,f} = \frac{1}{n}(\ketbra{f(n)}{0}+\ketbra{0}{f(n)})
\,+\, n\ketbra{f(n)}{f(n)}$
converges ultrastrongly to~$0$
as $D\ni(n,f)\to\infty$,
while $a_{n,f}^2$ does not.

Hence~$a\mapsto a^2$ is not ultrastrongly continuous on~$\sa{\scrB(\ell^2)}$.

\item
Let us show that~$\scrB(\ell^2)$
is not ultraweakly complete.

Show that there is an unbounded linear map~$f\colon \ell^2\to\C$,
and that for each finite dimensional linear subspace~$S$ of~$\ell^2$,
there is a unique vector~$x_S\in S$ 
with
$f(x)=\left<x_S,y\right>$ for all~$y\in S$
(using~\sref{riesz-representation-theorem}).

Consider the net~$(\,\ketbra{e}{x_S}\,)_S$
where~$S$ ranges over the finite dimensional subspaces of~$\ell^2$
ordered by inclusion,
and~$e$ is some fixed vector in~$\ell^2$ with~$\|e\|=1$.

Let~$\omega\colon \scrB(\ell^2)\to\C$
be an np-map,
so $\omega\equiv \sum_n \left<y_n,(\,\cdot\,)y_n\right>$
for $y_1,y_2,\dotsc \in \ell^2$ with $\sum_n \|y_n\|^2 <\infty$,
see~\sref{bh-np}.

Show that $\omega(\,\ketbra{e}{x_S}-\ketbra{e}{x_T}\,)
= \left<\,x_S-x_T,\,\sum_n y_n\left<y_n,e\right>\,\right> = 0$
when $S$ and~$T$ are finite dimensional linear subspaces of~$\ell_2$
which contain the vector $\sum_n y_n\left<y_n,e\right>$.

Conclude that~$(\,\ketbra{e}{x_S}\,)_S$
is ultraweakly Cauchy.

Show that if~$(\,\ketbra{e}{x_S}\,)_S$
converges ultraweakly to some~$A$ in~$\scrB(\ell^2)$,
then we have~$\left<e,Ay\right>=f(y)$
for all~$y\in\ell^2$.

Conclude that~$(\,\ketbra{e}{x_S}\,)_S$
does not converge ultraweakly,
and that~$\scrB(\ell^2)$ is not ultraweakly complete.

(Nevertheless, we'll see that every von Neumann algebra
is ultrastrongly complete, and that
every norm-bounded ultraweakly-Cauchy net
in a von Neumann converges, in~\sref{vn-complete}.)
\end{enumerate}
\end{point}
\end{parsec}
\section{The basics}
\begin{parsec}%
\begin{point}[vn-positive-basic]{Exercise}%
Let~$\scrA$ be a von Neumann algebra,
and let~$\Omega$ be the set of np-maps $\scrA\to\C$.
\begin{enumerate}
\item 
Show that~$\Omega$ is order separating (using~\TODO{...}).

Conclude that~$a\in \scrA$ is positive iff~$\omega(a)\geq 0$
for all~$\omega\in\Omega$.
\item
Deduce that~$\scrA_+$ and~$\sa{\scrA}$ are ultraweakly closed.
\end{enumerate}
\end{point}
\end{parsec}

%
% multiplication turns suprema into ultraweak limits
%
\begin{parsec}%
\begin{point}%
It is clear that translation and scaling
on a von Neumann algebra
are ultraweakly (and ultrastrongly) continuous.
We will see in this paragraph that multiplication
is also ultraweakly (and ultrastrongly) continuous
in each coordinate.
Quite surprisingly,
the problem reduces to the ultraweak continuity
of $b\mapsto a^*ba$ by the following identity
(cf.~\TODO{refer to polarization identity}).
\end{point}
\begin{point}[mult-polarization]{Exercise}%
Show that for elements~$a,b,c$ of a $C^*$-algebra,
\begin{equation*}
\textstyle
a^*\,c\,b\ =\ \frac{1}{4}\,\sum_{k=0}^3\ i^k\  (i^ka+b)^*\,c\,(i^ka+b).
\end{equation*}
\end{point}
\begin{point}[vanishing-effects]{Lemma}%
Let~$(x_\alpha)_{\alpha\in D}$ be 
a net of effects of a von Neumann algebra~$\scrA$,
which converges ultraweakly to~$0$.
Let~$(b_\alpha)_{\alpha\in D}$ be a 
net of elements with~$\|b_\alpha\| \leq 1$ for all~$\alpha$.
Then $(x_\alpha b_\alpha)_\alpha$ converges ultraweakly
to~$0$.
\begin{point}{Proof}%
Let~$\omega\colon \scrA\to \C$ be an np-map.
We have, for each~$\alpha$,
\begin{alignat*}{3}
\left|\,\omega(x_\alpha b_\alpha)\,\right|^2
\ &=\ 
\left|\, \omega(\,\sqrt{x_\alpha}\,\sqrt{x_\alpha}\,b_\alpha\,)\, \right|^2
\qquad&&\text{since $x_\alpha\geq 0$}\\
\ &\leq\ 
\omega(x_\alpha)\  \omega(\,b_\alpha^* x_\alpha b_\alpha\,) 
\qquad&&\text{by \sref{cstar-cs}}\\
\ &\leq\ 
\omega(x_\alpha)\ \omega(b_\alpha^* b_\alpha)
\qquad&&\text{since $x_\alpha\leq 1$}\\
\ &\leq\ 
\omega(x_\alpha)\ \omega(1)
\qquad&&\text{since $b_\alpha^*b_\alpha\leq 1$ by \TODO{}}.
\end{alignat*}
Thus,
since $(\omega(x_\alpha))_\alpha$
converges to~$0$,
we see that $(\omega(x_\alpha b_\alpha))_\alpha$
converges to~$0$,
and so $(x_\alpha b_\alpha)_\alpha$ converges ultraweakly to~$0$.\qed
\end{point}
\end{point}
\begin{point}{Exercise}%
Let~$D$ be a bounded directed set of self-adjoint
elements of a von Neumann algebra~$\scrA$,
and let~$a\in \scrA$.
\begin{point}[vna-supremum-uwlimit]%
Show that the net~$(d)_{d\in D}$ converges ultraweakly to~$\bigvee D$.
\end{point}
\begin{point}[vna-supremum-mult]%
Use~\sref{vanishing-effects}
to show that $(da)_d$ converges ultraweakly to~$(\bigvee D)a$,
and that~$(a^*d)_d$ converges ultraweakly to~$a^* (\bigvee D)$.
\end{point}
\begin{point}[vna-supremum-commutes]%
Show that if~$ad=da$ for all~$d\in D$,
then $a(\bigvee D) = (\bigvee D)a $.
\end{point}
\begin{point}[vna-supremum-uslimit]%
Use~\sref{vanishing-effects}
to show that $(\bigvee D-d)^2$ converges ultraweakly to~$0$.

Conclude that~$(d)_{d\in D}$ converges ultrastrongly to~$\bigvee D$.
\end{point}
\end{point}
%
%  ad is normal
%
\begin{point}[ad-normal]{Proposition}%
Let~$a$ be an element of a von Neumann algebra~$\scrA$.
Then~$\bigvee_{d\in D} a^*\,d\,a = a^*\,(\bigvee D)\, a$
for every bounded directed subset~$D$ of self-adjoint
elements of~$\scrA$.
\begin{point}[ad-normal-1]{Proof}%
If~$a$ is invertible,
then the (by~\sref{ad-monotone}) order preserving map $b\mapsto a^*ba$
has an order preserving inverse (namely $b\mapsto (a^{-1})^* b a^{-1}$),
and therefor preserves all suprema.
\begin{point}%
The general case reduces to the case that~$a$ 
is invertible
in the following way.
There is (by~\sref{spectrum-bounded})
 $\lambda>0$ such that $\lambda+a$ is invertible.
Then as $d$ increases 
\begin{equation*}
a^*\,d\,a \ \equiv\  (\lambda+a)^*\,d\,(\lambda+a) \,-\,
 \lambda^2d \,-\, \lambda a^*d \,-\, \lambda da
\end{equation*}
converges ultraweakly
to~$a^* \,(\bigvee D)\,a$,
because $(\ (\lambda+a)^*\,d\,(\lambda+a)\ )_d$
converges ultraweakly to $(\lambda+a)^*\,(\bigvee D)\,(\lambda+a)$
by~\sref{ad-normal-1} and~\sref{vna-supremum-uwlimit},
and $(a^*d+da)_d$ converges ultraweakly to $a^*(\bigvee D)+(\bigvee D)a$
by~\sref{vna-supremum-mult}.
Since~$(a^*da)_d$ converges to~$\bigvee_{d\in D} a^*d a$ too,
we conclude that~$\bigvee_{d\in D} a^* \,d\, a = a^*\,(\bigvee D)\,a$.\qed
\end{point}
\end{point}
\end{point}
\begin{point}[p-uwcont]{Exercise}%
Show that for a positive linear map $f\colon \scrA\to\scrB$
between von Neumann algebras,
the following are equivalent.
\begin{enumerate}
\item
$f$ is ultraweakly continuous;
\item
$f$ is ultraweakly continuous on~$[0,1]_\scrA$;
\item
$f(\bigvee D)=\bigvee_{d\in D}f(d)$ for each bounded 
directed~$D\subseteq\sa{\scrA}$;
\item 
$\omega\circ f\colon \scrA\to\C$ is normal 
for each np-map $\omega\colon \scrB\to\C$.
\end{enumerate}
In that case we say that~$f$ is \Define{\textbf{n}ormal}.

Conclude that $b\mapsto a^*ba,\,\scrA\to\scrA$
is ultraweakly
continuous for every element~$a$ of a von Neumann 
algebra~$\scrA$.

Show that if a positive linear map $f\colon \scrA\to\scrB$
between von Neumann algebras 
is ultrastrongly continuous, then~$f$ is normal.
(Hint: use that a bounded directed set 
$D\subseteq \sa{\scrA}$ converges ultrastrongly to~$\bigvee D$.)

The converse does not hold: give an example of a map~$f$ 
which is normal, but 
not be ultrastrongly continuous. (Hint: transpose.)
\end{point}
\begin{point}[cp-uscont]{Proposition}%
An ncp-map $f\colon \scrA\to\scrB$
between von Neumann algebras is 
ultrastrongly continuous.
\begin{point}{Proof}%
To show that~$f$
is ultrastrongly continuous,
it suffices to show that~$f$ is ultrastrongly continuous at~$0$.
So let~$(b_\alpha)_\alpha$ be a net in~$\scrA$
which converges ultrastrongly to~$0$;
we must show that $(f(b_\alpha))_\alpha$
converges ultrastrongly to~$0$, c.q.~that
$(\,f(b_\alpha)^*f(b_\alpha)\,)_\alpha$ converges ultraweakly to~$0$.
Since
$f(b_\alpha)^*f(b_\alpha) \leq f(b_\alpha^*b_\alpha) \|f(1)\|$
by~\sref{cp-cs}, 
it suffices to show that~$(\,f(b_\alpha^*b_\alpha)\,)_\alpha$
converges ultraweakly to~$0$,
but this follows from the
fact that~$f$ is ultraweakly continuous,
and~$(b_\alpha^*b_\alpha)_\alpha$
converges ultraweakly to~$0$
(since~$(b_\alpha)_\alpha$ converges ultrastrongly to~$0$).\qed
\end{point}
\end{point}
\begin{point}[mult-uws-cont]{Exercise}%
Let~$\scrA$ be a von Neumann algebra.
Conclude (using~\sref{cp-uscont} and~\sref{ad-cp})
that the map $a\mapsto b^*ab,\,\scrA\to\scrA$
is ultrastrongly continuous for every
 element~$b\in\scrA$.

Use this,
and~\sref{mult-polarization},
to
show that $b\mapsto ab,\,ba\colon\ \scrA\to\scrA$
are ultraweakly and ultrastrongly continuous
for every element~$a$ of a von Neumann algebra~$\scrA$.
\end{point}
\begin{point}[npuws]{Exercise}%
Show that for a positive linear map $\omega \colon \scrA\to\C$
on a von Neumann algebra~$\scrA$
the following are equivalent
\begin{enumerate}
\item
	$\omega$ is normal;
\item
	$\omega$ is ultraweakly continuous;
\item
	$\omega$ is ultrastrongly continuous.
\end{enumerate}
(Hint: combine~\sref{p-uwcont} and \sref{cp-uscont}.)
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}%
Before we deepen our understanding
of the ultraweak and ultrastrong topologies,
let us quickly prove that every von Neumann algebra
is isomorphic to a von Neumann algebra of operators on a 
Hilbert space (see~\sref{ngns}).
\end{point}
\begin{point}{Proposition}%
Given an np-map~$\omega\colon \scrA \to \C$
on a von Neumann algebra~$\scrA$,
the map $\varrho_\omega\colon \scrA\to\scrB(\scrH_\omega)$
from~\sref{gns} is normal.
\begin{point}{Proof}%
Let~$D$ be a bounded directed subset of~$\Real{\scrA}$.
Given $a\in \scrA$, we have
\begin{alignat*}{3}
	\textstyle
	\left<\,\eta_\omega(a),\, 
	\bigvee_{d\in D}\varrho_\omega(d)
	\,\eta_\omega(a)\,\right>
\ &=\ 
	\textstyle
	\bigvee_{d\in D}\ \left<\,\eta_\omega(a),\, 
	\varrho_\omega(d)
	\,\eta_\omega(a)\,\right>\\
\ &=\
	\textstyle
	\bigvee_{d\in D}\ \omega(a^*d a) \\
\ &=\ 
	\textstyle
	\omega(a^*\,\bigvee D\, a) \\
\ &=\
	\textstyle
	\left<\,\eta_\omega(a),\, 
	\varrho_\omega(\bigvee D)
	\,\eta_\omega(a)\,\right>.
\end{alignat*}
Since~$\{\,\eta_\omega(a)\colon \,a\in\scrA\,\}$
is dense in~$\scrH_\omega$,
we conclude \TODO{} that~$\bigvee_{d\in D} \varrho_\omega(d)
= \varrho_\omega(\bigvee D)$,
and so~$\varrho_\omega$ is normal.\qed
\end{point}
\end{point}
\begin{point}[varrho-Omega-normal]{Exercise}%
Show that the map $\varrho_\Omega$ 
from~\sref{gelfand-naimark-representation}
is normal for every collection~$\Omega$ of np-maps $\scrA\to\C$
on a von Neumann algebra $\scrA$.
\end{point}
\begin{point}[injective-nmiu-iso-on-image]{Lemma}%
Let~$f\colon \scrA\to\scrB$ be an injective nmiu-map
between von Neumann algebras.
Then~$f(\scrA)$ is a von Neumann subalgebra of~$\scrB$,
and~$f$ restricts to a nmiu-isomorphism from~$\scrA$
to~$f(\scrA)$.
\begin{point}{Proof}%
We already know by~\sref{injective-miu-iso-on-image}
that~$f(\scrA)$ is a $C^*$-subalgebra of~$\scrA$,
and that~$f$ restricts to a miu-isomorphism~$f'\colon \scrA\to f(\scrA)$.
The only thing left to show is that~$f(\scrA)$
is a von Neumann subalgebra of~$\scrB$,
because a miu-isomorphism between von Neumann algebras
(being an order isomorphism)
will automatically be a nmiu-isomorphism.
Let~$D$ be a bounded directed subset of~$f(D)$.
Note that~$S:=(f')^{-1}(D)$ is a bounded
directed subset of~$\scrA$,
and so~$\bigvee D\equiv  \bigvee f(\,S\,)
= f(\bigvee S)$, because~$f$ is normal.
Thus~$\bigvee f(D)\in f(\scrA)$,
and so $f(\scrA)$ is a von Neumann subalgebra of~$\scrB$.\qed
\end{point}
\end{point}
\begin{point}[ngns]{Theorem (normal Gelfand--Naimark)}%
Every von Neumann algebra~$\scrA$ is nmiu-isomorphic
to von Neumann algebra of operators on a Hilbert space.
\begin{point}{Proof}%
Recall that an element $a\in \scrA$ is zero iff $\omega(a)=0$
for all np-maps $\omega\colon \scrA\to\C$.
It follows that the collection~$\Omega$
of all np-maps $\scrA\to\C$
obeys the condition of~\sref{proto-gelfand-naimark},
and so the miu-map $\varrho_\Omega\colon \scrA\to\scrB(\scrH_\Omega)$
(from~\sref{gelfand-naimark-representation})
is injective.
Since~$\varrho_\Omega$
is also normal by~\sref{varrho-Omega-normal},
we see by~\sref{injective-nmiu-iso-on-image} that~$\varrho_\Omega$
restricts to a nmiu-isomorphism
from~$\scrA$ to the von Neumann subalgebra~$\varrho_\Omega(\scrA)$
of~$\scrB(\scrH_\Omega)$.\qed
\end{point}
\end{point}
\end{parsec}
\section{Projections}
\begin{parsec}%
\begin{point}%
One pertinant feature
of von Neumann algebras
is an abundance of projections:
above each effect~$a$ 
there is a least projection~$\ceil{a}$
called the ceiling of~$a$;
for every np-map $\omega\colon \scrA\to \scrB$
between von Neumann algebras
there is a least projection~$p$ with~$\omega(p^\perp)$
called the carrier of~$\omega$;
the directed supremum of projections is again a projection;
the partial order of projections forms a complete lattice;
and each element is the norm limit
of linear combinations of projections.
\end{point}
\begin{point}{Definition}%
An element~$p$ of a $C^*$-algebra
is a \Define{projection}
when~$p^*p=p$.
\end{point}
\begin{point}{Exercise}%
Show that in a $C^*$-algebra:
\begin{enumerate}
\item
$0$ and~$1$ are projections.
\item
A projection~$p$ is an effect,
that is, $p^*=p$
and $0\leq p\leq 1$.
\item
An effect~$a$ is a projection iff $aa^\perp=0$.
\end{enumerate}
\end{point}
\begin{point}[ad-contraposed]{Lemma}%
Let~$a$ be an element of a $C^*$-algebra~$\scrA$
with $\|a\|\leq 1$,
and let~$p$ and~$q$ be projections on~$\scrA$.
Then 
$a^* p a \leq q^\perp$
iff $paq=0$
iff  $aqa^*\leq p^\perp$.
\begin{point}{Proof}%
Suppose that~$a^*pa\leq q^\perp$.
Then we have $q a^*pa q \leq qq^\perp q = 0$
(see \sref{ad-monotone})
and so $paq=0$,
because $\|paq\|^2=\|(paq)^*paq\|=0$
by the $C^*$-identity.
Applying $(\,\cdot\,)^*$,
we get $qa^*p=0$, and so both $qa^* = qa^*p^\perp$
and $aq = p^\perp aq$, giving
us $aqa^* = p^\perp a q a^* p^\perp 
\leq p^\perp$,
where we used that $aqa^*\leq aa^*\leq \|aa^*\|=\|a\|^2\leq 1$.
By a similar reasoning,
we get $aqa^*\leq p^\perp \implies paq=0\implies a^*pa\leq q^\perp$.\qed
\end{point}
\end{point}
\begin{point}{Exercise}%
Let~$a$ be an effect of a $C^*$-algebra~$\scrA$,
and~$p$ be a projection from~$\scrA$.
\begin{point}[projection-above-effect]%
Show that $a\leq p$
iff $p\sqrt{a} = \sqrt{a}$
iff $\sqrt{a}p = \sqrt{a}$
iff $p^\perp\sqrt{a} = 0$
iff $\sqrt{a}p^\perp = 0$
iff $a^2\leq p$
iff $p a  = a$
iff $ a p = a $
iff $p^\perp a  = 0$
iff $ap^\perp = 0$
iff $\sqrt{a}\leq p$.
\end{point}
\begin{point}[projection-below-effect]%
Show that $p\leq a$
iff $p \sqrt{a} = p$
iff $\sqrt{a} p = p$
iff $ p\sqrt{a}^\perp = 0$
iff $\sqrt{a}^\perp p = 0$
iff $p\leq a^2$
iff $ap=p$
iff $pa = p$
iff $pa^\perp =0$
iff $a^\perp p =0$
iff $p\leq \sqrt{a}$.
\end{point}
\end{point}
\begin{point}{Definition}%
We say that projections~$p$ and~$q$
from a $C^*$-algebra~$\scrA$ are \Define{orthogonal}
when~$pq=0$,
and we say that a subset of projections
from~$\scrA$ is \Define{orthogonal}
when all~$p$ and~$q$ from~$E$
are either equal or orthogonal.
\end{point}
\begin{point}[orthogonal-tuple-of-projections]{Exercise}%
Let~$\scrA$ be a $C^*$-algebra.
\begin{enumerate}
\item
Show that projections~$p$ and~$q$ from~$\scrA$
are orthogonal iff $pq=0$ iff $qp=0$ iff $pqp=0$
iff $p+q\leq 1$ iff $p\leq q^\perp$
iff $p+q$ is a projection.
\item
Show that a finite set of  projections $p_1,\dotsc,p_n$
from~$\scrA$ is orthogonal
iff~$\sum_i p_i \leq 1$
iff $\sum_i p_i$ is a projection.

Show that, in that case, $\sum_i p_i$ is the least projection
above~$p_1,\dotsc,p_n$.
\end{enumerate}
\end{point}
\begin{point}[projection-below-projection]{Exercise}%
Let~$p$ and~$q$ be projections from a $C^*$-algebra
with~$p\leq q$.\\
Show that~$q-p$ is a projection
(either directly, or using~\sref{orthogonal-tuple-of-projections}).
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}[vna-ceil]{Proposition}%
Above every effect~$b$ of a von Neumann algebra~$\scrA$,
there is a smallest projection, \Define{$\ceil{b}$},
called the \Define{ceiling} of~$b$,
 given by $\ceil{b}=\bigvee_{n=0}^\infty b^{\nicefrac{1}{2^n}}$.\\
Moreover, if $a\in \scrA$ commutes with $b$,
then~$a$ commutes with~$\ceil{b}$.

\TODO{Remark that $\ceil{\,\cdot\,}$ is not continuous in any sense
because $\nicefrac{1}{n}\to 0$
in any topology, while $\ceil{\nicefrac{1}{n}}\equiv1 \to 1\neq  0$.}
\begin{point}{Proof}
Let~$p$ denote the supremum of~$0\leq b\leq b^{\nicefrac{1}{2}}\leq
b^{\nicefrac{1}{4}}\leq\dotsb\leq 1$.
\begin{point}[vna-ceil-point-1]%
To begin,
note that if~$a\in \scrA$
commutes with~$b$,
then~$a$ commutes with~$p$.
Indeed, for such~$a$ we have~$a\sqrt{b}=\sqrt{b}a$
by~\sref{cstar-square-commutes},
and so $a b^{\nicefrac{1}{2^n}} = b^{\nicefrac{1}{2^n}} a$
for each~$n$
by induction.
Thus~$ap=pa$ by~\sref{vna-supremum-commutes}.
\end{point}
\begin{point}%
Let us prove that~$p$ is a projection, c.q.~$p^2=p$. 
Since~$p\leq 1$, we already have $p^2\equiv \sqrt{p}p\sqrt{p}\leq p$
by~\sref{ad-monotone},
and so we only need to show that $p\leq p^2$. We have:
\begin{alignat*}{3}
 p^2 \ &=\  \textstyle \bigvee_m \sqrt{p} \,b^{\nicefrac{1}{2^m}} \,\sqrt{p}
\qquad&&\text{by \sref{ad-normal}} \\
&=\ \textstyle\bigvee_m b^{\nicefrac{1}{2^{m+1}}}\, p\,
b^{\nicefrac{1}{2^{m+1}}} 
\qquad&&\text{by \sref{vna-ceil-point-1} and \sref{cstar-square-commutes}} \\
&=\ \textstyle \bigvee_m \bigvee_n \, 
b^{\nicefrac{1}{2^{m+1}}}\, b^{\nicefrac{1}{2^n}}\,
b^{\nicefrac{1}{2^{m+1}}} \qquad && \text{by \sref{ad-normal}}
\end{alignat*}
Thus $p^2 \geq b^{\nicefrac{1}{2^k}}$
for each~$k$ (taking $n=m=k+1$,)
and so~$p^2 \geq p$.
\end{point}
\begin{point}%
It remains to be shown that~$p$ is the \emph{least} projection
above~$b$.
Let~$q$ be a projection in~$\scrA$ with $b\leq q$;
we must show that~$q\leq p$.
We have $b^{\nicefrac{1}{2}}\leq q$
by~\sref{projection-above-effect},
and so $b^{\nicefrac{1}{2^n}}\leq q$ for each~$n$ by induction.
Hence $p\leq q$.\qed
\end{point}
\end{point}
\end{point}
\begin{point}[vna-floor]{Proposition}%
Below every effect~$b$ of a von Neumann algebra~$\scrA$,
there is greatest projection, \Define{$\floor{b}$},
called the \Define{floor} of~$b$,
given by~$\floor{b} = \bigwedge_{n=0}^\infty b^{2^{n}}$.\\
Moreover, if~$a\in \scrA$ commutes with~$b$,
then~$b$ commutes with~$\floor{b}$.
\begin{point}{Proof}%
Let~$p$ denote the infimum of $1\geq b\geq b^2 \geq b^4 \geq  \dotsb \geq 0$.
\begin{point}[vna-floor-point-1]%
If~$a\in \scrA$ commutes with~$b$,
then~$a$ commutes with~$p$.
Indeed, such~$a$ commutes with~$b^2$ (because
$ab^2 = bab = b^2a$,)
and so~$a$ commutes with~$b^{2^n}$ for each~$n$ by induction.
Thus~$a$ commutes with~$p\equiv\bigwedge_n b^{2^n}$ 
(by a variation on~\sref{vna-supremum-commutes}.)
\end{point}
\begin{point}%
To see that~$p$ is a projection, c.q.~$p^2=p$,
we only need to show that~$p\leq p^2$,
because we get $p^2\equiv \sqrt{p}\,p\,\sqrt{p}\leq p$
from $p\leq 1$ (using~\sref{ad-monotone}.)
Now, since
\begin{alignat*}{3}
p^2 \ &=\ \textstyle \bigwedge_m\  \sqrt{p}\, b^{2^m} \sqrt{p}\qquad
&&\text{by a variation on~\sref{ad-normal}}\\
&=\ \textstyle \bigwedge_m \ b^{2^{m-1}} p\, b^{2^{m-1}}\qquad
&&\text{by~\sref{vna-floor-point-1} and~\sref{cstar-square-commutes}}\\
&=\ \textstyle \bigwedge_m \bigwedge_n \ 
b^{2^{m-1}}\, b^{2^n}\, b^{2^{m-1}}\qquad
&&\text{by~\sref{ad-normal},}
\end{alignat*}
and $p\leq b^{2^{m-1}}\, b^{2^n}\,b^{2^{m-1}}$
for all~$n,m$, we get~$p\leq p^2$.
\end{point}
\begin{point}%
It remains to be shown that~$p$ is the greatest projection above~$b$.
Let~$q$ be a projection in~$\scrA$ with~$q\leq b$
we must show that~$q\leq p$.
Since~$q\leq b$,
we have~$q\leq b^2$ (by~\sref{projection-below-effect}),
and so~$q\leq b^{2^n}$ for each~$n$ by induction.
Thus~$q\leq p\equiv\bigwedge_n b^{2^n}$.\qed
\end{point}
\end{point}
\end{point}
\begin{point}[ceil-floor-second-property]{Exercise}%
Show that given an effect~$a$ and a projection~$p$
in a von Neumann algebra~$\scrA$ we have
\begin{enumerate}
\item
$pa=a$ iff $ap=a$ iff $\ceil{a}\leq p$, and
\item
$pa=p$ iff $ap=p$ iff $p\leq \floor{a}$.
\end{enumerate}
Conclude that~$\ceil{a}$
is the least projection with $a=a\ceil{a}\equiv\ceil{a}a$,
and that $\floor{a}$
is the greatest projection with $\floor{a}=a\floor{a}\equiv \floor{a}a$.
\end{point}
\begin{point}[ceil-floor-basic]{Exercise}%
Let~$a,b$ be effects of a von Neumann algebra~$\scrA$,
and let~$\lambda\in [0,1]$.
\begin{enumerate}
\item
Show that $\ceil{a}^\perp = \floor{a^\perp}$
and $\floor{a}^\perp = \ceil{a^\perp}$.
\item
Show that~$\ceil{\lambda a} = \ceil{a}$
when~$\lambda\neq 0$.

Use this to prove that~$\ceil{\lambda a+\lambda^\perp b}$
is the supremum of~$\ceil{a}$ and~$\ceil{b}$
in the poset of projections of~$\scrA$
when~$\lambda\neq 0$ and~$\lambda\neq 1$.
\item
Show that $\floor{a}=\floor{a^2}$
and $\ceil{a}=\ceil{a^2}$.
\end{enumerate}
\end{point}
\begin{point}[vna-directed-supremum-projections]{Lemma}%
The supremum of a directed set~$D$ of projections
from a von Neumann algebra~$\scrA$ is a projection.
\begin{point}{Proof}%
Writing $p=\bigvee D$,
we must show that $p^2=p$.
Note that $dp=d$ for all~$d\in D$
(by~\sref{projection-below-effect} because~$d\leq p$.)
Now, on the one hand, $(d)_{d\in D}$
converges ultraweakly to~$p$.
On the other hand,
$(dp)_{d\in D}$
converges ultraweakly to~$p^2$ by~\sref{vna-supremum-mult}.
Hence~$p=p^2$ by uniqueness of ultraweak limits.
\end{point}
\end{point}
\begin{point}{Exercise}%
Deduce from this result
 that every set~$A$ of projections from~$\scrA$
has a supremum $\Define{\bigcup A}$
and an infimum $\Define{\bigcap A}$
\emph{in the poset of projections from~$\scrA$}.\\
(Hint: use~\sref{ceil-floor-basic},
and the fact that $p\mapsto p^\perp$ 
is an order isomorphism on the poset of projections on~$\scrA$.)
\end{point}
\begin{point}[ceil-supremum]{Exercise}
Let~$\scrA$ be a von Neumann algebra.
\begin{enumerate}
\item
Show that $\ceil{\bigvee D}=\bigcup_{d\in D} \ceil{d}$
for every directed set~$D$ of effects from~$\scrA$.
\item
Show that $\floor{\bigwedge D} = \bigcap_{d\in D} \floor{d}$
for every filtered set~$D$ of effects from~$\scrA$.
\item
Show that $\ceil{\,\cdot\,}$
does not preserve filtered infima,
and~$\floor{\,\cdot\,}$
does not preserve directed suprema.
(Hint: $1,\frac{1}{2},\frac{1}{3},\dotsc$.)

Conclude that $\ceil{\,\cdot\,}$
and $\floor{\,\cdot\,}$
are neither ultraweakly nor ultrastrongly continuous
as maps from $[0,1]_\scrA$ to~$[0,1]_\scrA$.
\end{enumerate}
\end{point}
\begin{point}[sum-of-orthogonal-projections]{Exercise}%
Show that for a family~$(p_i)_{i\in I}$ 
of orthogonal projections
(with~$I$ potentially uncountable)
the series $\sum_i p_i$
converges ultrastrongly to~$\bigcup_i p_i$.

(Hint: 
use the fact that $\sum_{i\in F} p_i = \bigcup_{i \in F} p_i$
for finite subsets~$F$ of~$I$ by~\sref{orthogonal-tuple-of-projections}.)
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}{Notation}%
Let~$\scrA$ be a von Neumann algebra.
Because it will be very convenient
we extend the definition of~$\ceil{b}$
to all positive~$b$ from~$\scrA$
---
contrary to what the notation suggests,
$b\leq \ceil{b}$
---
by 
defining $\Define{\ceil{b}}=\ceil{\|b\|^{-1} b}$
when~$b\nleq 1$.

Now, given an arbitrary element~$b$ of~$\scrA$,
we'll call $\Define{\ceill{b}}:=\ceil{b^*b}$
the \Define{support} of~$b$,
and~$\Define{\ceilr{b}}:=\ceil{bb^*}$ the \Define{range} of~$b$.
\end{point}
\begin{point}[ceil-basic]{Exercise}%
Let~$a$ and~$b$ be a positive elements of a von Neumann algebra~$\scrA$.
\begin{enumerate}
\item
Show that $pa=a$ iff $ap=a$ iff $\ceil{a}\leq p$
for every projection~$p$ of~$\scrA$.

(In particular, $\ceil{a}$ is the least projection of~$\scrA$
with $a\ceil{a}=a$.)

\item
Show that $\ceil{a}a=a\ceil{a}$,
and if fact, if $b\in\scrA$ commutes with~$a$
then~$b$ commutes with~$\ceil{a}$.

\item
Show that~$a=0$ iff $\ceil{a}=0$.

\item
Show that $\ceil{a}=\ceil{\lambda a}$
for every~$\lambda>0$.

Show that $\ceil{a+b}=\ceil{a}\cup\ceil{b}$.
\item
Show that $\ceil{a^2}=\ceil{a}$.
\end{enumerate}
\end{point}
\begin{point}[ceil-pos-part]{Exercise}%
Let~$a$ be a self-adjoint element of a von Neumann algebra.
\begin{enumerate}
\item
Show that~$\ceil{a_+}\ceil{a_-}= 0$.
(Hint: recall from~\sref{cstar-pos-neg-part} that~$a_+a_-=0$.)
\item
	Show that~$\ceil{a_+}a = a\ceil{a_+} = a_+$
	and~$\ceil{a_-}a=a\ceil{a_-} = -a_-$.
\end{enumerate}
\end{point}
\begin{point}[ceil-suprema]{Exercise}%
Show that $\ceil{\bigvee D} = \bigcup_{d\in D}\ceil{d}$
for every directed set of \emph{positive}
elements of a von Neumann algebra~$\scrA$.
\end{point}
\begin{point}{Exercise}%
Let~$a$ and~$b$  be elements of a von Neumann algebra.
\begin{enumerate}
\item
Show that $\ceill{a}\equiv \ceil{a^*a}$
is the least projection of~$\scrA$
with $a\ceill{a}=a$.

\item
Show that $\ceilr{a}\equiv \ceil{aa^*}$
is the least projection of~$\scrA$
with $\ceilr{a}a=a$.

\item
Show that $\ceill{a^*}=\ceilr{a}$
and $\ceilr{a^*}=\ceill{a}$.

\item
Show that~$\ceill{ab}\leq\ceill{b}$
and~$\ceilr{ab}\leq\ceilr{a}$.
\end{enumerate}
\end{point}
\begin{point}{Exercise}%
Let~$T$ be a bounded operator on a Hilbert space~$\scrH$.
\begin{enumerate}
\item
Show that $\ceilr{T}$
is the projection onto the closure
$\overline{\Ran(T)}$ of the range of~$T$.
\item
Show that $\ceill{T}$
is the projection onto the \emph{support}
of~$T$, i.e.~the orthocomplement
$\Ker(T)^\perp$ of the kernel of~$T$.
\item
Show that $\floor{T}$ is the projection
on $\{\,x\in\scrH\colon\, Tx=x\,\}$
when~$T$ is an effect.
\end{enumerate}
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}[cpsu-root-square]{Exercise}%
Let~$f\colon \scrA\to\scrB$ be a ncpsu-map
between von Neumann algebras
and let~$a\in \scrA$ be positive.
\begin{enumerate}
\item
Show that~$f(a)^2 \leq f(a^2)$
(perhaps using~\sref{cp-cs}).
\item
	Use this, and~\sref{sqrt-monotone}
to show that~$f(a^{\nicefrac{1}{2}}) \leq f(a)^{\nicefrac{1}{2}}$.
\item
Go on, and show that $f(a^{\nicefrac{1}{2^n}})
\leq f(a)^{\nicefrac{1}{2^n}}$ for each~$n$.
\end{enumerate}
\end{point}
\begin{point}[ncp-ceil]{Proposition}%
Let $f\colon \scrA\to\scrB$ be a ncp-map
between von Neumann algebras.
Then $\ceil{f(a)}=\ceil{f(\ceil{a})}$
for every $a\in\scrA_+$.
\begin{point}{Proof}%
Note that if~$a=0$,
then
the stated result is clearly correct.
In the other case, when~$\|a\| \neq 0$,
the problem reduces to the case
that $0\leq a\leq 1$
by replacing $a$ by~$\frac{a}{\|a\|}$.
So let us just assume that~$a\in [0,1]_\scrA$
to begin with.
For similar reasons, we may assume that $f(1)\leq 1$.

Now, since~$a\leq \ceil{a}$
we have $f(a)\leq f(\ceil{a})$,
and so~$\ceil{f(a)}\leq \ceil{f(\ceil{a})}$.
It remains to be shown that $\ceil{f(\ceil{a})}\leq \ceil{f(a)}$,
that is, $f(\ceil{a})\leq \ceil{f(a)}$.
Since  $\ceil{a}=\bigvee_n a^{\nicefrac{1}{2^n}}$ 
(by~\sref{vna-ceil})
and~$f$ is normal,
we have $f(\ceil{a})=\bigvee_n f(a^{\nicefrac{1}{2^n}})$.
Now, since $f(a^{\nicefrac{1}{2^n}})\leq f(a)^{\nicefrac{1}{2^n}}
\leq \ceil{f(a)}$
by~\sref{cpsu-root-square} for each~$n$,
we have~$f(\ceil{a})\leq \ceil{f(a)}$.\qed
\end{point}
\end{point}
\begin{point}[ceil-fundamental]{Exercise}%
Let~$a$ and~$b$ be elements of a von Neumann algebra~$\scrA$.
\begin{enumerate}
\item
Deduce from~\sref{ncp-ceil}
that
$\ceil{a^*ba} = \ceil{a^*\ceil{b}a}$
when~$a\geq 0$.
\item
Conclude that~$\ceill{ab}=\ceill{\ceill{a}b}$
and~$\ceilr{ab}=\ceilr{a\ceilr{b}}$.

\end{enumerate}
\end{point}
\begin{point}[mult-cancellation]{Exercise}%
Let~$a$ and~$b$ be an element of a von Neumann algebra~$\scrA$.
\begin{enumerate}
\item
Show that $cb=0$ iff $\ceill{c}\ceilr{b}=0$
iff $\ceill{c}\leq \ceilr{b}^\perp$
for~$c\in\scrA$.

(Hint: if $cb=0$,
then $\ceil{b^*c^*cb}\equiv \ceil{b^*\ceil{c^*c}b}=0$
by~\sref{ceil-fundamental}.)
\item
Show that~$c_1b=c_2b \implies c_1=c_2$
for all~$c_1,c_2\in\scrA$
with~$\ceill{c_i}\leq \ceilr{b}$.
\item
Show that $b^*c_1b=b^*c_2b\implies c_1=c_2$
for all~$c_1,c_2\in\ceilr{b}\scrA\ceilr{b}$
\end{enumerate}
\end{point}
\begin{point}[ncp-union]{Exercise}%
Let~$f\colon \scrA\to\scrB$ be an ncp-map
between von Neumann algebras.
\begin{enumerate}
\item
Show that
$\ceil{f(p\cup q)}
= \ceil{f(p)}\cup\ceil{f(q)}$
for all projections $p$ and~$q$ in~$\scrA$.

(Hint: recall from~\sref{ceil-floor-basic} 
that $p\cup q = \ceil{\frac{1}{2}p+\frac{1}{2}q}$.)

\item
Deduce from this and~\sref{ncp-ceil} that $\ceil{f(\bigcup A)}=\bigcup_{a\in A}\ceil{f(a)}$
for every set of projections~$A$ from~$\scrA$.
\end{enumerate}
\end{point}
\end{parsec}
\section{Completeness}
\begin{parsec}%
\begin{point}%
We have just seen (in~\sref{npuws})
that a \emph{positive} linear functional~$f$
on a von Neumann algebra 
is ultrastrongly continuous iff it is ultraweakly continuous.
In this section, we'll show that the same result holds
for an arbitrary linear functional~$f$.
Note that if~$f$ is ultraweakly continuous,
then~$f$ is automatically ultrastrongly continuous
(because ultrastrong convergence implies ultraweak convergence).
For the other direction,
we'll show that if~$f$ is ultrastrongly continuous,
then~$f$ can be written as a linear combination
$f\equiv \sum_{k=0}^3 i^k f_k$
of np-maps $f_0,\dotsc,f_3$,
and must therefore be ultraweakly continuous.
We'll need the following tool.
\end{point}
\begin{point}[bstaromega]{Definition}%
Let~$\scrA$ be a von Neumann algebra.
Given an np-map $\omega\colon \scrA\to\C$,
and~$b\in \scrA$,
define~$\Define{b*\omega}\colon \scrA\to \C$ by
$(b*\omega)(a)=\omega(b^*ab)$ for all~$a\in \scrA$.
\end{point}
\begin{point}[bstaromega-basic]{Exercise}%
Let~$\omega\colon \scrA\to \C$ be an np-map on a von Neumann algebra~$\scrA$.
\begin{enumerate}
\item
Show that $b*\omega\colon \scrA\to\C$
is an np-map for all~$b\in \scrA$
(using \TODO{}).
\item
Show that $\left|\omega(a^*bc)\right| 
\,\leq\, \|\omega\|\,\|a\|_\omega\, \|b\|\, \|c\|_\omega$
for all~$a,b,c\in\scrA$.

Deduce that $\| b*\omega - b'*\omega\|
\,\leq\, \|\omega\| \,\|b-b'\|_\omega\, (\|b\|_\omega + \|b'\|_\omega)$
for all~$b,b'\in\scrA$.

\item
Let~$b_1,b_2,\dotsc$  a sequence in~$\scrA$,
which is Cauchy with respect to~$\|\,\cdot\,\|_\omega$.
Show that the sequence~$b_1*\omega,\,b_2*\omega,\,\dotsc$ 
is Cauchy (in the operator norm
on bounded linear functionals $\scrA\to\C$),
and converges to a bounded linear map~$f\colon \scrA\to\C$.
Show that~$f$ is an np-map.
\TODO{non-trivial?}
\end{enumerate}
\end{point}
\begin{point}{Exercise}%
Let~$f\colon \scrA\to \C$ be a ultrastrongly continuous linear
functional on a von Neumann algebra~$\scrA$.
Show that there is an np-map
$\omega\colon \scrA\to \C$
and $\delta>0$
with $\left|f(a)\right|\leq 1$
for all~$a\in\scrA$ with $\|a\|_\omega \leq \delta$.

(Keep this in mind when reading the following lemma.)
\end{point}
\begin{point}[normal-functionals-lemma]{Lemma}%
Let~$\omega\colon \scrA\to\C$ be an np-map,
and let~$f\colon \scrA\to \C$ be a linear map.
The following are equivalent.
\begin{enumerate}
\item\label{normal-functionals-lemma-0}
$\left|f(a)\right|\leq B$ for all~$a\in \scrA$
with $\|a\|_\omega\leq \delta$, for some $\delta,B>0$;
\item\label{normal-functionals-lemma-1}
$\left|f(a)\right| \leq B \|a\|_\omega$ for all~$a\in\scrA$,
for some~$B>0$;
\item\label{normal-functionals-lemma-2}
$f(a)=[b,a]_\omega$ for all~$a\in\scrA$, 
for some~$b\in\scrH_\omega$
(where $\scrH_\omega$ is the Hilbert space completion of~$\scrA$
with respect to the inner-product
$[\,\cdot\,,\,\cdot\,]_\omega$).
\item\label{normal-functionals-lemma-3}
$f\equiv f_0+if_1-f_2-if_3$
where $f_0,\dotsc,f_3\colon \scrA\to \C$
are np-maps for which there is~$B>0$
such that~$f_k(a)\leq B \omega(a)$ for all~$a\in\pos{\scrA}$ 
and~$k$. 
\end{enumerate}
\begin{point}{Proof}%
We make a circle.
\begin{point}{%
\ref{normal-functionals-lemma-3}$\Longrightarrow$%
\ref{normal-functionals-lemma-0}}%
For $a\in \scrA$ and~$k$, we have
$\left|f_k(a)\right|^2 \leq
f_k(1)\,f_k(a^*a) \leq f_k(1)B \,\omega(a^*a)$,
giving~$\left|f_k(a)\right| \leq (f_k(1)B)^{\nicefrac{1}{2}} \|a\|_\omega$,
and so~$\left|f(a)\right|\leq \tilde{B} \|a\|_\omega$,
where $\tilde{B} = B^{\nicefrac{1}{2}}\sum_{k=0}^3f_k(1)^{\nicefrac{1}{2}}$.
Hence~$\left|f(a)\right|\leq \tilde{B}$
for all~$a\in\scrA$ with $\|a\|_\omega\leq 1$.
\end{point}
\begin{point}{\ref{normal-functionals-lemma-0}$\Longrightarrow$%
\ref{normal-functionals-lemma-1}}%
Let~$a\in\scrA$, and~$\varepsilon>0$ be given.
Then for~$\tilde{a}:=\delta(\varepsilon+\|a\|_\omega)^{-1}\,a$,
we have $\|\tilde{a}\|_\omega\leq \delta$,
and so~$\left|f(\tilde{a})\right|
\equiv \delta(\varepsilon +\|a\|_\omega)^{-1} \,\left|f(a)\right|
\leq B$,
which entails $\left|f(a)\right|\leq 
B\delta^{-1}(\varepsilon+\|a\|_\omega)$.
Since~$\varepsilon>0$ was arbitrary, we get~$\left|f(a)\right|\leq
B\delta^{-1}\|a\|_\omega$.
\end{point}
\begin{point}{%
\ref{normal-functionals-lemma-1}$\Longrightarrow$%
\ref{normal-functionals-lemma-2}}%
Since~$\left|f(a)\right|\leq B\|a\|_\omega$ for all~$a\in\scrA$,
the map~$f$ can be extended to a bounded linear map 
$\tilde{f}\colon \scrH_\omega\to \C$.
Then by Riesz' representation theorem (\TODO{}),
there is~$b\in \scrH_\omega$ with $\tilde{f}(x)=[b,x]_\omega$
for all~$x\in \scrH_\omega$.  
In particular,
$f(a)=[b,a]_\omega$ for all~$a\in \scrA$.
\end{point}
\begin{point}{\ref{normal-functionals-lemma-2}$\Longrightarrow$%
\ref{normal-functionals-lemma-3}}%
We know that~$f(a)\equiv [b,a]_\omega$ for all~$a\in \scrA$,
for some~$b\in\scrH_\omega$.
Then, by definition of~$\scrH_\omega$,
there is a sequence~$b_1,b_2,\dotsc$ in~$\scrA$
which converges to~$b$ in~$\scrH_\omega$.
Then the maps $[b_n,\,\cdot\,]_\omega\colon \scrA\to \C$
approximate~$f=[b,\,\cdot\,]_\omega$
in the sense that 
$\left|f(a)-[b_n,a]_\omega\right|=\left|[b-b_n,a]_\omega\right|
\leq \|b-b_n\|_\omega \|a\|_\omega
\leq \|b-b_n\|_\omega \|\omega\| \|a\|$
for all~$a\in \scrA$.
In particular, $[b_1,\,\cdot\,]_\omega,\,[b_2,\,\cdot\,]_\omega,\,\dotsc$
converges to~$f$ (in the operator norm).
By ``polarization'' (c.f.~\sref{mult-polarization}),
we have $[b_n,a]_\omega = \frac{1}{4}\sum_{k=0}^3 i^kf_{k,n}(a)$,
where $f_{k,n} := (i^kb_n+1)*\omega$ is an np-map.
Since~$(i^kb_n+1)_n$ is Cauchy with respect to~$\|\,\cdot\,\|_\omega$,
we see by~\sref{bstaromega-basic} that 
$(f_{k,n})_n$ converges to an np-map $f_k\colon \scrA\to\C$
(with respect to the operator norm).
It follows that~$f=\frac{1}{4}\sum_{k=0}^3 i^k f_k$.

It remains to be shown that there is~$B>0$ with $f_k(a)\leq B\omega(a)$
for all~$k$ and~$a\in\pos{\scrA}$.
Note that since $f_{k,n}(a) \leq \|i^kb_n+1\|_\omega \,\omega(a)
\leq (\|b_n\|_\omega+1) \,\omega(a)$,
for all~$n$, $k$, and~$a\in\pos{\scrA}$,
the number $B:=\lim_n \|b_n\|_\omega +1 $ will do.\qed
\end{point}
\end{point}
\end{point}
\begin{point}[luws]{Corollary}%
For a linear map~$f\colon \scrA\to \C$
on a von Neumann algebra~$\scrA$ the following are equivalent.
\begin{enumerate}
\item
$f$ is ultrastrongly continuous;
\item
$f$ is ultraweakly continuous;
\item
$f\equiv f_0+if_1-f_2-if_3$
for some~np-maps $f_0,\dotsc,f_3\colon \scrA\to\C$;
\item
``$f$ is bounded on some $\|\,\cdot\,\|_\omega$-ball,''
that is,
\begin{equation*}
	\sup\{\ \left|f(a)\right|\colon a\in \scrA\colon 
		\|a\|_\omega\leq \delta\ \}\ <\ \infty
\end{equation*}
for some $\delta>0$ and  np-map $\omega\colon \scrA\to\C$;
\item
$\left|f(a)\right|\leq \|a\|_\omega$
for all~$a\in \scrA$, for some np-map $\omega\colon \scrA\to\C$.
\end{enumerate}
\end{point}
\end{parsec}
%
%	ultrastrong and ultraweak closure of a convex subset
%
\begin{parsec}%
\begin{point}%
We'll show that the ultrastrong and ultraweak closure
of a convex set agree. 
For this we need the following proto-Hahn--Banach separation theorem,
which concerns the following notion of openess.
\end{point}
\begin{point}{Definition}%
A subset~$A$ of a real vector space~$V$ 
is called \Define{radially open}
if for all~$a\in A$ and~$v\in V$
there is $t\in (0,\infty)$
with $a+sv\in A$ for all~$s\in [0,t)$.
\end{point}
\begin{point}{Exercise}%
Let~$V$ be a vector space.
\begin{enumerate}
\item
Show that the radially open subsets of~$V$ form a topology.
\item
Show that with respect to this topology,
scalar multiplication and translations $x\mapsto x+a$
by a fixed vector~$a\in V$ are continuous.
\item
Show that $\{(0,0)\}\cup B_1(-1)\cup B_1(1)\cup B_2(-2)^c\cup B_2(2)^c$
is a radially open subset of~$\R^2$, 
which is not open
in the usual topology.\TODO{picture}

\item
Show that addition on~$\R^2$ is not jointly radially continuous.
\item
Show that nevertheless $\{s\in \R \colon sx+s^\perp y\in A\}$
is open for every radially open~$A\subseteq V$, and $x,y\in V$.
\item
Show that $A+B$ is radially open when~$A,B\subseteq V$ are radially open.

Show that $\{\lambda a\colon a\in A,\lambda>0\}$ is radially open
when~$A$ is radially open.
\end{enumerate}
\end{point}
\begin{point}[hahn-banach]{Theorem}%
For every radially open
convex subset~$K$ of a real vector space~$V$
with~$0\notin K$
there is a linear map $f\colon V\to\R$
with $f(x)>0$ for all~$x\in K$.
\begin{point}{Proof}%
(Based on Theorem~1.1.2 of~\cite{kr}.)

By Zorn's Lemma we may assume without loss of generality that~$K$ is maximal
among radially open convex subsets of~$V$ that do not contain~$0$.

We also assume that~$K$ is non-empty,
because if~$K=\varnothing$, the result is trivial.

We will show in a moment that~$H:=\{x\in V\colon -x,x\notin K\}$
is a linear subspace and~$V/H$ is one-dimensional.
From this we see that there is a linear map $f\colon V\to\R$
with~$\ker(f)=H$.
Since~$f(K)$ is a convex subset which does not contain~$0$
(because $H\cap K=\varnothing$)
we either have $f(K)\subseteq (0,\infty)$
or $f(K)\subseteq(-\infty,0)$.
Thus, by replacing $f$ by $-f$ if necessary,
we see that there is a linear map $f\colon V\to \R$
with $f(x)>0$ for all~$x\in K$.
\begin{point}{$H$ is a linear subspace}%
Note that~$x\in K,\,\lambda>0\implies \lambda x\in K$,
because the subset 
$\{\lambda x\colon x\in K,\lambda\in(0,\infty)\}\supseteq K$
is radially open, convex, doesn't contain~$0$,
and is thus~$K$ itself.
Furthermore,
$x,y\in K\implies x+y\in K$, because
$x+y=2(\frac{1}{2}x + \frac{1}{2}y)$, and~$K$ is convex.

Let~$\overline{K}$ be the set of all~$x\in V$
with $x+y\in K$ for all~$y\in K$.
Then it is not difficult to check that~$\overline{K}$ is a cone:
 $0\in\overline{K}$,
and
$x\in \overline{K},\lambda\geq 0\implies \lambda x\in \overline{K}$, and
$x,y\in\overline{K}\implies x+y\in \overline{K}$.

We claim that~$x\in \overline{K}$ iff $-x\notin K$.
Indeed, if~$x\in\overline{K}$, then $-x\notin K$, because otherwise
$-x\in K$ and so
$0=x+(-x)\in K$, which is absurd.
For the other direction, suppose that $-x\notin K$.
Then $x+y\in K$ for all~$y\in K$,
because
$\{\lambda x+y\colon y\in K,\lambda\geq0\}\supseteq K$
is radially open, convex, doesn't contain~$0$,
and is thus~$K$.

It follows that~$H=\overline{K}\cap -\overline{K}$.
Since~$\overline{K}$ is a cone, $-\overline{K}$ is a cone,
and thus~$H$ is a cone.  But then~$-H=H$ is a cone too,
and thus~$H$ is a linear subspace.
\end{point}
\begin{point}{$V/H$ is one-dimensional}%
Note that~$H\neq V$, because~$K\cap H=\varnothing$
and~$K$ is (assumed to be) non-empty.
So to show that~$V/H$ is one-dimensional,
it suffices to show that
any~$x,y\in V$ 
 are linearly dependent in~$V/H$.
We may assume that~$x\in K$ and~$y\in -K$.
It suffices to find~$s\in [0,1]$ with $0=sx+s^\perp y$.
The trick is to consider the sets
 $S_0 = \{s\in [0,1]\colon sx+s^\perp y \in -K\}$
and~$S_1 = \{s\in [0,1]\colon sx+s^\perp y \in K\}$,
which are open (because~$K$ and~$-K$ are radially open),
non-empty (because $0\in S_0$ and~$1\in S_1$),
and therefore not disjoint
(because~$[0,1]$ is connected).
So there is~$s\in [0,1]$ with $sx+s^\perp y \in H$.\qed
\end{point}
\end{point}
\end{point}
\begin{point}[ultraclosed]{Exercise}%
We will use~\sref{hahn-banach}
to prove that 
an ultrastrongly closed convex subset~$K$ of a 
von Neumann algebra~$\scrA$
is ultraweakly closed as well.

Let us first simplify the problem a bit.
If~$K$ is empty, the result is trivial,
so we may as well assume that $K\neq \varnothing$.
Note that we must show that no net in~$K$ converges ultraweakly
to any element~$a_0\in\scrA$ outside~$K$,
but by considering~$K-a_0$ instead of~$K$,
we see that it suffices to show that
no net in~$K$ converges ultraweakly to~$0$
under the assumption that~$0\notin K$.
To this end we'll find an ultraweakly continuous linear map
$g\colon \scrA\to \C$ and~$\delta>0$ 
with~$\Real{g(k)}\geq \delta$ for all~$k\in K$---if
a net $(k_\alpha)_\alpha$ in~$K$ were to converge ultraweakly to~$0$,
then~$\Real{g(k_\alpha)}$ would converge to~$0$ as well,
which is impossible.
\begin{enumerate}
\item
	Show that 
	there is an np-map~$\omega \colon\scrA\to\C$
	and~$\varepsilon>0$ 
	with $\|k\|_\omega \geq \varepsilon$ for all~$k\in K$.
	(Hint: use that~$K$ is ultrastrongly closed).
\item
	Show that~$B:= \{ b\in \scrA\colon \|b\|_\omega < \varepsilon\}$
	 is convex, radially open, $B\cap K=\varnothing$.

	Show that $B-K$ is convex, radially open, and $0\notin B-K$.
\item
	Use~\sref{hahn-banach} to show that
	 there is an $\R$-linear map $f\colon \scrA\to \R$
	with $f(b)<f(k)$ for all~$b\in B$ and~$k\in K$.
	Show that~$f$
	can be extended to a $\C$-linear map
	$g \colon \scrA\to \C$
	by $g(a)= f(a)-if(ia)$ for all~$a\in\scrA$.
\item
	Show that $\left| f(b)\right| \leq f(k)$ 
	and $\left|g(b)\right|\leq 2f(k)$
	for all~$b\in B$ and $k\in K$.\\
	(Hint: $b\in B\implies -b\in B$.)

	Conclude that~$g$ is ultraweakly continuous
	(using~\sref{luws} and $K\neq \varnothing$).
\item
	It remains to be shown that
	there is $\delta>0$ with $f(k)\equiv \Real{g(k)}\geq \delta$
	for all~$k\in K$.
	Show that there is $b_0\in B$
	with $f(b_0) >0$.
	Conclude that $f(k)\geq f(b_0)>0 $ for all~$k\in K$.
\end{enumerate}
\end{point}
\begin{point}[proto-kaplansky]{Proposition}%
Let~$\scrA$ be a von Neumann algebra,
and let~$f\colon \R\to\R$ be a continuous map 
with $f(t)=\mathcal{O}(t)$,
that is,
there are~$n\in \N$ and~$b\in [0,\infty)$
such that $\left|f(t)\right|\leq b\left|t\right|$
for all~$t\in \R$ with~$\left|t\right| \geq n$.

Then~$a\mapsto f(a),\,\sa{\scrA}\to\sa{\scrA}$ is ultrastrongly continuous
(see \TODO{reference to the continuous functional calculus}).
\begin{point}{Proof}%
(An adaptation of Lemma~44.2 from~\cite{conway2000}.)

Let~$S$ denote the set of all continuous $g\colon \R\to\R$
such that $a\mapsto g(a),\,\sa{\scrA}\to\sa{\scrA}$
is ultrastrongly continuous.
We must show that~$f\in S$.

Let us first make some general observations.
The identity map $t\mapsto t$ is in~$S$,
any constant function is in~$S$,
and~$S$ is closed under addition,
and scalar multiplication.
In particular, any affine transformation ($t\mapsto at+b$)
is in~$S$.
Moreover, we have~$g\circ h\in S$ when $g,h\in S$,
and also~$gh\in S$
provided that~$g$ is bounded.
Finally, $S$ is closed with respect to uniform convergence.

Now,
as $f(t)=f(t)\,\smash{\frac{1}{1+t^2}\,+\, f(t)\,\frac{t^2}{1+t^2}}$
 one can see from the remarks above
that it suffices
to show
that~$t\mapsto f(t)\,\smash{\frac{1}{1+t^2}}$ is in~$S$
--- here we use that $t\mapsto f(t) \,\smash{\frac{t}{1+t^2}}$ is bounded.
In other words,
we may assume without loss of generality,
that~$f$ vanishes at infinity, i.e.~$\lim_{t\to \infty}f(t)=0$.

Suppose for the moment
that there is $e\in S$, $e\neq 0$,
which vanishes at infinity.
Let~$a,b\in \R$.
Then $e_{a,b}\colon \R\to\R, t\mapsto e(at+b)$
--- an affine transformation followed by~$e$ ---
is also in~$S$,
vanishes at infinity,
and can be extended to a continuous real-valued
function on the one-point compactification $\R\cup \{ \infty\}$
of~$\R$
(by defining $e_{a,b}(\infty)=0$).
It is easy to see that the $C^*$-subalgebra
of~$C(\R\cup\{\infty\})$
generated by these extended~$e_{a,b}$'s 
separates the points of~$\R\cup\{\infty\}$,
and is thus~$C(\R\cup\{\infty\})$ itself
by Stone--Weierstra\ss' theorem (see~\sref{stone-weierstrass}).
Since~$f$ vanishes at infinity,
$f$ can be extended to an element of $C(\R\cup\{\infty\})$,
 and can thus be obtained
(by taking real parts if necessary)
from the extended $e_{a,b}$'s and real constants 
via uniform limits, addition and (real scalar)
multiplication. 
Since~$S$ contains the $e_{a,b}$'s and constants
and is closed under these operations (acting on bounded functions),
we see that~$f\in S$.

To complete the proof,
we show that such~$e$ indeed exists.
Let $e,s\colon \R\to\R$ 
be given by $e(t)=ts(t)$ and $s(t)=\smash{\frac{1}{1+t^2}}$.
Clearly~$e$ and~$s$
are continuous
and
vanish at infinity.
To see that~$e$ is ultrastrongly continuous,
let $(b_\alpha)_\alpha$ be a net of self-adjoint elements of~$\scrA$
which converges ultrastrongly to $a\in\sa{\scrA}$,
and let~$\omega\colon \scrA\to \C$
be an npu-map. A simple computation yields
\begin{equation*}
e(b_\alpha)-e(a) \ =\ s(b_\alpha)\,(b_\alpha-b)\,s(a)
\,-\, e(b_\alpha)\,(b_\alpha-b)\,e(a).
\end{equation*}
Since $\|s(b_\alpha)\|\leq 1$,
we have $\|s(b_\alpha)(b_\alpha-a)s(a)\|_\omega 
\leq  \,\|(b_\alpha-b)s(a)\|_\omega
\equiv \|b_\alpha-b\|_{s(a)*\omega}$.
\TODO{Add Lemma for $\|ab\|_\omega\leq \|a\|\|b\|_\omega$
and definition of $a*\omega$.}
Since similarly~$\|e(b_\alpha)\|\leq 1$,
we get
\begin{alignat*}{3}
\|e(b_\alpha)-e(a)\|_\omega
\ \leq\ \|b_\alpha-a\|_{s(a)*\omega}\,+\,\|b_\alpha-a\|_{e(a)*\omega}.
\end{alignat*}
Thus~$e(b_\alpha)$ converges ultrastrongly to~$e(a)$,
and so~$e$ is ultrastrongly continuous.\qed
\end{point}
\end{point}

\begin{point}[mult-us-cont]%
\TODO{Prove that~$a\mapsto \left|a\right|$ is ultrastrongly continuous.}
\end{point}
\begin{point}[kaplansky]{Kaplansky Density Theorem}%
Let~$\scrA$ be a $C^*$-subalgebra
of a von Neumann algebra~$\scrB$.
Let~$b$ be an effect of~$\scrA$ which is the ultrastrong limit
of a net in~$\scrA$.
Then~$b$ is the ultrastrong limit of a net of effects from~$\scrA$.
\begin{point}{Proof}%
Let~$(b_\alpha)_\alpha$
be a net in~$\scrA$ which converges ultrastrongly
to~$b$.
Then the effects  $(0\vee b_\alpha)\wedge 1$
of~$\scrA$ 
converge ultrastrongly to~$(0\vee b)\wedge 1 = b$
by~\TODO{}.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}[bh-us-complete]{Proposition}%
The von Neumann algebra~$\scrB(\scrH)$
of bounded operators on a Hilbert space~$\scrH$
is ultrastrongly complete.
\begin{point}{Proof}
Let~$(T_\alpha)_\alpha$ be an ultrastrongly-Cauchy net
in~$\scrB(\scrH)$
(which must be shown to converge ultrastrongly to
some operator~$T$ in~$\scrB(\scrH)$).

Note that given~$x\in \scrH$,
the net~$(T_\alpha x)_\alpha$ in~$\scrH$
is norm Cauchy,
because $\|(T_\alpha-T_\beta) x\|
= \| T_\alpha-T_\beta \|_{\left<x,(\,\cdot\,)x\right>}$
vanishes for sufficiently large~$\alpha,\beta$,
and so we may define~$Tx :=\lim_\alpha T_\alpha x$,
giving a map~$T\colon \scrH\to\scrH$.

It is clear that~$T$ will be linear,
but the question is whether~$T$ is bounded,
and whether in that 
case~$(T_\alpha)_\alpha$ converges ultrastrongly to~$T$.

Suppose towards a contradiction that~$T$ is not bounded.
Then we can find~$x_1,x_2,\dotsc\in\scrH$
with $\|x_n\|^2\leq 2^{-n}$
and $\|Tx_n\|^2\geq 1$ for all~$n$.
Since~$\omega:=\sum_n \left<x_n,(\,\cdot\,)x_n\right>\colon 
\scrB(\scrH)\to\C$
is an np-map by~\TODO{}, 
it follows that~$\|T_\alpha\|_\omega^2\equiv \sum_{n=1}^\infty 
\|T_\alpha x_n\|^2$
converges to some positive number~$R$.
Since any partial sum $\sum_{n=1}^N \|T_\alpha x_n\|^2
\leq \|T_\alpha\|_\omega^2$
converges to~$\sum_{n=1}^N \|T x_n\|^2\geq N$,
we must conclude that~$R\geq N$,
for all natural numbers~$N$,
which is absurd.
Hence~$T$ is bounded.

It remains to be shown that~$(T_\alpha)_\alpha$
converges ultrastrongly to~$T$.
So let $\omega\colon \scrB(\scrH)\to\C$ be an arbitrary
np-map,
being of the form~$\omega\equiv \sum_n\left<x_n,(\,\cdot\,)x_n\right>$
for some $x_1,x_2,\dotsc\in\scrH$ with $\sum_n \|x_n\|^2 <\infty$.
We must show that~$\|T-T_\alpha\|_\omega
\equiv (\sum_n \|(T-T_\alpha)x_n\|^2)^{\nicefrac{1}{2}}$ 
converges to~$0$ as $\alpha\to 0$.

Let~$\varepsilon>0$ be given,
and pick~$\alpha_0$
such that $\|T_\alpha-T_\beta\|_\omega \leq 
\smash{\frac{1}{2\sqrt{2}}}\,\varepsilon$
for all~$\alpha,\beta\geq \alpha_0$
--- this is possible, because~$(T_\alpha)_\alpha$ is ultrastrongly Cauchy.
We claim that $\|T-T_\alpha\|_\omega \leq \varepsilon$
for any~$\alpha\geq \alpha_0$.
Since for such~$\alpha$
the sum
\begin{equation*}
	\sum_{n=1}^\infty \|(T-T_\alpha)x_n\|^2 
	\ = \ 
	\sum_{n=1}^{N-1} \|(T-T_\alpha)x_n\|^2
	\ +\ 
	\sum_{n=N}^\infty
	\|(T-T_\alpha)x_n\|^2
\end{equation*}
converges (to~$\|T-T_\alpha\|_\omega^2$),
we can find~$N$ such that the second term in the bound above
is below~$\frac{1}{2}\varepsilon^2$.
The first term will also be below~$\frac{1}{2}\varepsilon^2$,
because
\begin{equation*}
	\bigl(\sum_{n=1}^{N-1} \|(T - T_\alpha)x_n\|^2\,\bigr)^{\nicefrac{1}{2}}
	\ \leq\ 
\bigl(\,
\sum_{n=1}^{N-1} \|(T-T_{\beta})x_n\|^2
\,\bigr)^{\nicefrac{1}{2}}
\ +\ 
\bigl(\,
\sum_{n=1}^{N-1} \|(T_\beta-T_\alpha)x_n\|^2
\,\bigr)^{\nicefrac{1}{2}}
\end{equation*}
for any~$\beta$,
and in particular for~$\beta$
large enough that the first term on the right-hand side above
is below~$\smash{\frac{1}{2\sqrt{2}}}\,\varepsilon$.
If we choose $\beta\geq \alpha_0$
the second term will be below~$\smash{\frac{1}{2\sqrt{2}}}\,\varepsilon$ too,
and we get $\|T-T_\alpha\|_\omega^2 \leq \frac{1}{2}\varepsilon^2
+ (\smash{\frac{1}{2\sqrt{2}}\,\varepsilon 
+ \frac{1}{2\sqrt{2}}\,\varepsilon})^2
\equiv \varepsilon^2$ 
all in all.

Hence~$\scrB(\scrH)$ is ultrastrongly complete.\qed
\end{point}

\TODO{Add example that the strong operator topology in not complete.}
\end{point}
\begin{point}[bh-bounded-uw-complete]{Proposition}%
The von Neumann algebra~$\scrB(\scrH)$
of bounded operators on a Hilbert space~$\scrH$
is bounded ultraweakly complete.
\begin{point}{Proof}%
Let~$(T_\alpha)_\alpha$ be a norm-bounded ultraweakly-Cauchy net
in~$\scrB(\scrH)$.
We must show that~$(T_\alpha)_\alpha$
converges ultraweakly
to some bounded operator~$T$ on~$\scrH$.

Note that given $x,y\in\scrH$
the net $(\,\left<x,T_\alpha y\right>\,)_\alpha$
is Cauchy
(because $\left<x,(\,\cdot\,)y\right>
\equiv \frac{1}{4}\sum_{k=0}^3 i^k\left<i^kx+y,(\,\cdot\,)(i^kx+y)\right>$
is ultraweakly continuous),
and so we may define $[x,y] = \lim_\alpha \left<x,T_\alpha y\right>$.
The resulting `form'
$[\,\cdot\,,\,\cdot\,]\colon \scrH\times\scrH\to \C$
(see~\sref{chilb-form})
is bounded, 
because~$\left|[x,y]\right| \leq (\sup_\alpha \|T_\alpha\|)\|x\|\|y\|$
for all~$x,y\in\scrH$
and $\sup_\alpha\|T_\alpha\|<\infty$
since $(T_\alpha)_\alpha$
is norm bounded.
By~\sref{chilb-form-representation},
there is a unique bounded operator~$T$
with $\left<x,Ty\right>=[x,y]$
for all~$x,y\in\scrH$.

By definition of~$T$ it is clear 
that~$\lim_\alpha \left<x,(T-T_\alpha)x\right>=0$
for any~$x\in\scrH$,
but it is not yet clear that~$(T_\alpha)_\alpha$ converges ultraweakly to~$T$.
For this we must show that $\lim_\alpha \omega(T-T_\alpha)=0$
for any np-map~$\omega\colon \scrB(\scrH)\to \C$.
By~\sref{bh-np},
we know that such~$\omega$ is of the form
$\omega=\sum_n \left<x_n,(\,\cdot\,)x_n\right>$
for some $x_1,x_2,\dotsc\in\scrH$ with $\sum_n\|x_n\|^2<\infty$.
Now, given~$N$ and~$\alpha$ we easily obtain the 
following bound.
\begin{equation*}
	|\,\omega(T-T_\alpha)| \ \leq\  
	\sum_{n=1}^{N-1} \left|\left<x_n(T-T_\alpha),x_n\right>\right|
\ +\ \bigl(\,\|T\|+\sup_\alpha\|T_\alpha\|\,\bigr)\,\sum_{n=N}^\infty \|x_n\|^2 
\end{equation*}
Since the first term of this bound converges to~$0$ as~$\alpha\to\infty$,
we get, for all~$N$,
\begin{equation*}
	\limsup_\alpha |\,\omega(T-T_\alpha)| \ \leq\ 
	\bigl(\,\|T\|+\sup_\alpha\|T_\alpha\|\,\bigr)\,\sum_{n=N}^\infty \|x_n\|^2.
\end{equation*}
Since the tail $\sum_{n=N}^\infty\|x_n\|^2$
converges to~$0$ as~$N\to \infty$,
$\limsup_\alpha \left|\omega(T-T_\alpha)\right|=0$.
Hence $\omega(T)=\lim_\alpha \omega(T_\alpha)$,
and so~$(T_\alpha)_\alpha$ converges ultraweakly to~$T$.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}[carrier]{Definition}%
Let $f\colon\scrA\to\scrB$
be an np-map between von Neumann algebras.
The \Define{carrier} of~$f$, denoted by~$\Define{\ceil{f}}$,
is the greatest projection~$p$
of~$\scrA$ with~$f(p^\perp)= 0 $.

\TODO{Add proof that such projection exists.}
\end{point}
\begin{point}[carrier-basic]{Exercise}%
Show that $\ceil{\lambda f} = \ceil{f}$ for~$\lambda>0$,
and~$\ceil{f+g} = \ceil{f}\cup \ceil{g}$.
\end{point}
\begin{point}{Definition}%
We call a projection~$p$ of a von Neumann algebra~$\scrA$
\Define{ultracyclic} if~$p=\ceil{\omega}$
for some np-map $\omega\colon \scrA\to\C$.
\end{point}
\begin{point}[ultracyclic-basic]{Exercise}%
Verify the following facts about ultracyclic projections.
\begin{enumerate}
\item
If~$p$ and~$q$ are ultracyclic projections,
so is~$p\cup q$.
\item
If~$p \leq q$ are projections,
and~$q$ is ultracyclic,
then~$p$ is ultracyclic.

\TODO{add definition of $(\,\cdot\,)_\bullet$}
\item
Every projection is a directed supremum
of ultracyclic projections.\\
(Hint: first show that~$1$ is the supremum of all ultracyclic projections.)
\end{enumerate}
\end{point}
\end{parsec}%
\begin{parsec}%
\begin{point}%
Recall that according to our definition (\sref{von-neumann-subalgebra})
a von Neumann subalgebra~$\scrB$ 
of a von Neumann algebra~$\scrA$
is a $C^*$-subalgebra of~$\scrA$
which is closed under suprema
of bounded directed sets of self-adjoint elements.
We will show that such~$\scrB$ is ultrastrongly closed in~$\scrA$.
\end{point}
\begin{point}[sequence-separation-lemma]{Lemma}%
Let~$\scrB$ be a von Neumann subalgebra
of a von Neumann algebra~$\scrA$.
Let~$\omega_0,\omega_1\colon \scrA\to\C$
be npu-maps,
which are separated
by a net $(b_\alpha)_\alpha$
of effects of~$\scrB$ 
in the sense that~$\lim_\alpha \omega_0(b_\alpha)=0$
and $\lim_\alpha \omega_1(b_\alpha^\perp)=0$.
Then~$\omega_0$ and~$\omega_1$ are separated by a 
projection~$q$ of~$\scrB$ 
in the sense that~$\omega_0(q)= 0 = \omega_1(q^\perp)$.
\begin{point}{Proof}%
(Based on Lemma~45.3 and Theorem~45.6 of~\cite{conway2000}.)

Note that it suffices to find an effect~$a$ in~$\scrB$
with $\omega_0(a) = 0 = \omega_1(a^\perp)$,
because then~$\omega_0(\ceil{a}) = 0 = \omega_1(\ceil{a}^\perp)$
and~$\ceil{a}\in\scrB$ by~\TODO{}.

Note that we may find a subsequence~$(b_n)_n$ of~$(b_\alpha)_\alpha$
such that $\omega_0( b_n ) 
\leq n2^{-n}$
and $\omega_1(b_n^\perp)\leq n^{-1}$
for all~$n$.
For~$n < m$, define
\begin{equation*}
\textstyle
a_{nm}\ = \ (1+\sum_{k=n}^m kb_k)^{-1} \,\sum_{k=n}^m kb_k.
\end{equation*}
Since we have seen in~\sref{}
that the map~$d\mapsto (1+d)^{-1}d$ is order preserving
(on~$\pos{\scrB}$),
we have $0\leq a_{nm}\leq \frac{1}{2}$
and we get the formation
\begin{equation*}
\renewcommand{\labelstyle}{\textstyle}
\xymatrix{
a_{12}\ar@{}|-{\leq}[r] & 
a_{13}\ar@{}|-{\leq}[r] & 
a_{14}\ar@{}|-{\leq}[r]  & 
\dotsb & \ar@{}|-{\leq}[r]& a_1 \\
&
a_{23} \ar@{}|-{\leq}[r] \ar@{}[u]|-{\uleq} &
a_{24} \ar@{}|-{\leq}[r]  \ar@{}[u]|-{\uleq} &
\dotsb &\ar@{}|-{\leq}[r]& a_2  \ar@{}[u]|-{\uleq} \\
&
&
a_{34} \ar@{}|-{\leq}[r]  \ar@{}[u]|-{\uleq} & 
\dotsb & \ar@{}|-{\leq}[r] & a_3  \ar@{}[u]|-{\uleq} 
\\
&&&\ddots&&\vdots \ar@{}[u]|-{\uleq}& \\
&&&&&a\ar@{}[u]|-{\uleq}
},
\end{equation*}
where~$a_n:= \bigvee_{m\geq n} a_{nm}$
and~$a := \bigwedge_n a_n$.
We'll prove that~$\omega_0(a)=0=\omega_1(a^\perp)$.
\begin{point}{$\omega_0(a^\perp)=0$}%
Since~$\omega_0(b_n)\leq n2^n$ 
and $a_{nm}\leq \sum_{k=n}^m k b_k$,
we get~$\omega_0(a_{nm})=\sum_{k=n}^m k\omega_0(b_k) \leq 2^{n-1}$,
and so $\omega_0(a)=\bigwedge_n\bigvee_{m\geq n} \omega_0(a_{nm})
\leq \bigwedge_n 2^{n-1} = 0$.
\end{point}
\begin{point}{$\omega_1(a)=0$}%
Let~$m> n$ be given.
Since~$\sum_{k=n}^m b_k \geq mb_k$
and $d\mapsto (1+d)^{-1}d$
is monotone on~$\pos{\scrB}$
we get~$a_{nm} \geq (1+mb_m)^{-1} mb_m$,
and so~$a_{nm}^\perp \leq (1+mb_m)^{-1}$.

Observe that for a real number $t\in[0,1]$,
we have $tt^\perp \geq 0$,
and so $(1+mt)(1+mt^\perp) = 1+m+m^2tt^\perp \geq 1+m$.
This yields the inequality $(1+mt)^{-1}\leq (1+m)^{-1}(1+mt^\perp)$
for real numbers~$t\in[0,1]$.
The corresponding inequality for effects of a $C^*$-algebra
(obtained via Gelfand's representation theorem, \sref{gelfand})
gives us $\omega_1(a_{nm}^\perp)\leq \omega_1((1+mb_m)^{-1})
\leq (1+m)^{-1}(1+m\omega_1(b_m^\perp))\leq \frac{2}{1+m}$,
where we have used that~$\omega_1(b_m^\perp)\leq \frac{1}{m}$.
Hence~$\omega_1(a_n^\perp)=\bigwedge_{m\geq n} \omega_1(a_{nm}^\perp)
\leq \bigwedge_{m\geq n} \frac{2}{1+m}=0$ for all~$n$,
and so~$\omega_1(a^\perp)=\bigvee_1\omega_1(a_n^\perp)=0$.\qed
\end{point}
\end{point}


\end{point}
\begin{point}[kadisons-lemma]{Lemma}%
Let~$\scrB$ be a von Neumann subalgebra
of a von Neumann algebra~$\scrA$.
Let~$p$ be a projection of~$\scrA$,
which is the ultrastrong limit of a net in~$\scrB$.

For all npu-maps $\omega_0,\omega_1\colon \scrA\to\C$
with~$\omega_0(p)=0= \omega_1(p^\perp)$
there is a projection~$q$ of~$\scrB$
with~$\omega_0(q)=0=\omega_1(q^\perp)$.
\begin{point}{Proof}%
Let~$(b_\alpha)_\alpha$ be a net in~$\scrB$
which converges ultrastrongly to~$p$.
We may assume that all~$b_\alpha$
are effects
by Kaplansky's density theorem (\sref{kaplansky}).
% Since~$pp^\perp=0=p^\perp p$
%and multiplication by a fixed element is ultrastrongly 
%continuous (\sref{mult-us-cont}),
%we see that $(b_\alpha p^\perp)_\alpha$ and $(b_\alpha^\perp p)_\alpha$
%converge ultrastrongly to~$0$.
Note that~$(\omega_0(b_\alpha))_\alpha$ converges to~$\omega_0(p)\equiv 0$,
and $(\omega_1(b^\perp_\alpha))_\alpha$ converges 
to~$\omega_1(p^\perp)\equiv 0$.
Now apply~\sref{sequence-separation-lemma}.\qed
\end{point}
\end{point}
\begin{point}[vnsac]{Theorem}%
A von Neumann subalgebra~$\scrB$ of a von Neumann algebra~$\scrA$
is ultrastrongly and ultraweakly closed.
\begin{point}{Proof}%
It suffices to show that~$\scrB$ is ultrastrongly closed,
because then, by~\sref{ultraclosed}, $\scrB$ will be ultraweakly closed
as well.

Let~$p$ be a projection of~$\scrA$ which is the ultrastrong limit
of a net from~$\scrB$. It suffices to show that~$p\in\scrB$,
because the ultrastrong closure of~$\scrB$
being a von Neumann algebra (\TODO{add ref.})
is generated by its projections (\TODO{add ref.}).
Note that given an np-map $\omega\colon \scrA\to\C$,
the carrier~$\ceil{\omega}$ of~$\omega$
need not be equal to the carrier
of~$\omega$ restricted to~$\scrB$,
which we'll therefore denote by~$\ceil{\omega}_\scrB$;
but we do have $\ceil{\omega}\leq \ceil{\omega}_\scrB$.
Then by~\sref{ultracyclic-basic}
\begin{equation}
\label{ultracyclic-proof}
\textstyle
\bigvee_{\omega_1}
\ceil{\omega_1}_\scrB \ \geq\ 
\bigvee_{\omega_1}
\ceil{\omega_1}\ =\ p\ =\ 
\bigwedge_{\omega_0} \ceil{\omega_0}^\perp
\ \geq\ \bigwedge_{\omega_0} \ceil{\omega_0}_{\scrB}^\perp,
\end{equation}
where~$\omega_0$ ranges over np-maps $\omega_0\colon \scrA\to\C$
with~$\omega_0(p)=0$,
 and $\omega_1$ ranges over
np-maps $\omega_1\colon \scrA\to\C$ with~$\omega_1(p^\perp)=0$.
Since for such~$\omega_0$ and~$\omega_1$
there is 
by~\sref{kadisons-lemma}
a projection~$q$ in~$\scrB$
with $\omega_0(q)=0=\omega_1(q^\perp)$,
we get 
$\ceil{\omega_1}_\scrB \geq q \geq 
\ceil{\omega_0}_\scrB^\perp$,
and so~$\bigwedge_{\omega_0} \ceil{\omega_0}_\scrB^\perp 
\geq \bigvee_{\omega_1} \ceil{\omega_1}_\scrB$.
It follows that the inequalities in~\eqref{ultracyclic-proof}
are in fact equalities,
and so~$p=\bigvee_{\omega_1}\ceil{\omega_1}_\scrB \in \scrB$.\qed
\end{point}
\end{point}
\begin{point}[vn-complete]{Theorem}%
A von Neumann algebra~$\scrA$ is ultrastrongly complete
and bounded ultraweakly complete.
\begin{point}{Proof}%
Recall that~$\scrA$
is nmiu-isomorphic
to a von Neumann algebra~$\scrR$ of operators on some Hilbert space~$\scrH$
by~\sref{ngns}.
Since~$\scrB(\scrH)$ is ultrastrongly complete
(\sref{bh-us-complete}),
and the ultrastrong topology on~$\scrB(\scrH)$
coincides on~$\scrR$ with the ultrastrong topology of~$\scrR$
(by~\sref{us-permanence}),
and~$\scrR$ is 
 ultrastrongly closed in~$\scrB(\scrH)$
(see~\sref{vnsac}),
we see that $\scrR$ (and therefore~$\scrA$) is 
ultrastrongly complete.

Since similarly~$\scrB(\scrH)$
is bounded ultraweakly complete (\sref{bh-bounded-uw-complete}),
the ultraweak topology on~$\scrB(\scrH)$
coincides on~$\scrR$ with the ultraweak topology on~$\scrR$
(\sref{uw-permanence}),
and~$\scrR$ is ultraweakly closed
in~$\scrB(\scrH)$
(by~\sref{vnsac}),
we see that~$\scrR$ is bounded ultraweakly complete.\qed
\end{point}
\end{point}
\begin{point}[vn-ball-compact]{Theorem}%
The ball $(\scrA)_1$
of a von Neumann algebra~$\scrA$ is ultraweakly compact.
\begin{point}{Proof}%
Writing~$\Omega$ for
the set of npu-maps $\omega\colon \scrA\to\C$,
the map~$\kappa\colon \scrA\to \C^\Omega$
given by~$\kappa(a)=(\omega(a))_\omega$ for all~$a\in\scrA$
is clearly a linear homeomorphism from~$\scrA$ with the  ultraweak topology 
onto~$\kappa(\scrA)\,\subseteq \C^\Omega$ endowed
with the product topology.
Since~$\kappa$ restricts
to a isomorphism of uniform spaces
$(\scrA)_1\to \kappa(\,(\scrA)_1\,)$,
and $(\scrA)_1$ is ultraweakly complete 
(being a norm-bounded ultraweakly-closed
subset of the bounded ultraweakly complete space~$\scrA$,
see~\sref{vn-complete}),
we see that $\kappa(\,(\scrA)_1\,)$
is complete,
and thus closed in~$\C^\Omega$.
Now note that~$\kappa(\,(\scrA)_1\,)$ is a closed subset 
of the (by Tychonoff's theorem) compact
space~$((\C)_1)^\Omega$, 
because $\left|\omega(a)\right|\leq 1$ for all~$a\in(\scrA)_1$
and $\omega\in\Omega$.
But then~$\kappa(\,(\scrA)_1\,)$,
being a closed subset of a compact Hausdorff space,
is compact,
and so $(\scrA)_1$ (being isomorphic to it) is compact too.\qed
\end{point}
\end{point}
\end{parsec}
\section{Division}
\begin{parsec}%
\begin{point}{Definition}%
Let~$a$ be an element of a von Neumann algebra~$\scrA$.
We'll say that~$a$ is \Define{pseudoinvertible}
if it has a \Define{pseudoinverse},
that is,
an element~$t$ of~$\scrA$
with 
$ta=\ceill{a}=\ceilr{t}$
and $at=\ceill{t}=\ceilr{a}$.
When such~$t$ exists,
it is unique (by~\sref{mult-cancellation}),
and we'll denote it by~\Define{$a^{\sim 1}$}.
If~$a^{\sim1}=a^*$,
we say that~$a$ is a \Define{partial isometry}
(see~\sref{partial-isometry-equivalents}).
\end{point}
\begin{point}[pseudoinverse-equivalents]{Lemma}%
For elements $a,t$ of a von Neumann algebra
the following are equivalent.
\begin{enumerate}
\item
\label{pseudoinverse-1}
$ta$ is a projection, and~$\ceill{t}=\ceilr{a}$.
\item
\label{pseudoinverse-2}
$ata=a$, and $\ceill{t}\leq \ceilr{a}$ and~$\ceilr{t}\leq \ceill{a}$.
\item
\label{pseudoinverse-3}
$at$ is a projection, and $\ceill{a}=\ceilr{t}$.
\item
\label{pseudoinverse-4}
$tat=t$, and~$\ceill{a}\leq \ceilr{t}$ and~$\ceilr{a}\leq \ceill{t}$.
\item
\label{pseudoinverse-5}
$t$ is a pseudoinverse of~$a$.
\end{enumerate}
\begin{point}{Proof}%
We make two loops.
\grayed{(\ref{pseudoinverse-1}$\Longrightarrow$\ref{pseudoinverse-2})}\ 
We have $\ceill{t}\leq \ceilr{a}$ by assumption,
and $\ceilr{t}=\ceilr{t\ceill{t}}
=\ceilr{t\ceilr{a}}
=\ceilr{ta}=ta=\ceill{ta}\leq\ceill{a}$.
Further, $ata=a$
by~\sref{mult-cancellation},
because $tata=ta$ (since~$ta$ is a projection)
and~$\ceilr{ata}\leq \ceilr{a}\leq\ceill{t}$.
\grayed{(\ref{pseudoinverse-3}$\Longrightarrow$\ref{pseudoinverse-4})} 
follows along the same lines.
\grayed{(\ref{pseudoinverse-2}$
	\Longrightarrow$%
\ref{pseudoinverse-5})}\ 
We have $ta=\ceill{a}$ by~\sref{mult-cancellation},
because $ata=a=a\ceill{a}$
and $\ceill{at}\leq\ceill{t}\leq\ceilr{a}$.
Also, $at=\ceilr{a}$,
(because~$ata=a=\ceilr{a}a$,
and~$\ceill{at}\leq\ceill{t}\leq \ceilr{a}$).
Further, $\ceill{t}=\ceilr{a}$,
because $\ceill{a}=ta=\ceilr{ta}\leq \ceilr{t}\leq \ceill{a}$,
and, similarly, $\ceill{a}=\ceilr{t}$.
\grayed{(\ref{pseudoinverse-4}$
	\Longrightarrow$%
\ref{pseudoinverse-5})}
is proven by the same principles, and
\grayed{(\ref{pseudoinverse-5}$
	\Longrightarrow$%
\ref{pseudoinverse-1},\ref{pseudoinverse-3})}
is rather obvious.\qed
\end{point}
\end{point}
\begin{point}[partial-isometry-equivalents]{Exercise}%
Show that an element~$u$ of a von Neumann algebra
is a partial isometry iff
$u^*u$ is a projection
iff $uu^*u=u$
iff $uu^*$ is a projection
iff $u^*uu^*=u^*$
iff~$u^*$ is the pseudoinverse of~$u$.
(Hint: use~\sref{pseudoinverse-equivalents},
or give a direct proof.)
\end{point}
\begin{point}[pseudoinverse-basic]{Exercise}%
Let~$a$ and~$b$ be a elements of a von Neumann algebra~$\scrA$.
\begin{enumerate}
\item
Show that~$a$ is pseudoinvertible
iff~$a^*$ is pseudoinvertible,
and, in that case, $(a^*)^{\sim1}=(a^{\sim1})^*$.
\item
Assuming that~$a$ and~$b$ are pseudoinvertible,
and~$\ceilr{b}=\ceill{a}$,
show that $ab$ is pseudoinvertible,
and~$(ab)^{\sim1}=b^{\sim1}a^{\sim1}$.


\item
Show that~$a$ is pseudoinvertible
iff~$a^*a$ is pseudoinvertible,
and, in that case, $a^{\sim 1} = (a^*a)^{\sim1}a$
and~$(a^*a)^{\sim1}=a^{\sim1}(a^{\sim1})^*$.
\end{enumerate}
\end{point}
\begin{point}{Exercise}%
Let~$a$ be a positive element of a von Neumann algebra~$\scrA$.
\begin{enumerate}
\item
Show that~$a$ is pseudoinvertible iff~$a$
is invertible in~$\ceil{a}\scrA\ceil{a}$
iff $at=\ceil{a}$ for some~$t\in\scrA_+$.
\item
Show that~$a$ is pseudoinvertible iff
there is~$\lambda>0$ with $\lambda \ceil{a}\leq a$.
\item
Assume that~$a$ is pseudoinvertible.

Show that~$\ceil{a^{\sim1}}=\ceil{a}$.

Show that if~$b\in \scrA$ commutes with~$a$,
then $b$ commutes with~$a^{\sim 1}$.

(In other words, $a^{\sim1}\in\{a\}^{\square\square}$.)
\item
Show that~$c^{\sim1}\leq b^{\sim1}$
when~$b\leq c$ are pseudoinvertible positive \emph{commuting}
elements of~$\scrA$.
(The statement is still true without
the requirement that~$b$ and~$c$ commute,
but also much harder to prove.)


\item
Show that $(0,0,1,\frac{1}{2}, \frac{1}{3},\dotsc)$
is not pseudoinvertible in~$\ell_\infty$.
\end{enumerate}
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}{Remark}%
Note that the obvious candidate
for the pseudoinverse of~$(0,0,1,\frac{1}{2},\frac{1}{3},\dotsc)$
being~$(0,0,1,2,3,\dotsc)$
is not bounded,
and therefore not an element of~$\ell^\infty$.
We can nevertheless approximate~$(0,0,1,2,3,\dotsc)$
by the elements~$(0,0,1,0,0,\dotsc)$,
$(0,0,1,2,0,\dotsc)$, \dots of~$\ell^\infty$
forming what we will call ``approximate pseudoinverse'' for 
$(0,0,1,\frac{1}{2},\frac{1}{3},\dotsc)$.
That this can also be done for an arbitrary element
of a von Neumann algebra
is what we'll see next.
\end{point}
\begin{point}[approximate-pseudoinverse-def]{Definition}%
An \Define{approximate pseudoinverse}
of an element~$a$ a von Neumann algebra~$\scrA$
is a sequence~$t_1,t_2,\dotsc$
of elements of~$\scrA$
such that~$t_1a,\ t_2a,\ \dotsc, at_1,\ at_2,\ \dotsc$
are projections with $\sum_n t_na = \ceill{a}=\sum_n \ceilr{t_n}$
and~$\sum_n at_n =\ceilr{a}=\sum_n \ceill{t_n}$.
\end{point}
\begin{point}[approximate-pseudoinverse-reduction]{Exercise}%
Let~$b$ be an element of a von Neumann algebra~$\scrA$,
and let~$t_1,t_2,\dotsc$
be an approximate pseudoinverse
of~$b^*b$.
Show that $t_1b^*,\ t_2b^*,\ \dotsc$
is an approximate pseudoinverse of~$b$.
\end{point}
\begin{point}[approximate-pseudoinverse]{Proposition}%
Every element~$a$ of a von Neumann algebra~$\scrA$
has an approximate pseudoinverse.
\begin{point}{Proof}%
By~\sref{approximate-pseudoinverse-reduction},
it suffices to consider the case that~$a$ is positive.
When~$a=0$ the sequence~$0,0,0,\dotsc$
clearly yields an approximate pseudoinverse for~$a$,
so let us disregard this case,
and assume that~$a$ is positive and non-zero.

Note that $a-1 \,\leq\, a-\frac{1}{2}\,\leq\, a - \frac{1}{3}\,\leq\, \dotsb$
converges in the norm to~$a\equiv a_+$,
and so does $(a-1)_+\,\leq\,(a-\frac{1}{2})_+\,\leq\,\dotsc$,
which converges also ultraweakly to~$\bigvee_n(a-\frac{1}{n})$,
so that~$a=\bigvee_n (a-\frac{1}{n})_+$,
and thus $\ceil{a}=\bigcup_n \ceil{(a-\frac{1}{n})_+}$
by~\sref{ceil-supremum}.

Writing $q_n=
\ceil{\smash{(a-\frac{1}{n})_+}}$
--- and picturing it as the places where~$a\geq \frac{1}{n}$ ---
we have $(a-\frac{1}{n})q_n = (a-\frac{1}{n})_+\geq 0$
(because~$b\ceil{b_+}=b_+$
for a positive element~$b$ of a von Neumann algebra,
by~\sref{ceil-pos-part}),
and so $\frac{1}{n}q_n \leq  aq_n$ for all~$n>0$.

Writing $e_{n}=q_{n+1}-q_n$
for all~$n$ (taking~$q_0:=0$)
--- and thinking of it as the places
where $\frac{1}{n+1}\leq a\leq \frac{1}{n}$ --- 
we get a sequence of (orthogonal) projections
$e_1,e_2,\dotsc$ in~$\{a\}^{\square\square}$
with $\sum_n e_n = \ceil{a}$.
By an easy computation
involving the facts that $\frac{1}{n+1}\leq \frac{1}{n}$
and~$aq_n\leq aq_{n+1}$,
we get $\frac{1}{n+1}e_n \leq ae_n \leq  \frac{1}{n}e_n$.

Now, note that~$\ceil{ae_n}=\ceil{e_n}$ for any~$n$.
Indeed, on the one hand~$ae_n=e_nae_n\leq \|a\|e_n$
(as~$e_n\in\{a\}^{\square\square}$)
and so~$\ceil{ae_n}\leq \ceil{\|a\|e_n}=e_n$
(using here that $\|a\|\neq 0$),
while on the other hand, $\frac{1}{n+1}e_n\leq ae_n$
gives $e_n\equiv \ceil{\smash{\frac{1}{n+1}e_n}}\leq \ceil{ae_n}$.
In particular, $\frac{1}{n+1}\ceil{ae_n}=\frac{1}{n+1}e_n \leq ae_n$,
so that~$ae_n$ is pseudoinvertible (by~\sref{pseudoinverse-basic}).

Writing~$t_n := (ae_n)^{\sim1}$,
we have~$\ceil{t_n}=e_n$
(since~$\ceil{ae_n}=e_n)$.
Then $t_na=t_n\ceil{t_n}a=t_ne_na=\ceil{ae_n}=e_n$,
and similarly, $at_n = e_n$,
so that $\sum_n at_n = \sum_n t_n a 
=\sum_n e_n =\ceil{a}
= \sum_n \ceil{t_n}$,
making $t_1,t_2,\dotsc$ an approximate pseudoinverse of~$a$.\qed
\end{point}
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}{Definition}%
Let~$b$ be an element of a von Neumann algebra~$\scrA$.
Given an element~$a$ of~$\scrA b$ 
we denote by~\Define{$a/b$} 
the (by~\sref{mult-cancellation}) unique
element of~$\scrA\!\ceilr{b}$
with~$a=(a/b)\, b$,
and, dually,
given an element~$a$ of~$b\scrA$ 
we denote by~\Define{$b\backslash a$} 
the unique
element of~$\ceill{b}\!\scrA$
with~$a=b\,(b\backslash a)$.
\end{point}
\begin{point}{Exercise}%
Let~$a$ and~$b$
be elements of a von Neumann algebra~$\scrA$.
\begin{enumerate}
\item
Show that $c/b$ is an element of~$\ceilr{c}\!\scrA\!\ceilr{b}$
for every element~$c$ of~$b\scrA$.
\item
Show that $(ab)/b = a\ceilr{b}$
and~$b\backslash (ba)=\ceill{b}a$.
\item
Let~$c$ be an element of $a\scrA b$.
Show that
$a \backslash c \,\in\, \scrA b$,
and
$c/b\,\in\,a\scrA$, and
\begin{equation*}
(a\backslash c)/b\ =\  a\backslash(c/b)
\quad \text{ --- which we'll therefore denote by}\  \Define{a\backslash c/b}.
\end{equation*}
Show that~$a\backslash c/b$
is the unique element of~$\ceill{a}\scrA\ceilr{b}$
with~$c=a\,(a\backslash c / b)\, b$. 
\item
Let~$c$ be an element of~$\scrA b$.
Show that~$c^* \,\in\, b^* \scrA$
and $b^*\backslash c^* = (c/b)^*$.
\end{enumerate}
\end{point}
\begin{point}[proto-douglas]{Lemma}%
Given elements $a$ and~$b$ of a von Neumann algebra~$\scrA$
with~$a^*a \leq b^*b$
we have $a\,\in\, \scrA b$.
Moreover,
given an approximate pseudoinverse $t_1,t_2,\dotsc$
of~$b$,
the series $\sum_nat_n$ converges ultrastrongly to~$a/b$,
and uniformly so in~$a$.
\begin{point}{Proof}%
To show that~$\sum_{n=0}^N at_n$
converges ultrastrongly as~$N\to \infty$
it suffices
to show that~$(\,\sum_{n=0}^N at_n\,)_N$
is ultrastrongly Cauchy
(because~$\scrA$ is ultrastrongly complete, by~\sref{vn-complete}).
To this end, note that
\begin{alignat*}{3}
\textstyle 
(\, \sum_{n=M}^N at_n\,)^*\ \,\sum_{n=M}^N\,at_n
\ &= \textstyle\ (\sum_{n=M}^Nt_n) \,a^*a\, (\sum_{n=M}^N t_n)
\\
\ &\leq\ \textstyle 
 (\sum_{n=M}^N t_n) \,b^*b\, (\sum_{n=M}^Nt_n)
\\
\ &\leq\ \textstyle 
\sum_{n,m=M}^N
t_nb^*bt_m 
\\
\ &=\ \textstyle 
\sum_{m=M}^N
bt_m,
\end{alignat*}
where we've used that
$bt_1,\ bt_2,\ \dotsc$
are orthogonal projections
--- but then the series~$\sum_{n=0}^\infty bt_m$
converges ultraweakly by~\sref{sum-of-orthogonal-projections}.
This, coupled with the
inequality above,
gives us that~$\sum_{n=0}^N at_n$
is ultrastrongly Cauchy,
and therefore converges ultrastrongly --- 
and even uniformly so in~$a$,
because~``$a$'' does not appear in
the expression
``$\sum_{m=M}^N bt_m$'' that gave the bound.

Define~$c:=\sum_{n=0}^\infty at_n$.
Since~$at_n=\ceilr{a}at_n\ceilr{b}$
for all~$n$ (using that~$\ceill{t_n}\leq \ceilr{b}$),
we also have~$\ceilr{a}c\ceilr{b}=c$.
Further,
since~$a^*a \leq b^*b$,
we have $\ceill{a}\leq \ceill{b}$,
and so~$a=a\ceill{b} = a\sum_n t_n b = \sum_n at_n b
= cb$, giving $c=a/b$.\qed
\end{point}
\end{point}
\begin{point}[douglas]{Corollary}%
(A generalization of ``Douglas'~Lemma'' from~\cite{douglas}.)\\
For elements~$a$ and~$b$ of a von Neumann algebra~$\scrA$,
the following are equivalent.
\begin{enumerate}
\item
$a^*a\leq \lambda \, b^*b$
for some~$\lambda \geq 0$;
\item
$a=cb$ for some~$c\in\scrA$.
\end{enumerate}
\end{point}
\begin{point}{Propisition (Polar Decomposition)}%
Any element~$a$ of a von Neumann
algebra~$\scrA$
can be uniquely written as~$a=\Define{[a]}\sqrt{a^*a}$,
where~$[a]$
is an element of~$\scrA\!\ceill{a}$.
Moreover,
\begin{enumerate}
\item
$[a]$ is partial isometry
with $[a]^*[a] = \ceil{a^*a} \equiv \ceill{a}$
and $[a][a]^*=\ceil{aa^*} \equiv \ceilr{a}$,
\item
and $[a^*]=[a]^*$, so that~$\sqrt{aa^*}[a]=a=[a]\sqrt{a^*a}$.
\end{enumerate}
\begin{point}{Proof}%
Since $a^*a\leq \sqrt{a^*a}\sqrt{a^*a}$,
the existance and uniqueness
an element~$[a]$ of~$\scrA$
with $a=[a]\sqrt{a^*a}$
and~$\ceill{\,[a]\,}\leq
\ceill{a}\equiv \ceilr{\,\sqrt{a^*a}\,}$
is provided by~\sref{douglas},
and we get~$\ceilr{\,[a]\,}\leq \ceilr{a}$
to boot!
Note that~$[a]^*[a]=\ceil{a^*a}$,
by~\sref{mult-cancellation},
because 
\begin{equation*}
	\sqrt{a^*a}\,[a]^*[a]\,\sqrt{a^*a}
\ =\ 
a^*a
\ =\ 
\sqrt{a^*a}\,\ceil{a^*a}\,\sqrt{a^*a},
\end{equation*}
and $\ceil{\,[a]^*[a]\,}\leq \ceill{a}=\ceil{\,\sqrt{a^*a}\,}$.
In particular, $[a]$ is a partial isometry
(by~\sref{partial-isometry-equivalents}).

Let us prove that $[a][a]^*=\ceilr{a}$.
Note that~$[a][a]^*$
is a projection (because $[a]$ is a partial isometry, 
by~\sref{partial-isometry-equivalents}).
We already know that $[a][a]^* = \ceilr{\,[a]\,}\leq \ceilr{a}$.
Concerning the other direction,
$aa^*=[a]\sqrt{a^*a}\,\sqrt{a^*a}[a]^*=[a]\,a^*a\,[a]^*$,
so that
$\ceilr{a}=\ceil{aa^*}
= \ceil{\,[a]a^*a[a]^*\,}
\leq \ceil{\,\|a\|^2[a][a]^*\,}
\leq [a][a]^*$.

To prove that~$a=\sqrt{aa^*}[a]$,
we'll first show that~$\sqrt{aa^*} = [a] \sqrt{a^*a} [a]^*$.
Indeed, since~$[a]^*[a]=\ceil{\,\sqrt{a^*a}\,}$,
we have
$[a]\sqrt{a^*a}[a]^*[a]\sqrt{a^*a}[a]^*
= [a] \sqrt{a^*a} \,\sqrt{a^*a} [a]^* 
= aa^*$ --- now take the square root.
It follows that~$\sqrt{aa^*}[a]
= [a]\sqrt{a^*a}[a]^*[a]
= [a]\sqrt{a^*a}=a$;
and, upon applying~$(\,\cdot\,)^*$,
we see that
$a^*=[a]^*\sqrt{aa^*}$,
and thus~$[a^*]=[a]^*$,
by uniqueness of~$[a^*]$,
because $\ceill{\,[a]^*\,}=\ceilr{\,[a]\,}=  \ceilr{a}
=\ceill{a^*}$.\qed
\end{point}
\end{point}
\begin{point}[sequential-quotient]{Exercise}%
Show that for positive elements~$a$ and~$b$ of a von Neumann
algebra~$\scrA$,
the following are equivalent.
\begin{enumerate}
\item
$a\leq \lambda b$ for some~$\lambda\geq 0$;
\item
$a=\sqrt{b}c\sqrt{b}$
for some positive~$c\in\scrA$,
\end{enumerate}
and, 
in that case, there is a unique~$c\in\scrA_+$
with $a=\sqrt{b}c\sqrt{b}$
and~$\ceil{c}\leq \ceil{b}$,
and if~$t_1,t_2,\dotsc$
is an approximate pseudoinverse of~$\sqrt{b}$,
then~$\sum_{m,n} t_m a t_n$
converges ultraweakly to this~$c$.
\end{point}
\end{parsec}

\section{Normal functionals}
\subsection{Ultraweak boundedness}
\begin{parsec}%
\begin{point}%
To get a better handle on the normal positive functionals
on a von Neumann algebra,
we first analyse the the not-necessarily-positive normal functionals
in greater detail.
\end{point}
\begin{point}{Definition}%
Given a functional $f\colon \scrA\to \C$
on a $C^*$-algerbra~$\scrA$,
we define
\begin{enumerate}
\item
$\Define{\Real{f}}\colon \scrA\to\C$,
the \Define{real part} of~$f$,
by~$\Real{f}(a)=\Real{f(\Real{a})}
+i\Real{f(\Imag{a})}$, and
\item
$\Define{\Imag{f}}\colon \scrA\to\C$,
the \Define{imaginary part} of~$f$,
by~$\Imag{f}(a)=\Imag{f(\Real{a})}
+i\Imag{f(\Imag{a})}$.
\end{enumerate}
\end{point}
\begin{point}{Exercise}%
Show that,
given a functional~$f\colon \scrA\to \C$
on a $C^*$-algebra~$\scrA$,
\begin{enumerate}
\item
	$f=\Real{f}+i\Imag{f}$, and 
	$\Real{f}$ and $\Imag{f}$
	are i-maps (linear and involution preserving);
\item
	if $f=g+ih$ for some i-maps
	$g,h\colon \scrA\to\C$,
	then $\Real{f}=g$ and $\Imag{f}=h$.
\end{enumerate}
\end{point}
\begin{point}[positive-functional-criterion]{Lemma}%
A linear map $f\colon \scrA\to \C$
on a $C^*$-algebra~$\scrA$
is positive iff $\|f\|\leq f(1)$.
\begin{point}{Proof}%
(Based on Theorem 4.3.2 of~\cite{kr}.)

Since the statement is clearly true for the zero functional,
we may assume that~$f\neq 0$, that is, $\|f\|\neq 0$.
The resulting
problem is  easily reduced
to the case that~$f$ is unital
(by replacing~$f$ by~$\|f\|^{-1}f $), so we'll assume that $f(1)=1$.

\begin{point}{$f$ positive $\implies$ $\|f\|\leq 1$}%
This follows
immediately from~\sref{cp-russo-dye} and~\sref{cp-commutative},
but here's a concrete proof:
Let~$a\in \scrA$ be given.
Pick~$\lambda\in \C$ with $\left|\lambda\right|=1$
and~$\lambda f(a)\geq 0$.
Then $\left|f(a)\right|=f(\lambda a) 
= \Real{f(\lambda a)}
= f(\Real{(\lambda a)})
\leq f(\|a\|)=\|a\|$,
because $\Real{(\lambda a)}
\leq \|\Real{(\lambda a)}\|
\leq \|\lambda a\|=\|a\|$,
and $f$ is positive.
Hence~$\|f\|\leq 1$.
\end{point}
\begin{point}{$\|f\|\leq 1$ $\implies$ $f$ is positive}%
Let~$a\in [0,1]_\scrA$ be given.
To prove that~$f$ is positive, it suffices to show that $f(a)\geq 0$.
Since $(\Real{f(a)})^\perp
=\Real{(f(a)^\perp)}
\leq \left|f(a)^\perp \right|
=\left|f(a^\perp)\right|\leq 1$,
and therefore $\Real{f(a)}\geq 0$,
we just need to show that~$\Imag{f(a)}=0$.

The trick is to consider $b_n := (a - \Real{f(a)})+in\Imag{f(a)}$.
Indeed, since $(n+1)^2(\Imag{f(a)})^2
= \|f(b_n)\|^2 \leq \|b_n\|^2 = 
\|b_n^*b_n\| \leq \|a-\Real{f(a)}\|^2 + n^2(\Imag{f(a)})^2$,
one sees that $(2n+1)(\Imag{f(a)})^2\leq \|a-\Real{f(a)}\|^2$
for all~$n$,
which is impossible unless~$(\Imag{f(a)})^2=0$,
that is, $\Imag{f(a)}=0$.\qed
\end{point}
\end{point}
\end{point}
\begin{point}[vn-ball-extreme-point]{Lemma}%
An extreme point~$u$ of the unit ball~$(\scrA)_1$
of a $C^*$-algebra~$\scrA$
is a partial isometry with $(uu^*)^\perp\scrA(u^*u)^\perp = \{0\}$.
\begin{point}{Remark}%
The converse (viz.~every such partial isometry
is extreme in~$(\scrA)_1$)
also holds, but we won't need it.
\end{point}
\begin{point}{Proof}%
(Based on Theorem~7.3.1 of~\cite{kr}.)

To show~$u$ is a partial isometry
it suffices to prove that~$u^*u$ is a projection.
Suppose towards a contradiction that~$u^*u$ is not a projection.
Then $u^*u$,
represented
as continuous function (on~$\spec(a)$, see~\TODO{}),
takes neither the value~$0$ nor~$1$ on a neighbourhood
of some point,
and so by considering a
positive continuous function,
which is sufficiently small but non-zero on this neighbourhood
and zero elsewhere, 
we can find a non-zero element~$a$ 
of the (commutative) $C^*$-subalgebra generated by~$u^*u$
with $0\leq a\leq u^*u$
and $\|u^*u (1\pm a)^2\|\leq 1$,
so that~$\|u(1\pm a)\|\leq 1$.
Since~$u$ is extreme in~$(\scrA)_1$,
and~$u=\frac{1}{2}u(1+a)\,+\,\frac{1}{2}u(1-a)$,
we get~$ua=0$,
and so $0\leq a^2\leq \sqrt{a}u^*u\sqrt{a}=u^*ua=0$,
which contradicts $a\neq 0$.

Let~$a\in (uu^*)^\perp \scrA (u^*u)^\perp$
be given; we must show that $a=0$.
Assume (without loss of generality)
that~$\|a\|\leq 1$.
We'll show that $\|u\pm a\|\leq 1$,
because,
since~$u$ is extreme in~$(\scrA)_1$,
$u\equiv \frac{1}{2}(u+a)+(u-a)$
implies that~$u=u+a$, and so $a=0$.
Note that $a^*a \leq (u^*u)^\perp$ (because $a(u^*u)^\perp=a$)
and $u^*a = 0$ (because $(uu^*)^\perp a=a$).
Thus $(u\pm a)^*(u\pm a)
=u^*u \pm u^* a \pm a^* u + a^*a
= u^*u + a^*a \leq u^*u + (u^*u)^\perp = 1$,
so $\|u\pm a\|\leq 1$. \qed
\end{point}
\end{point}
\begin{point}[polar-decomposition-of-functional]%
	{Theorem (Polar decomposition of functionals)}%
Every functional $f\colon \scrA\to \C$ on a von Neumann algebra~$\scrA$
which is ultraweakly continuous on
the unit ball~$(\scrA)_1$
is of the form $f\equiv f(uu^*(\,\cdot\,)) = f((\,\cdot\,)u^*u)$
for some partial isometry~$u$ on~$\scrA$
such that $f(u(\,\cdot\,))$
and $f((\,\cdot\,)u)\colon \scrA\to\C$
are positive.
\begin{point}{Proof}%
(Based on Theorem~7.3.2 of~\cite{kr}.) 
\begin{point}%
We'll first show that~$f$ takes the value~$\|f\|$
on some extreme point~$u$ of~$(\scrA)_1$.
To begin, since~$(\scrA)_1$ is ultraweakly compact (\sref{vn-ball-compact}),
and~$a\mapsto \left|f(a)\right|,\,(\scrA)_1\to\C$ 
is ultraweakly continuous,
the subset $\{\,\left|f(a)\right|\colon\,a\in(\scrA)_1\,\}$
of~$\R$ is compact,
and therefore has a largest element, 
which must be~$\|f\|$.
Thus the convex
set~$F:=\{\,a\in(\scrA)_1\colon\, f(a)=\|f\|\,\}$
is non-empty.
Since~$F$ is ultraweakly compact (being an ultraweakly closed
subset of the ultraweakly compact~$(\scrA)_1$),
$F$ has at least one extreme point
by~\TODO{Krein--Milman}, say~$u$.
Note that~$F$ is a face of~$(\scrA)_1$:
if~$\frac{1}{2}a+\frac{1}{2}b\in F$ for some~$a,b\in(\scrA)_1$,
then $\frac{1}{2}f(a)+\frac{1}{2}f(b) = \|f\|$,
and $\left|f(a)\right|,\,\left|f(b)\right|\leq \|f\|$,
so~$\left|f(a)\right|=\left|f(b)\right|=\|f\|$
(since~$\|f\|$ is extreme in $(\C)_{\|f\|}$)
and thus~$a,b\in F$.
It follows that~$u$ is not only extreme in~$F$, but also in~$(\scrA)_1$,
so that~$u$ is an partial isometry with $(uu^*)^\perp\scrA(u^*u)^\perp=\{0\}$
by~\sref{vn-ball-extreme-point}.

Note that $f(u(\,\cdot\,))$
is positive by~\sref{positive-functional-criterion}, because
$\|f(u(\,\cdot\,))\||\leq\|f\|\|u\|\leq\|f\|=f(u)=f(u(1))$,
and by a similar argument~$f((\,\cdot\,)u)$
is positive.

Let~$a\in\scrA$ be given.
It remains to be shown that $f=f(uu^*a)=f(au^*u)$.
First note that  $u(u^*u)^\perp = 0$ (since~$u$ is an isometry)
and so $f(u(u^*u)^\perp)=0$,
that is,  $u^*u\geq \ceil{f(u(\,\cdot\,))}$.
This entails that $f(ubu^*u)=f(ub)$ for all~$b\in\scrA$
by~\TODO{}, and in particular $f(uu^*au^*u)=f(uu^*a)$.

Now, since~$(uu^*)^\perp\scrA(u^*u)^\perp = \{0\}$,
we have $uu^* a u^*u + a = uu^*a + au^*u$,
and thus $f(a)+f(uu^*a)=f(a)+f(uu^*au^*u)=f(uu^*a)+f(au^*u)$,
which yields $f(a)=f(au^*u)$.
By a similar reasoning we get $f(uu^*a)=f(a)$.\qed
\end{point}
\end{point}
\end{point}
\begin{point}[uwcont-on-ball]{Corollary}%
A functional $f\colon \scrA\to\C$
on a von Neumann algebra~$\scrA$
is normal
when it is ultraweakly continuous
on the unit ball~$(\scrA)_1$.
\begin{point}{Proof}%
By~\sref{polar-decomposition-of-functional}
there is a partial isometry~$u$
such that $f(uu^*(\,\cdot\,))=f$
and~$f(u(\,\cdot\,))$ is positive.
Recall \TODO{} that such a positive functional~$f(u(\,\cdot\,))$
is normal when it is ultraweakly continuous
on~$[0,1]_{\scrA}$;
which it is, 
because $a\mapsto ua$ is ultraweakly continuous (see \sref{mult-uws-cont}),
maps~$[0,1]_{\scrA}$ into~$(\scrA)_1$,
and $f$ is ultraweakly continuous on~$(\scrA)_1$.
But then~$f\equiv f(uu^*(\,\cdot\,))$
being the composition of the ultraweakly continuous maps
$f(u(\,\cdot\,))$ and $a\mapsto u^*a$ 
is ultraweakly continuous on~$\scrA$ too.\qed
\end{point}
\end{point}
\end{parsec}

\begin{parsec}%
\begin{point}{Definition}%
Given a von Neumann algebra~$\scrA$,
the vector space of ultraweakly continuous 
linear maps $f\colon \scrA\to \C$
endowed with the operator norm
is denoted by~$\Define{\scrA_*}$,
and called the \Define{predual} of~$\scrA$.
\begin{point}{Remark}%
The reason
that the space~$\scrA_*$ is called the \emph{predual}
of~$\scrA$
is the non-trivial fact due to Sakai~\cite{sakai} (which we 
don't need and therefore won't prove),
that the obvious 
map $\scrA\to(\scrA_*)^*$,
where $(\scrA_*)^*$ is the \emph{dual} of~$\scrA$ --- the
vector space of bounded linear maps $\scrA_*\to\C$
endowed with the operator norm ---,
is a surjective isometry,
and so $\scrA$ ``is'' the dual of~$\scrA_*$,
(albeit only as normed space,
because~$(\scrA_*)^*$ doesn't come equipped with a multiplication.)

We'll do need this:
\end{point}
\end{point}
\begin{point}[predual-complete]{Proposition}%
The predual~$\scrA_*$ of a von Neumann algebra~$\scrA$
is complete (with respect to the operator norm).
\begin{point}{Proof}%
Let $f_1,f_2,\dotsc$ be a sequence in~$\scrA_*$
which is Cauchy with respect to the operator norm.
We already know (from~\sref{operator-norm-complete})
that $f_1,f_2,\dotsc$ converges to a bounded linear 
functional~$f\colon \scrA\to\C$;
so we only need to prove that~$f$ is ultraweakly continuous
to see that~$\scrA_*$ is complete,
and for this,
we only need to show 
(by~\sref{uwcont-on-ball})
that~$f$
is ultraweakly continuous
on the unit ball~$(\scrA)_1$ of~$\scrA$.
So let~$(b_\alpha)_\alpha$ be 
a net in~$(\scrA)_1$
which converges ultraweakly to~$0$;
we must show that~$\lim_\alpha f(b_\alpha)=0$.
Now, note that for every~$n$ and~$\alpha$
we have the bound
\begin{equation*}
	\left|f(b_\alpha)\right|
	\ \leq\ \left|(f-f_n)(b_\alpha)\right|
	\,+\,\left|f_n(b_\alpha)\right|
	\ \leq\ 
	\|f-f_n\|\,+\,\left|f_n(b_\alpha)\right|.
\end{equation*}
From this,
and $\lim_n\|f-f_n\|=0$,
and $\lim_\alpha f_n(b_\alpha)=0$
for all~$n$,
one easily deduces that~$\lim_\alpha f(b_\alpha)=0$.
Thus~$f$ is ultraweakly continuous,
and so~$\scrA_*$ is complete.\qed
\end{point}
\end{point}
\begin{point}[norm-predual]{Lemma}%
We have $\|a\|=\sup_{f\in(\scrA_*)_1}\left|f(a)\right|$
for every element~$a$ of a von Neumann algebra~$\scrA$.
\begin{point}{Proof}%
It's clear that $\sup_{f\in(\scrA_*)_1}\left|f(a)\right|\leq \|a\|$.

For the other direction,
write $a\equiv [a] \absl{a}$ (see \TODO{polar decompsition}),
and recall that $\|a\|=\|\absl{a}\|=\sup_{\omega\in \Omega} 
\left|\omega (\,\absl{a}\,)\right|$,
where $\Omega$ is the set of  npu-maps $\scrA\to \C$
(see~\TODO{}) .
Let~$\omega\in \Omega$ be given.
Since~$[a]^*a=\absl{a}$ by~\TODO{},
we have $\omega(\,\absl{a}\,)=\omega([a]^*a)=f(a)$,
where $f:=\omega([a]^*(\,\cdot\,))\in (\scrA_*)_1$,
and so $\|a\|=\sup_{\omega\in\Omega} 
\omega(\,\absl{a}\,) \leq \sup_{f\in (\scrA_*)_1}
\left|f(a)\right|$.\qed
\end{point}
\end{point}
\begin{point}[ultraweakly-bounded-implies-bounded]{Theorem}%
A net  $(b_\alpha)_\alpha$
 in a von Neumann algebra~$\scrA$
is norm bounded
(that is,~$\sup_\alpha \|b_\alpha\|<\infty$)
provided it is \Define{ultraweakly bounded}, i.e.,
$\sup_\alpha \left|\omega(b_\alpha)\right|<\infty$
for every npu-map $\omega\colon \scrA\to \C$.
\begin{point}{Proof}%
Note that $f\mapsto f(b_\alpha)$
gives a linear map $(\,\cdot\,)(b_\alpha)\colon \scrA_*\to\C$
with $\|(\,\cdot\,)(b_\alpha)\|=\|b_\alpha\|$ 
by~\sref{norm-predual}
for each~$\alpha$.
So to prove that~$(b_\alpha)_\alpha$
is norm bounded, viz.~%
$\sup_\alpha \|b_\alpha\|\equiv \sup_\alpha \|(\,\cdot\,)(b_\alpha)\|<\infty$,
it suffices to show
(by the principle of uniform boundedness, \sref{pub},
using that~$\scrA_*$ is complete, \sref{predual-complete}),
that $\sup_\alpha \left|f(b_\alpha)\right|<\infty$ for all~$f\in\scrA_*$.

Since such~$f\in\scrA_*$
can be written as $f\equiv \sum_{k=0}^3 i^k f_k$
where $f_k\colon \scrA\to\C$ are np-maps
(by~\sref{normal-functionals-lemma}),
we see that $\sup_\alpha\left|f(b_\alpha)\right|
\leq \sum_{k=0}^3\sup_\alpha \left|\omega_k(b_\alpha)\right|
<\infty$, because~$(b_\alpha)_\alpha$
is ultraweakly bounded.
Thus~$(b_\alpha)_\alpha$
is norm bounded.\qed
\end{point}
\end{point}
\end{parsec}
\subsection{Ultraweak permanence}
\begin{parsec}%
\begin{point}%
To pry out the final bits of structure of normal functionals
we resort to the classical but nonetheless rather mysterious notion
of commutant.
\end{point}
\begin{point}[commutant]{Definition}%
Given a subset~$S$ of a von Neumann algebra~$\scrA$
the \Define{commutant} of~$S$
is the set, denoted by~$\Define{S^\square}$,
of all~$a\in\scrA$ with $as=sa$ for all~$s\in S$.
\end{point}
\begin{point}[commutant-basic]{Exercise}%
Let~$S$ and~$T$ be subsets of a von Neumann algebra~$\scrA$.
\begin{enumerate}
\item
Show that $S \subseteq T^\square$ iff $T \subseteq S^\square$.

Show that $S\subseteq T$ entails $T^\square \subseteq S^\square$.

Show that $S\subseteq S^{\square\square}$,
and  $S^{\square\square\square}=S^\square$.
\item
Verify that~$Z(\scrA)=\scrA^\square$,
where~$Z(\scrA)$ is the centre of~$\scrA$ \TODO{add ref},
and~$\scrA^\square$ is the commutant of~$\scrA$ in itself.
\item
Show that $S^\square$ is closed under addition,
(scalar) multiplication,
contains the unit of~$\scrA$,
and is ultraweakly closed.
\item
Show that the commutant $S^\square$ need not be self-adjoint.\\
(Hint: compute 
$\{\bigl(\begin{smallmatrix}0&1\\0&0\end{smallmatrix}\bigr)\}^\square$
in $M_2$.)

Show that if~$S$ is self-adjoint,
then~$S^\square$ is self-adjoint,
and conclude that in that case~$S^\square$
is a von Neumann subalgebra of~$\scrA$.

\item
In particular,
if~$\scrB$ is a von Neumann subalgebra of~$\scrA$,
then~$\scrB^{\square\square}$
is a von Neumann subalgebra of~$\scrA$
with $\scrB\subseteq \scrB^{\square\square}$.

Verify that $Z(\scrB)=\scrB\cap \scrB^{\square}$,
where is~$Z(\scrB)$ is the centre of~$\scrB$
(from \TODO{...}).

\TODO{Example of~$\scrB^{\square\square} \neq  \scrB$}

Nevertheless,
we'll see in \sref{proto-double-commutant} that $\scrB^{\square\square}=\scrB$
when~$\scrA$ is of the form $\scrA=\scrB(\scrH)$
for some Hilbert space~$\scrH$.
\end{enumerate}
\end{point}
\begin{point}[commutant-ceil]{Proposition}%
Let~$S$ be a subset of a von Neumann algebra~$\scrA$
that is closed under multiplication, involution, and contains~$1$.
Let~$e$ be a projection in~$\scrA$.
Then $\Define{\ceil{e}_{S^\square}}= 
\bigcup_{a\in S} \ceil{a^* e a}$
is the least projection in~$S^\square$
above~$e$.

(Compare this with the paragraph ``Subspaces'' of \S2.6 of~\cite{kr}.)
\begin{point}{Proof}%
Let us first show that~$p:= \ceil{e}_{S^\square}$
is in~$S^\square$.
Let $b\in S$ be given.
Since~$b^*(\,\cdot\,)b\colon \scrA\to\scrA$
is normal and completely positive,
and $p=\bigcup_{a\in S} \ceil{a^*ea}$,
we have $b^*pb\leq \ceil{b^*pb} = 
\bigcup_{a\in S} \ceil{ b^* \ceil{a^* e a} b }
= \bigcup_{a\in S} \ceil{(ab)^* \,e\, ab} \leq p$
by~\sref{ncp-union} and~\sref{ncp-ceil}.
Applying $p^\perp(\,\cdot\,)p^\perp$,
we get $p^\perp b^*pb p^\perp 
\leq p^\perp p p^\perp = 0$,
so that $pbp^\perp=0$,
and thus $pbp=pb$.
Since similarly $pb^* =pb^*p$,
we get  $bp=pbp=pb$
(upon applying~$(\,\cdot\,)^*$) and so~$p\in S^\square$.

Note that~$e\leq \ceil{1^* e 1}\leq p$, because $1\in S$.
It remains to be shown that~$p$ is the least projection in~$S^\square$
above~$e$, so let~$q$ be a projection in~$S^\square$ above~$e$.
Since for~$a\in S$,
we have~$aq^\perp a^*=  q^\perp aa^* q^\perp 
\leq \|a\|^2q^\perp \leq \|a\|^2e^\perp$,
and so $a^*ea\leq \|a\|^2q$ by~\TODO{},
we get~$\ceil{a^*ea}\leq q$
for all~$a\in S$,
and thus~$p=\bigcup_{a\in S}\ceil{a^*ea} \leq q$.\qed
\end{point}
\end{point}

\begin{point}[carrier-vector-state]{Exercise}%
Show that given a vector~$x$ of Hilbert space~$\scrH$,
and a collection~$S$ of bounded operators on~$\scrH$
that is closed under addition, (scalar) multiplication,
involution, and contains the identity operator
the following coincide.
\begin{enumerate}
\item
$\ceil{\,\ketbra{x}{x}\,}_{S^\square}$,
the least projection in~$S^\square$
above $\ceil{\,\ketbra{x}{x}\,}$;
\item
$\ceil{\,\left<x,(\,\cdot\,)x\right>|S^\square\,}$,
the carrier of the vector functional of~$S^\square$
given by~$x$;
\item
$\bigcup_{a\in S} \ceil{\,\ketbra{ax}{ax}\,}$; and 
\item
the projection on~$\overline{S x}$.
\end{enumerate}
Conclude that $\overline{S^{\square\square}x}
=\overline{S x}$.
(Hint: $S^{\square\square\square}=S^\square$.)
\begin{point}[proto-double-commutant]%
Now consider
(instead of~$x$)
an np-map $\omega\colon \scrB(\scrH)\to \C$,
which we know must be of the form
$\omega\equiv \sum_n \left<x_n,(\,\cdot\,)x_n\right>$
(by~\TODO{}),
and is therefore given by 
an element $x'\equiv (x_1,x_2,\dotsc)$ of the $\omega$-fold
product~$\scrH':=\bigoplus_n\scrH$ of~$\scrH$.
\begin{enumerate}
\item
Show that  $\omega(t)=\left<x',\varrho'(t)x'\right>$,
where $\varrho'\colon \scrB(\scrH)\to\scrB(\scrH')$
is the nmiu-map given by 
$\varrho'(t)y=(ty_n)_n$
for all~$t\in\scrB(\scrH)$ and~$y\in\scrH'$.

\item
Let~$t\in S^{\square\square}$ be given.
Show that $\varrho'(t)\in \varrho'(S)^{\square\square}$.
\TODO{Check the difficulty of this}

Prove that  $\varrho'(t)x\,\in\,\overline{\varrho'(S)^{\square\square}x}
\equiv \overline{\varrho'(S)x}$.

Deduce
that for every~$\varepsilon>0$
one can find~$a\in S$ with $\|t-a\|_\omega \leq \varepsilon$.

\item
Deduce that $S^{\square\square}$
is contained in the ultrastrong closure of~$S$.
\end{enumerate}
\end{point}
\end{point}
\begin{point}[double-commutant]{Double Commutant Theorem}%
For a collection~$S$ of bounded operators
on a Hilbert space~$\scrH$
that is closed under addition, (scalar) multiplication,
involution, and contains the identity operator
the following are the same.
\begin{enumerate}
\item
$S^{\square\square}$, the ``double commutant'' of~$S$
in~$\scrB(\scrH)$;
\item
$\mathrm{us}\text{-}\mathrm{cl}(S)$,
the ultrastrong closure of~$S$ in~$\scrB(\scrH)$;
\item
$\mathrm{uw}\text{-}\mathrm{cl}(S)$,
the ultraweak closure of~$S$ in~$\scrB(\scrH)$;
\item
$W^*(S)$,
the least von Neumann subalgebra of~$\scrB(\scrH)$
that contains~$S$.
\end{enumerate}
\begin{point}{Proof}%
(Based on Theorem~5.3.1 of~\cite{kr}.) 

Note that: $\mathrm{us}\text{-}\mathrm{cl}(S)
\subseteq  \mathrm{uw}\text{-}\mathrm{cl}(S)$,
because ultrastrong convergence implies ultraweak convergence;
and
$\mathrm{uw}\text{-}\mathrm{cl}(S)
\subseteq W^*(S)$,
because~$W^*(S)$ 
is ultraweakly closed in~$\scrB(\scrH)$ by~\sref{vnsac};
and
$W^*(S)\subseteq S^{\square\square}$,
because 
$S^{\square\square}$ is a von Neumann subalgebra
of~$\scrB(\scrH)$ by~\sref{commutant-basic};
and, finally, $S^{\square\square}\subseteq \mathrm{us}\text{-}\mathrm{cl}(S)$
by~\sref{proto-double-commutant}.\qed
\end{point}
\end{point}
\begin{point}[centre-commutant]{Exercise}
Show that central elements of
a von Neumann algebra~$\scrA$
of bounded operators on a Hilbert space~$\scrH$
coincide with the central elements of the commutant~$\scrA^\square$,
that is, $Z(\scrA)=Z(\scrA^\square)$.
(Hint: $\scrA^{\square\square}=\scrA$ by~\sref{double-commutant}.)
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}%
Using~\sref{commutant-ceil}
we can also get a better handle on the set 
$Z(\scrA)$ of central elements
of a von Neumann algebra~$\scrA$,
which is, after all, equal to~$\scrA^\square$.
\end{point}
\begin{point}{Exercise}%
Let~$\scrA$ be a von Neumann algebra.
Show that
$\bigcup_{a\in\scrA}\ceil{a^*ea}$
is the least central projection above any projection~$e$
of~$\scrA$.
\begin{point}%
Show that given an element~$a$ of a von Neumann algebra~$\scrA$,
the following exist and coincide.
\begin{enumerate}
\item
The least central projection~$z$ with $za=a$.
\item
The least central projection above $\ceil{a^*a}$.
\item
The least central projection above $\ceil{aa^*}$.
\end{enumerate}
We'll denote it by~$\Define{\cceil{a}}$
and call it the \Define{central support} of~$a$.
\end{point}
\begin{point}[cceil-basic]
\begin{enumerate}
\item
Show that
$\cceil{a}=\cceil{a^*a}=\cceil{aa^*}
= \cceil{\ceil{a^*a}}=\cceil{\ceil{aa^*}}=\cceil{a^*}$.
\item
Show that $\bigcup_{e\in E} \cceil{e}
= \cceil{\bigcup E}$
for any set~$E$ of projections in~$\scrA$.
\end{enumerate}
\end{point}
\end{point}
\begin{point}[cceil-sum]{Lemma}%
Given a projection~$e$
of a von Neumann algebra
there is an orthogonal collection of non-zero projections
$(e_i)_i$ with $\cceil{e}=\sum_i e_i$,
and $p_i\vmleq e$ for all~$i$.

\TODO{define $\vmleq$}
\begin{point}{Proof}%
Let~$(e_i)_i$
be a maximal set of non-zero orthogonal projections
in~$\scrA$ with
$e_i\vmleq p$ for all~$i$.
Our goal is to show that $\sum_i e_i \equiv \bigcup_i e_i=\cceil{a}$.

Let~$u_i$ be a partial isometry
with $u_i^*u_i=e_i$ and $u_iu_i^* \leq e$.
Since $e_i=u_i^* u_i = u_i^* u_i u_i^* u_i
\leq u_i^* e u_i 
\leq \bigcup_{a\in \scrA} \ceil{a^* e a}=\cceil{a}$,
we have
$\bigcup_i e_i \leq \cceil{a}$.

Suppose that~$\bigcup_i e_i < \cceil{a}$
(towards a contradiction).
Then since $p:=\cceil{a}-\bigcup_i e_i $ 
is a non-zero projection,
and~$p=p\cceil{e} p
=\bigcup_{a\in\scrA} \ceil{p\ceil{a^*ea}p}
= \bigcup_{a\in\scrA} \ceil{(ap)^*eap}$,
there must be~$a\in\scrA$ with $(eap)^*eap\neq 0$.
The polar decomposition of~$eap$
(see \TODO{})
gives us a partial isometry $u:=[eap]$
with $uu^* = \ceil{eap(eap)^*}=\ceil{eapa^*e}\leq e$
and $u^*u= \ceil{(eap)^*eap}\leq p$,
so that $u^*u$ is a non-zero projection,
orthogonal to all~$e_i$ with $u^*u \vmleq e$.
In other words,
$e$ could have been added to~$(e_i)_i$,
contradicting its maximality.
Hence $\bigcup_i e_i = \cceil{a}$.
\qed
\end{point}
\end{point}
\begin{point}{Exercise}%
Let~$f\colon \scrA \to \scrB$ be an np-map.
Show that $\Define{\cceil{f}}:=\cceil{\ceil{f}}$ is least central projection~$z$
with~$f(z^\perp)=0$
--- it's called the 
\Define{central carrier} of~$f$.
\end{point}
\begin{point}[commutant-cceil]{Exercise}%
Let~$\scrR$ be a von Neumann subalgebra of a von Neumann algebra~$\scrA$,
and let~$f\colon \scrA\to\scrB$ be an np-map
to a von Neumann algebra~$\scrB$.

Show that~$\cceil{f|\scrR}=\cceil{f|\scrR^\square}$
using the fact that $Z(\scrR)=Z(\scrR^\square)$
(see~\sref{centre-commutant}).
\end{point}
\end{parsec}%
\begin{parsec}%
\begin{point}%
With the commutant at our disposal,
we turn to a subtle, but suprisingly difficult matter:
it is not immediately clear
that the ultraweak topology on a von Neumann
subalgebra~$\scrA$ of a von Neumann algebra~$\scrB$,
coincides (on~$\scrA$) with the ultraweak topology on~$\scrB$.
While it is easily seen that the former is finer
(that is, a net in~$\scrA$ which converges ultraweakly in~$\scrA$,
converges ultraweakly in~$\scrB$ too, because any np-map 
$\omega\colon \scrB\to\C$ is also an np-map restricted to~$\scrA$),
it is not obvious that an np-map $\omega\colon \scrA\to\C$
can be extended to an np-map on~$\scrB$
--- but it can, as we'll see~\sref{functional-permanence}.
I'll call this independence of the ultraweak topology
from the surrounding space
\emph{ultraweak permanence}
being not unlike the independence
of the spectrum of an operator from the surrounding space
known as spectral permanence (\sref{spectral-permanence}).


It is tempting to think that the extension of an np-map~$\omega\colon \scrA
\to\C$
on a von Neumann
subalgebra~$\scrA$ of a von Neumann algebra~$\scrB$
to~$\scrB$ is simply a matter of applying Hahn--Banach to~$\omega$,
but this approach presents two problems:
it yields a normal but not necessarily positive extension
of~$\omega$;
and it not clear that~$\omega$ is ultraweakly continuous
on~$\scrA$ (that is, whether Hahn--Banach applies).

Instead of applying general techniques we feel forced
to delve deeper
into the particular structure 
provided to us by von Neumann algebras
to show that any np-map
$\omega\colon \scrA\to\C$
on a von Neumann algebra~$\scrA$
of bounded operators on a Hilbert space~$\scrH$
can be extended to an np-map on~$\scrB(\scrH)$,
and in fact, is of the form
$\omega\equiv \sum_n \left<x_n,(\,\cdot\,)x_n\right>$
for some $x_1,x_2,\dotsc \in\scrH$.
\end{point}
\begin{point}[gns-mapping-property]{Lemma}%
Let~$\omega\colon \scrA\to\C$
be an np-map on a von Neumann algebra~$\scrA$,
which is represented by nmiu-maps
$\varrho\colon \scrA\to\scrB(\scrH)$
and $\pi\colon \scrA\to\scrB(\scrK)$
on Hilbert spaces~$\scrH$ and~$\scrK$.
If $\left<x,\varrho(\,\cdot\,)x\right>
=\omega=\left<y,\pi(\,\cdot\,)y\right>$
for some  $x\in\scrH$ and~$y\in\scrK$,
then there is a bounded operator $U\colon \scrK\to\scrH$
for which~$UU^*$ is the projection
on~$\overline{\varrho(\scrA)x}$,
$U^*U$ is the projection
on~$\overline{\pi(\scrA)y}$,
and~$U\pi(a)=\varrho(a)U$
for all~$a\in\scrA$.
\begin{point}{Proof}%
(Compare this with Proposition 4.5.3 of~\cite{kr}.)

Since $\|\varrho(a)x\|^2
= \left<x,\varrho(a^*a)x\right>
=\omega(a^*a)=\left<y,\pi(a^*a)y\right>
= \|\pi(a)y\|^2$ for all~$a\in\scrA$,
there is a unique bounded operator $V\colon \overline{\pi(\scrA)y}
\to \overline{\varrho(\scrA)x}$
with $V\pi(a)y = \varrho(a)x$ for all~$a\in\scrA$.
A moment's thought reveals
that $V$ is a unitary (and so~$V^*V=1=VV^*$).
Now, define $U:=EVF^*$
where $E\colon \overline{\varrho(\scrA)x}\to\scrH$
and $F\colon \overline{\pi(\scrA)y}\to\scrK$
are the inclusions
(and so~$E^*E=1$ and~$F^*F=1$).
Then $UU^*= EVF^*FV^*E^*=EVV^*E^*=EE^*$
is the projection onto~$\overline{\varrho(\scrA)x}$,
and $UU^*=FF^*$
is the projection onto~$\overline{\pi(\scrA)y}$.

Let~$a\in\scrA$ be given.
It remains to be shown that
$U\pi(a)=\varrho(a)U$.
To this end,
observe that
$V F^* \pi(a) F = E^* \varrho(a) E V$
(because 
these two bounded linear maps
are easily seen to
agree on the dense subset $\pi(\scrA)y$
of $\overline{\pi(\scrA)y}$);
and $\varrho(a)E = EE^*\varrho(a)E$
(because $\varrho(a)$ maps $\varrho(\scrA)x$ into~$\varrho(\scrA)x$);
and similarly $\varrho(a^*)F=FF^*\varrho(a^*) F$,
so that $F^*\varrho(a) = F^* \varrho(a) FF^*$
(upon application of the~$(\,\cdot\,)^*$).
By these observations,  $U\pi(a)=
EVF^*\pi(a)=EVF^*\pi(a) FF^*
= EE^*\varrho(a)EVF^*
= \varrho(a)EVF^*
= \varrho(a)U$.\qed
\end{point}
\end{point}
\begin{point}[summing-partial-isometries]{Exercise}%
It is not too difficult 
to see that the (ultraweak) sum~$\sum_i u_i$
of a collection $(u_i)_i$ 
of partial isometries from some von Neumann algebra
is again a partial isometry, 
provided that the initial projections $u_i^*u_i$
are orthogonal,
and the final projections~$u_iu_i^*$ are orthogonal.
In this exercise, you'll establish a similar result,
but for partial isometries between two different Hilbert spaces,
and avoiding the use of an analogue of 
the ultraweak topology for such operators.

\begin{point}%
Let~$\scrH$ and~$\scrK$ be Hilbert spaces,
and 
let $U_i\colon \scrH\to\scrK$
be a bounded operator
for every element~$i$ from some set~$I$.
Assume that the operators~$U_i^*U_i$
are pairwise orthogonal projections in~$\scrB(\scrK)$,
and that~$U_iU_i^*$ are pairwise orthogonal projections in~$\scrB(\scrH)$.
\begin{enumerate}
\item
Let~$x\in\scrH$ and~$y\in\scrK$ be given.

Show that
$\left|\left<x,U_iy\right>\right|
\leq \|U_i^*\| \|U_i y \|$
for each~$i$
(perhaps by first proving that  $U_i = U_i U_i^* U_i$).

Show that~$\sum_i \|U_i y\|^2 \leq \|y\|^2$
and $\sum_i \|U_i^* x\|^2\leq \|x\|^2$,
and deduce from this
that $\sum_i \left|\left<x,U_i y\right>\right| \leq \|x\|\|y\|$.

Now use~\TODO{}
to show that there is a bounded operator~$U\colon \scrK\to\scrH$
with $\left<x,Uy\right>
= \sum_i \left<x,U_iy\right>$
for all~$x\in\scrH$ and~$y\in \scrK$.
\item
Show that~$U_i^*U_j = 0$ when~$i\neq j$.
Deduce from this that~$U^*U = \sum_i U_i^* U_i$.

Prove that $UU^* = \sum_i U_iU_i^*$.
\end{enumerate}
\end{point}
\end{point}
\begin{point}[sigma-weak-lemma-2]{Lemma}%
Let~$\Omega$ be a collection of np-maps $\omega\colon \scrA\to\C$
on a von Neumann algebra~$\scrA$ 
whose central carriers,  $\cceil{\omega}$, are orthogonal to one another,
and let~$\scrH$ and~$\scrK$ be Hilbert spaces
on which~$\scrA$ is represented such
that each~$\omega\in\Omega$ 
is given by vectors $x_\omega\in\scrH$ and $y_\omega\in\scrK$,
that is,
$\left<x_\omega,\varrho(\,\cdot\,)x_\omega\right>
=\omega = \left<y_\omega,\pi(\,\cdot\,)y_\omega\right>$,
where $\varrho\colon \scrA\to\scrB(\scrH)$
and $\pi\colon \scrA\to\scrB(\scrK)$
are nmiu-maps.

Then there is a bounded operator $U\colon \scrK\to\scrH$
which intertwines~$\pi$ and~$\varrho$
in the sense that $U \pi(a)=\varrho(a) U$
for all~$a\in \scrA$
such that~$U^*U$
is a projection in
$\pi(\scrA)^\square$
with
$\cceil{U^*U}_{\pi(\scrA)^\square}=\pi(\sum_\omega \cceil{\omega})$,
and 
$UU^*$
is projection in
$\varrho(\scrA)^\square$
with
$\cceil{UU^*}_{\varrho(\scrA)^\square}=\varrho(\sum_\omega \cceil{\omega})$.
\begin{point}{Proof}%
Given~$\omega\in\Omega$,
let $\sigma_\omega\colon \varrho(\scrA)\to \C$
and $\sigma_\omega'\colon \varrho(\scrA)^\square\to\C$
denote the restrictions
of the vector functional $\left<x_\omega,(\,\cdot\,)x_\omega\right>
\colon \scrB(\scrH)\to\C$,
and let  $\tau_\omega\colon \pi(\scrA)\to \C$
and $\tau_\omega'\colon \pi(\scrA)^\square\to\C$
be similar restrictions
of $\left<y_\omega,(\,\cdot\,)y_\omega\right>$.
We already know (by~\sref{gns-mapping-property}
and~\sref{carrier-vector-state})
that
there is
a bounded operator $U_\omega\colon \scrK\to\scrH$
with $U_\omega^*U_\omega = \ceil{\tau_\omega'}$,
$U_\omega U_\omega^* = \ceil{\sigma_\omega'}$,
and $U_\omega \pi(a) = \varrho(a) U_\omega$
for all~$a\in\scrA$.

We'll combine these $U_\omega$s into one operator~$U$
using~\sref{summing-partial-isometries} but for this must
verify that the projections $U_\omega^* U_\omega=\ceil{\sigma_\omega'}$
are orthogonal,
and that the projections $U_\omega U_\omega^*$
are orthogonal too.
To this end note that
$\cceil{\sigma_\omega}=\cceil{\sigma_\omega'}$
by~\sref{commutant-cceil}.
Thus, since the projections~$\cceil{\omega}$
are orthogonal to one another,
and $\ceil{\sigma_\omega'}\leq \cceil{\sigma_\omega'}
= \cceil{\sigma_\omega} =\varrho(\cceil{\omega})$,
we see that the projections~$U^*_\omega U_\omega \equiv 
\ceil{\sigma_\omega'}$
are indeed orthogonal.
Since for a similar reason
the projections $U_\omega U_\omega^*
\equiv \ceil{\tau_\omega'}$ are orthogonal too,
there is by~\sref{summing-partial-isometries}
a bounded operator $U\colon \scrK\to\scrH$
with 
$U^*U = \sum_\omega U_\omega^* U_\omega$,
$UU^* = \sum_\omega U_\omega U_\omega^*$,
and $\left<x,Uy\right>=\sum_\omega \left<x,U_\omega y\right>$
for all~$x\in\scrH$ and~$y\in \scrK$.

Let us check that~$U$ has the desired properties.
To begin, since the projections
$\cceil{U_\omega^*U_\omega}=\cceil{\sigma_\omega'}=\varrho(\cceil{\omega})$
are orthogonal,
we have $\cceil{U^*U}=\sum_\omega \cceil{U_\omega^* U_\omega}
=  \varrho(\sum_\omega \cceil{\omega})$
by~\sref{cceil-basic} and \TODO{sum of orthogonal projections is union}.
Similarly, $\cceil{UU^*}= \pi(\sum_\omega \cceil{\omega})$.

Finally,
given~$a\in\scrA$
we have $U\pi(a)=\varrho(a)U$,
because $\left<x,U\pi(a)y\right>
= \sum_\omega \left<x,U_\omega \pi(a)y\right>
= \sum_\omega \left<x,\varrho(a) U_\omega y\right>
= \sum_\omega \left<\varrho(a)^* x, U_\omega y\right>
= \left<\varrho(a)^* x, U y\right>
= \left<x, \varrho(a) U y\right>$
for all~$x\in\scrH$ and~$y\in\scrK$.\qed
\end{point}
\end{point}
\begin{point}[sigma-weak-lemma]{Corollary}%
Let~$\scrA$ be a von Neumann 
of bounded operators on some Hilbert space~$\scrH$,
and let~$\varrho\colon \scrA\to\scrB(\scrH)$
denote the inclusion.
Let~$\Omega$ be the collection of all np-maps $\scrA\to\C$,
and let $\varrho_\Omega\colon \scrA\to\scrB(\scrH_\Omega)$
be as in~\TODO{}.

There is a bounded operator $U\colon \scrH_\Omega\to\scrH$
such that $U^*U$ is a projection
in~$\varrho_\Omega(\scrA)^\square$
with 
$\cceil{U^*U}_{\varrho_\Omega(\scrA)^\square}=1$
and
$U\varrho_\Omega(a)= \varrho(a) U$
for all~$a\in\scrA$.
\begin{point}{Proof}%
Let $\{x_i\}_i$ be a maximal set of vectors
in~$\scrH$ 
such that the 
central carriers~$\cceil{\omega_i}$
of the corresponding vector functionals
$\omega_i :=\left<x_i,\varrho(\,\cdot\,)x_i\right>$
on~$\scrA$
are orthogonal;
so that we'll 
have $\sum_i \cceil{\omega_i}=1$.
Now, the point of~$\scrH_\Omega$ 
is that there are vectors $y_i\in\scrH_\Omega$
with $\omega_i=\left<y_i,\varrho_\Omega(\,\cdot\,)y_i\right>$
for each~$i$.
Now apply~\sref{sigma-weak-lemma-2}
to get a map~$U\colon \scrH_\Omega\to \scrH$
with the desired properties.\qed
\end{point}
\end{point}
\begin{point}[normal-functional]{Theorem}%
Every np-map $\omega\colon \scrA\to\C$
on a von Neumann subalgebra~$\scrA$
of~$\scrB(\scrH)$,
where~$\scrH$ is some Hilbert space,
is of the 
form~$\omega \equiv \sum_n \left<x_n,(\,\cdot\,)x_n\right>$
for some $x_1,x_2,\dotsc \in\scrH$
(with $\sum_n\|x_n\|^2<\infty$).
\begin{point}{Proof}%
(Based on Theorem~7.1.8 of~\cite{kr}.)

Let~$\varrho\colon \scrA\to\scrB(\scrH)$
denote the inclusion,
and let~$U\colon \scrH_\Omega\to\scrH$
be as in~\sref{sigma-weak-lemma}.
Since~$\omega\in\Omega$,
there is~$y\in\scrH_\Omega$
with $\omega = \left<y,\varrho_\Omega(\,\cdot\,)y\right>$.
We're going to `transfer'~$y$ from~$\scrH_\Omega$ to~$\scrH$
using the following device.
Since~$1=\cceil{U^*U}_{\varrho_\Omega(\scrA)^\square}$,
we can 
(by~\sref{cceil-sum})
find partial isometries $(v_i)_i$ in
$\varrho_\Omega(\scrA)^\square$
with $1=\sum_i v_i^*v_i$
and $v_iv_i^*\leq U^*U$
for all~$i$.
Then for every~$a\in\scrA$,
\begin{alignat*}{3}
	\textstyle
\omega(a)\  &=\
	\textstyle
	\left<\,y, \,\varrho_\Omega(a)y\,\right> 
	\\
&= 
	\textstyle
	\ \sum_i \left<\,y,\,  v_i^*v_i\, \varrho_\Omega(a) y \,\right>
	&&\qquad 
	\textstyle
	\text{since $1=\sum_i v_i^*v_i$}
	\\
&= 
	\textstyle
	\ \sum_i \left<\,y,\,  v_i^* U^*Uv_i \,\varrho_\Omega(a)y\, \right>
	&&\qquad\text{since $v_iv_i^*\leq U^*U$}
	\\
	&= 
	\textstyle
	\ \sum_i \left<\,Uv_i y,\, U \varrho_\Omega(a)v_i y\, \right>
	&&\qquad\text{since $v_i \in \varrho(\scrA)^\square$}
	\\
	&= 
	\textstyle
	\ \sum_i \left<\,Uv_i y,\, \varrho(a) \, Uv_i y\, \right>
	&&\qquad\text{since $U\varrho_\Omega(a)=\varrho(a) U$}.
\end{alignat*}
In particular, $\omega(1)=\sum_i \|Uv_i y\|^2$,
so at most countably many $Uv_iy$'s are non-zero;
and denoting those by~$x_1,x_2,\dotsc$,
we get $\omega = \sum_n \left<x_n,(\,\cdot\,)x_n\right>$.\qed
\end{point}
\end{point}
\begin{point}[functional-permanence]{Corollary}%
Let~$\scrA$ be a von Neumann subalgebra
of a von Neumann algebra~$\scrB$.
\begin{enumerate}
\item
For every np-map $\omega\colon \scrA\to\C$
there is an np-map $\xi\colon \scrB\to\C$
with $\xi|\scrA=\omega$.
\item
\Define{Ultraweak permanence:}\ 
the restriction of the ultraweak topology on~$\scrB$
to~$\scrA$ coincides with the ultraweak topology on~$\scrA$.
\item
\Define{Ultrastrong permanence:}\ 
the restriction of the ultrastrong topology on~$\scrB$
to~$\scrA$ coincides with the ultrastrong topology on~$\scrA$.
\end{enumerate}
\end{point}
\end{parsec}
\section{[To be moved]}
%
%
%
\begin{parsec}[floor-sequential-product]%
\begin{point}{Lemma}%
Let~$a,b$ be effects of a von Neumann algebra~$\scrA$.
Then~$\floor{\sqrt{a}b\sqrt{a}}$ is the greatest projection
below~$a$ and~$b$, that is, in symbols, 
$\floor{\sqrt{a}b\sqrt{a}}=\floor{a}\cap \floor{b}$.
\end{point}
\begin{point}{Proof}%
Surely, $\floor{\sqrt{a}b\sqrt{a}}\leq \sqrt{a}b\sqrt{a} \leq a$.
Let us prove that~$\floor{\sqrt{a}b\sqrt{a}}\leq b$.
To this end,
recall
that (by~\sref{projection-below-effect})
a projection~$e$ is below an effect~$c$
iff $ec=e$ iff $e\sqrt{c}=e$.
In particular,
since~$\floor{\sqrt{a}b\sqrt{a}}\leq \sqrt{a}b\sqrt{a}$ and 
$\floor{\sqrt{a}b\sqrt{a}}\leq a$,
we get
\begin{equation*}
\floor{\sqrt{a}b\sqrt{a}}
\ =\ \floor{\sqrt{a}b\sqrt{a}}\sqrt{a}b\sqrt{a}\floor{\sqrt{a}b\sqrt{a}} \ =\ 
\floor{\sqrt{a}b\sqrt{a}}b\floor{\sqrt{a}b\sqrt{a}},
\end{equation*}
and so $\floor{\sqrt{a}b\sqrt{a}}b^\perp\floor{\sqrt{a}b\sqrt{a}}=0$,
which implies that
$\floor{\sqrt{a}b\sqrt{a}}\leq b$ by~\sref{ad-contraposed}.
\begin{point}%
Now,
let~$e$ be a projection below~$a$ and~$b$,
that is, $e\sqrt{a}=e$ and~$eb=e$.
We must show that~$e\leq \floor{\sqrt{a}b\sqrt{a}}$,
or equivalently, $e\leq \sqrt{a}b\sqrt{a}$,
or put yet differently, $e\sqrt{a}b\sqrt{a}=e$.
But this is obvious: $e=e\sqrt{a}=eb\sqrt{a}=e\sqrt{a}b\sqrt{a}$.
\end{point}
\end{point}
\end{parsec}
\begin{parsec}%
\begin{point}%
Having seen that~$\floor{\sqrt{a}b\sqrt{a}} = \floor{a}\cap\floor{b}$
in~\sref{floor-sequential-product}
one might wonder whether
there is a similar expression for $\ceil{\sqrt{a}b\sqrt{a}}$.
If~$a$ and~$b$ are projection,
$\ceil{aba}$ turns out to coincide with the \Define{Sasaki product},
$a\cap (a^\perp \cup b)$,
as we will show below.
\TODO{Reference for the Sasaki product.}
\TODO{Thank Kenta}
\end{point}
\begin{point}[floor-difference]{Lemma}%
Let~$p$ be a projection,
and let~$a$ be an effect of a von Neumann algebra
with $a\leq p$.
We have $p-\ceil{a}=\floor{p-a}$.
\end{point}
\begin{point}{Proof}%
We must show that $p-\ceil{a}$ is the greatest projection below $p-a$.
To begin, $p-\ceil{a}\leq p-a$,
because $a\leq \ceil{a}$.
Further, since~$a\leq p$, we have $\ceil{a}\leq p$,
and so~$p-\ceil{a}$ is a projection
(by~\sref{projection-below-projection}).
\begin{point}%
Let~$q$ be a projection below~$p-a$.
We must show that~$q\leq p-\ceil{a}$.
The trick is to note that~$a\leq p-q$.
Since~$p-q$ is a projection (by~\sref{projection-below-projection}
because $q\leq p-a\leq p$),
we have $\ceil{a}\leq p-q$,
and so $q\leq p-\ceil{a}$.
\begin{point}[ceil-sequential-product]{Lemma}%
For projections $p,q$ from a von Neumann algebra,
$\ceil{pqp}=p\cap (p^\perp \cup q)$.
\end{point}
\end{point}
\end{point}
\begin{point}[ceil-sequential-product-1]{Proof}%
Observe that $(\ p\cap (p^\perp \cup q)\ )^\perp 
= p^\perp \cup(p\cap q^\perp)$.
Since~$p^\perp$ and $p\cap q^\perp$ are disjoint,
we have $p^\perp \cup (p\cap q^\perp) = p^\perp + p\cap q^\perp$,
and so $p\cap (p^\perp \cup q) = p-p\cap q^\perp$.
\begin{point}%
By point~\sref{ceil-sequential-product-1}, 
it suffices to show that~$\ceil{pqp}=p- p\cap q^\perp$,
that is, $p-\ceil{pqp}=p\cap q^\perp$.
Since $p-\ceil{pqp} = \floor{p-pqp}$
by~\sref{floor-difference} and $\floor{pq^\perp p}=p\cap q^\perp$
by~\sref{floor-sequential-product} we are done.
\end{point}
\end{point}
\end{parsec}

%
% About maps between von Neumann algebras
%

\begin{parsec}%
\begin{point}{Proposition}%
For a cp-map~$f\colon \scrA\to\scrB$
 between $C^*$-algebras, and $a,b\in\scrA$, 
\begin{equation*}
f(b^*a)\,f(a^*b)\ \leq\ \|f(a^*a)\|\,f(b^*b).
\end{equation*}
\end{point}%
\begin{point}{Proof}%
\TODO{add}
\end{point}
\end{parsec}
%
%
%
\begin{parsec}%
\end{parsec}
%
%
%
\begin{parsec}%
\begin{point}{Proposition}%
Let~$f\colon \scrA\to\scrB$ be a ncpsu-map
between von Neumann algebras.
Then~$\floor{f(a)}=\floor{f(\floor{a})}$
for every effect~$a$ from~$\scrA$.
\end{point}
\begin{point}{Proof}%
Since~$\floor{a}\leq a$,
we have~$\floor{f(\floor{a})}\leq \floor{f(a)}$.
Thus we only need to show that~$\floor{f(a)}\leq \floor{f(\floor{a})}$,
or equivalently, $\floor{f(a)}\leq f(\floor{a})$.
We have
\begin{equation*}
\floor{f(a)}
\ \stackrel{\sref{ceil-floor-basic}}{=}\ 
\floor{f(a)^2}
\ \stackrel{\sref{cp-kadisons-ineq}}{\leq}\  
\floor{f(a^2)} \ \leq\ \floor{f(a)},
\end{equation*}
and so~$\floor{f(a)}=\floor{f(a^2)}$.
By induction,
and similar reasoning,
we get~$\floor{f(a)}=\floor{f(a^{2^n})}\leq f(a^{2^n})$
for every~$n$,
and so
$\floor{f(a)}\leq \bigwedge_n f(a^{2^n})
= f(\bigwedge_n a^{2^n})=f(\floor{a})$,
where we used that~$f$ is normal,
and~$\floor{a}=\bigwedge_n a^{2^n}$ (see~\sref{vna-floor}).
\end{point}
\end{parsec}

\begin{parsec}%
\begin{point}%
Parsec about commutative $C^*$-algebras:
\end{point}
\begin{point}[ccstar-proj]{Theorem}%
The projections~$\Proj(\scrA)$ of a commutative $C^*$-algebra~$\scrA$
form a Boolean algebra.
If~$\scrA$ is monotone complete,
then~$\Proj(\scrA)$ is a complete Boolean algebra.
\end{point}
\end{parsec}

\begin{parsec}%
\begin{point}%
Let us now turn to quotients of von Neumann algebras.
Recall that given a norm closed two-sided ideal~$\scrD$
of a $C^*$-algebra $\scrA$
we can form the quotient $\scrA/\scrD$,
(which is again a $C^*$-algebra),
and the quotient map $q\colon \scrA\to \scrA/\scrD$
which is a \textsc{miu}-map.
If~$\scrA$ is a von Neumann algebra,
then~$\scrA/\scrD$ might not be a von Neumann algebra,
either because~$\scrA/\scrD$ is not be monotone complete 
(see~\sref{vn-quotient-not-monotone-complete}),
or because~$\scrA/\scrD$ does not have a separating set of normal states
(see~\TODO{}).
However, if~$\scrD$ is ultraweakly closed,
then~$\scrA/\scrD$ is a von Neumann algebra,
as one might have suspected.
To prove this,
we need the somewhat surprising
fact that every ultraweakly closed
ideal~$\scrD$ is of the form $\scrD\equiv c\scrA$,
where~$c$ is a central projection~$c$ of~$\scrA$.
(The quotient~$\scrA/c\scrA$ is then simply~$c^\perp\scrA$.)
\TODO{connection between uw-closed ideals and central projections}
\TODO{universal property for \textsc{n(c)p(s)(u)}-maps}
\end{point}
\begin{point}[vn-quotient-not-monotone-complete]{Example}%
The quotient of a von Neumann algebra
by an closed ideal
need not be a von Neumann algebra:
we will show that $\ell^\infty/c_0$
is not monotone complete,
where~$\ell^\infty$ is the von Neumann algebra
of bounded sequences,
and~$c_0\subseteq \ell^\infty$
is the norm closed ideal of
sequences which converge to~$0$.
By~\sref{ccstar-proj}
it suffices to show that the Boolean algebra~$\Proj(\ell^\infty/c_0)$
of projections of~$\ell^\infty/c_0$ is not complete.
\begin{point}%
We claim that $\Proj(\ell^\infty/c_0)$
is isomorphic to the Boolean algebra
 $\wp(\N)/\wp_{fin}(\N)$
of subsets of~$\N$ modulo 
the filter~$\wp_{fin}(\N)$ of finite subsets.

It is easy to see that the assignment $A\mapsto [\mathbf{1}_A]_{c_0}$
(where $\mathbf{1}_A$ is the indicator function of~$A$)
gives a Boolean algebra homomorphism 
$f\colon \wp(\N)\to \Proj(\ell^\infty/c_0)$,
that the kernel of~$f$
is $\wp_{fin}(\N)$
(because for $A\subseteq \N$
we have $\mathbf{1}_A\in c_0$ iff $A$ is finite).
It remains to be shown that~$f$ is surjective,
which requires some fiddling.

Let~$\alpha\in \ell^\infty$
be
such that $[\alpha]_{c_0}$ is a projection in $\ell^\infty/c_0$.
We claim that
$\mathbf{1}_A - \alpha \in c_0$ (and so $\alpha=f(A)$)
for some~$A\subseteq \N$.
Note that since $[\alpha]_{c_0}$ is self-adjoint,
we have $[\alpha]_{c_0}=(\,[\alpha]_{c_0}\,)_\R = [\,\alpha_\R\,]_{c_0}$,
and so we may assume without loss of generality
that~$\alpha$ is self-adjoint
(replacing $\alpha$ by $\alpha_\R$ is necessary).
Define $A=\{n\in\N\colon \left|1-\alpha(n)\right|<\frac{1}{2}\}$.

Let~$\varepsilon>0$ with $\varepsilon<\nicefrac{1}{2}$ be given.
We must find~$N\in\N$ with 
$\left| \mathbf{1}_A(n)-\alpha(n)\right|\leq \varepsilon$
for all~$n\geq N$.
Since~$[\alpha]_{c_0}$ is a projection,
$\alpha-\alpha^2\in c_0$,
and so
there is~$N\in \N$
with $\left|\alpha(n)\right| \,\left| 1-\alpha(n)\right|
\,\equiv\, \left| \alpha(n) - \alpha(n)^2 \right| \leq 
\nicefrac{1}{2}\,\varepsilon < \nicefrac{1}{4}$
for all~$n\geq N$.

Let~$n\geq N$ be given.
Note that either 
$\left|1-\alpha(n)\right|\geq \nicefrac{1}{2}$
or 
$\left|\alpha(n)\right|\geq \nicefrac{1}{2}$.
If~$\left|1-\alpha(n)\right|\geq\nicefrac{1}{2}$,
then $\mathbf{1}_A(n)=0$
(by definition of~$A$),
and so $\left|\mathbf{1}_A(n)-\alpha(n)\right|\equiv \left|\alpha(n)\right| 
\leq 2 \,\left|\alpha(n)\right|\,\left| 1-\alpha(n)\right|
\leq \varepsilon$.
On the other hand,
if  $\left|\alpha(n)\right| \geq \nicefrac{1}{2}$,
then $\left|1-\alpha(n)\right| < \nicefrac{1}{2}$
(because otherwise $\left|\alpha(n)\right|\left|1-\alpha(n)\right|
\geq \nicefrac{1}{4}$),
so $\mathbf{1}_A(n)=1$,
and thus
$\left|\mathbf{1}_A(n)-\alpha(n)\right|
\equiv \left|1-\alpha(n)\right|
\leq 2 \left|\alpha(n)\right|\left|1-\alpha(n)\right|
\leq \varepsilon$.

Hence $\mathbf{1}_A - \alpha \in c_0$,
and so~$f$ is surjective.
It follows that $\Proj(\ell^\infty/c_0)$
is isomorphic to $\wp(\N)/\wp_{fin}(\N)$.
\end{point}
\begin{point}%
We claim that the Boolean algebra~$\wp(\N)/\wp_{fin}(\N)$
is not complete.
To see this,
find a partition of~$\N$ into infinite subsets
$A_1,A_2,\dotsc$.
We claim that~$A_1,A_2,\dotsc$ has no supremum in~$\wp(\N)/\wp_{fin}(\N)$
because there is no minimal upper bound.
Indeed,
let~$A$ be an upper bound of~$A_1,A_2,\dotsc$ in~$\wp(\N)/\wp_{fin}(\N)$,
that is, $A_n\backslash A$ is finite for every~$n$;
we will define an upper bound~$A'$ of $A_1,A_2,\dotsc$
which is strictly below~$A$ in~$\wp(\N)/\wp_{fin}(\N)$.
Since~$A_n$ is infinite,
and~$A_n\backslash A$ is finite,
we can pick $a_n\in A_n\cap A$ for each~$n$.
Then~$A':=A \backslash \{a_1,a_2,a_3,\dotsc\}$
is an upper bound for~$A_1,A_2,\dotsc$,
because $A_n\backslash A' = (A_n\backslash A)\cup\{a_n\}$ is finite
for each~$n$,
and~$A'$ is strictly below~$A$ in~$\wp(\N)/\wp_{fin}(\N)$,
because $A'\backslash A$ is infinite.
Hence~$\wp(\N)/\wp_{fin}(\N)$
is not complete.
\end{point}
\begin{point}%
\TODO{connection with $\beta\N\backslash\N$
being non-Stonean.}
\end{point}
\end{point}
\begin{point}{Proposition}%
\label{prop:weakly-closed-ideal}
For every ultraweakly closed two-sided
ideal~$\mathscr{D}$ of a von Neumann algebra~$\scrA$
there is a unique central projection~$c\in\scrA$
such that $\mathscr{D} = c\scrA$.

Moreover, $c$ is the greatest projection in~$\mathscr{D}$.
\begin{point}{Proof}%
\emph{(if $a\in \mathscr{D}\cap [0,1]_{\scrA}$, 
then $\ceil{a}\in\mathscr{D}$)}\ 
Let~$a\in\mathscr{D}$ with $0\leq a \leq 1$
be given.
Recall that $\ceil{a}$
is the ultraweak limit of $a,\ a^{\frac{1}{2}},\ a^{\frac{1}{4}},\ \dotsc$.
Since~$\mathscr{D}$ is a $C^*$-subalgebra of~$\scrA$,
we have $a^{\frac{1}{2}}\in \mathscr{D}$.
Then $(a^{\frac{1}{2}})^{\frac{1}{2}} \equiv a^{\frac{1}{4}}\in \mathscr{D}$
by the same token,
and so on.
Thus, as~$\mathscr{D}$ is ultraweakly closed, $\ceil{a}\in\mathscr{D}$.

\emph{($\mathscr{D}\cap [0,1]_\scrA$ is directed)}\ 
Let~$a,b\in \mathscr{D}\cap[0,1]_\scrA$ be given.
We're looking for an element~$u\in \mathscr{D}\cap[0,1]_\scrA$
with $a\leq u$ and $b\leq u$.
Note that $\frac{1}{2}a + \frac{1}{2}b$
is in~$\mathscr{D}\cap[0,1]_{\scrA}$.
Define
$u:=\ceil{\frac{1}{2}a+\frac{1}{2}b}$.
Then  $u\in \mathscr{D}\cap[0,1]_\scrA$
by the previous point.
Now, 
as $\frac{1}{2}a \leq \frac{1}{2}a+\frac{1}{2}b \leq u$,
we have $a \leq \ceil{a} =\ceil{\frac{1}{2}a} \leq 
\ceil{ \frac{1}{2}a+\frac{1}{2}b} = u$.
Similarly, $b\leq u$.


\emph{($\mathscr{D}\cap [0,1]_\scrA$
has a greatest element, $c$)}\ 
As~$\mathscr{D}\cap[0,1]_\scrA$
is a directed subset of self-adjoint elements 
of~$\scrA$ bounded above by~$1$,
it has a supremum in~$\scrA_\mathrm{sa}$,
say~$c$.
As~$c$ is the ultraweak limit of~$(c)_{c\in \mathscr{D}\cap[0,1]_\scrA}$
and~$\mathscr{D}\cap[0,1]_\scrA$ is ultraweakly closed,
we have~$c\in \mathscr{D}\cap[0,1]_\scrA$.
Thus~$c$ is the greatest element of~$\mathscr{D}\cap[0,1]_\scrA$.

\emph{($c$ is a projection)}\ 
It suffices to show that~$c=\ceil{c}$ since~$\ceil{c}$ is a projection.
Since~$c\leq \ceil{c}$, it suffices to show that~$\ceil{c}\leq c$.
As before,~$c\in \mathscr{D}\cap[0,1]_\scrA$
entails~$\ceil{c}\in\mathscr{D}\cap[0,1]_\scrA$.
Thus~$\ceil{c}\leq c$, since~$c$ is the
greatest element of~$\mathscr{D}\cap[0,1]_\scrA$.
Hence~$c=\ceil{c}$ is a projection.

\emph{(for all $a\in \scrA$
we have: $a\in \mathscr{D}$ iff $ca=a$)}\ 
Since~$c\in \mathscr{D}$,
and~$\mathscr{D}$ is a two-sided ideal,
$ca\in \mathscr{D}$, and so $ca=a$ entails~$a\in\mathscr{D}$.
Thus we only need to show that~$a\in\mathscr{D}$
entails~$ca=a$.
Let~$a\in\mathscr{D}$
be given.
We must show that~$ca=a$.

If~$a\in [0,1]_\scrA$,
then this is clear:
$a\leq c$, since~$c$ is the greatest element
of~$\mathscr{D}\cap [0,1]_\scrA$,
and so~$ca=ac=a$ by Lemma~\ref{lem:projection-order}.

If~$a\in \scrA_{\mathrm{sa}}$
with~$a\neq 0$,
then $a\cdot\|a\|^{-1} \in [0,1]_\scrA\cap \mathscr{D}$,
and so $ca \|a\|^{-1} = a \|a\|^{-1}$,
which entails $ca = a$.

(For arbitrary $a\in \scrA$,)
we have $a= a_{\mathbb{R}} + i a_{\mathbb{I}}$,
where $a_\mathbb{R}=\frac{1}{2}(a+a^*)$
and $a_\mathbb{I} = \frac{1}{2i}(a-a^*)$
are self-adjoint elements of~$\mathscr{D}$.
Then~$ca_\mathbb{R}=a_\mathbb{R}$
and $ca_\mathbb{I}=a_\mathbb{I}$
by the previous paragraph.
Thus~$ca=ca_\mathbb{R}+ica_\mathbb{I}=a_\mathbb{R}+ia_\mathbb{I}=a$.

\emph{($c$ is central)}\ 
Let~$a\in\scrA$ be given.
We must show that~$ca=ac$.
Since~$\mathscr{D}$ is a two-sided ideal,
we have~$ac\in \mathscr{D}$,
and so~$c(ac)=ac$ by the previous point.
By a similar reasoning we get~$(ca)c=ca$.
Thus~$ac=ca$.
Thus~$c$ is central.

\emph{($\mathscr{D} = c\scrA$)}\ 
Clearly $c\scrA\subseteq\mathscr{D}$
since~$c\in\mathscr{D}$ and~$\mathscr{D}$ is an ideal.
On the other hand,
if~$a\in\mathscr{D}$,
then~$ca=a$
(as we saw),
and thus~$a\in c\scrA$.
Hence~$\mathscr{D} = c\scrA$.

\emph{(uniqueness)}\ 
Let~$c_1$ and~$c_2$ be central projections 
with~$c_1\scrA = \mathscr{D}=c_2\scrA$.
We must show that~$c_1=c_2$.

As~$c_2\in\mathscr{D}=c_1 \scrA$,
there is~$a_1\in \scrA$
with~$c_2 = c_1a_1$.
Then~$c_2 = c_2c_2^* = c_1a_1a_1^*c_1^*\leq 
c_1c_1^*\|a_1a_1^*\|=c_1\|a_1\|^2$.
Thus~$c_1c_2=c_2c_1=c_2$ by Lemma~\ref{lem:projection-order}.

Similarly, $c_2c_1 = c_1c_2 = c_1$, and so $c_1=c_1c_2=c_2$.

\emph{($c$ is the greatest projection of~$\mathscr{D}$)}\ 
Let~$p$ be a projection in~$\mathscr{D}$.
We must show that~$p\leq c$.
Since~$p$ is a projection,
we have $0\leq p\leq 1$, and so $p\in \mathscr{D}\cap [0,1]_\scrA$.
Thus, $p\leq c$, by definition of~$c$.
\end{point}
\end{point}
\end{parsec}
\end{document}

